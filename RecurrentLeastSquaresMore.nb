(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    410920,       9270]
NotebookOptionsPosition[    388749,       8885]
NotebookOutlinePosition[    392461,       8982]
CellTagsIndexPosition[    392026,       8962]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\.7fLinear Regression by Folding", "Title",
 CellChangeTimes->{{3.727038100871808*^9, 3.727038119380846*^9}, {
  3.727471593317396*^9, 3.7274715984595823`*^9}},
 CellTags->"c:1",ExpressionUUID->"df21f0de-8246-4913-960d-0c30b8ea4c38"],

Cell["\<\
Brian Beckman
18 Feb 2018\
\>", "Text",
 CellChangeTimes->{{3.727471602355763*^9, 3.7274716101393967`*^9}, {
  3.727925773402236*^9, 
  3.727925775055613*^9}},ExpressionUUID->"854332ec-3651-4c31-9d01-\
187ffbc82c8e"],

Cell[CellGroupData[{

Cell["Introduction", "Chapter",
 CellChangeTimes->{{3.727481450088695*^9, 3.7274814520560217`*^9}},
 CellTags->"c:2",ExpressionUUID->"400e3cfe-c8a7-42b0-a1e0-731e8d54277b"],

Cell[TextData[{
 "Linear systems appear everywhere, and, where they don\[CloseCurlyQuote]t \
appear naturally, linear approximations abound because non-linear systems are \
often intractable. Examples comprise machine learning, control, dynamics, \
robotics, and many more.\n\n",
 StyleBox["Linear regression",
  FontSlant->"Italic"],
 " is the standard technique for estimating the parameters or coefficients of \
a linear system. Often, authors sweep linear regression under the rug, \
presumably because readers know all about effective ways to perform it. \
However, I have found this presumption not to be true. Time and again, I see \
code that employs the normal equations directly (that's inefficient and \
exposed to over-fitting), computes matrix inverses (that's risky), or abuses \
deep neural nets (a sledgehammer) to open a walnut (linear regression). \n\n\
This paper shows efficient, reliable methods for very general linear \
regression: recurrent least squares (RLS) and Kalman folding, and shows them \
to be mathematically equivalent. These are amongst the best known methods for \
linear regression. These methods automatically regularize their\.7f fits \
based on input a-priori estimates and covariances. We relate this automatic \
regularization to \.7fBayesian ",
 StyleBox["maximum posterior",
  FontSlant->"Italic"],
 " or MAP curve-fitting, which, in at least some published forms, does not \
have the efficiency and numerical safety of RLS and Kalman folding."
}], "Text",
 CellChangeTimes->{{3.7274814553838453`*^9, 3.727481471849703*^9}, {
   3.727481502548395*^9, 3.727481543290386*^9}, {3.7274815762427998`*^9, 
   3.727481597731824*^9}, {3.727481661069376*^9, 3.7274817001125383`*^9}, {
   3.727481803352981*^9, 3.727481863536408*^9}, {3.7274819760213203`*^9, 
   3.727481983533637*^9}, {3.72748203670294*^9, 3.727482052238491*^9}, {
   3.727482189409683*^9, 3.727482202321042*^9}, {3.727482237078443*^9, 
   3.7274824455142107`*^9}, {3.727482502224814*^9, 3.727482511663734*^9}, {
   3.727482542628716*^9, 3.727482573300147*^9}, {3.7274826061847153`*^9, 
   3.727482641957479*^9}, {3.727483068187994*^9, 3.72748306969718*^9}, {
   3.727483495698502*^9, 3.727483517296239*^9}, {3.727483586049469*^9, 
   3.7274836308700047`*^9}, {3.7274837441660624`*^9, 3.727483765339192*^9}, 
   3.7274838852467213`*^9, {3.7279259770520372`*^9, 3.727926056795493*^9}, {
   3.727927567316916*^9, 3.7279276585683327`*^9}, {3.727965622939703*^9, 
   3.727965628844901*^9}, {3.7279657010285673`*^9, 3.727965810694715*^9}, {
   3.728090783678996*^9, 3.728090785427752*^9}, {3.728090821738459*^9, 
   3.7280909405099163`*^9}},ExpressionUUID->"a883f589-7218-464d-b6b2-\
a6e932ea8e15"]
}, Closed]],

Cell[CellGroupData[{

Cell["Motivating Example", "Chapter",
 CellChangeTimes->{{3.727448922904108*^9, 3.7274489260707684`*^9}},
 CellTags->"c:3",ExpressionUUID->"b4436fee-a910-4303-af20-c8497a4ae76a"],

Cell["\<\
First, we exhibit RLS and Kalman folding and find their relationship to \
maximum-likelihood estimation (MLE) for a two-parameter problem: estimating \
the slope and intercept of a best-fit line to noisy data. MLE is computed \
using Wolfram built-in functions as well as directly through the classic \
normal equations, that is, using the Moore-Penrose pseudoinverse matrix. \
These two methods of MLE yield exactly the same results.\
\>", "Text",
 CellChangeTimes->{{3.728090971639092*^9, 
  3.728091137803318*^9}},ExpressionUUID->"85c0c564-3527-4b6f-af00-\
e54d3b0b5b46"],

Cell[TextData[{
 "Find best-fit, unknowns ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "23d9cfff-f3b2-481a-b6b0-b0dd5f9b1280"],
 " (slope) and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "26440a3d-fedb-4ee7-bb0c-8168bf0e1838"],
 " (intercept), where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "=", 
    RowBox[{
     RowBox[{"m", " ", "x"}], "+", "b"}]}], TraditionalForm]],ExpressionUUID->
  "327c6fd2-96f6-4323-8eb6-291777ee6a3a"],
 ", given known data ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"], ",", "\[Ellipsis]", ",", 
     SubscriptBox["z", "k"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "75075c60-5e3c-42da-b661-296a1ae1ee60"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["x", "2"], ",", "\[Ellipsis]", ",", 
     SubscriptBox["x", "k"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "46e64d18-1f5c-4926-95b8-33f6a7ecf798"],
 ". Write this ",
 StyleBox["system",
  FontSlant->"Italic"],
 " as a matrix equation and remember the symbols ",
 Cell[BoxData[
  FormBox["\[CapitalZeta]", TraditionalForm]],ExpressionUUID->
  "6506ca43-d29d-41ac-a6e2-79dfb4a63621"],
 " (",
 StyleBox["observations",
  FontSlant->"Italic",
  Background->RGBColor[1, 1, 0]],
 ", known), ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "fefe6189-4c2b-40bc-a442-4a207b3a6e94"],
 " (",
 StyleBox["partials",
  FontSlant->"Italic",
  Background->RGBColor[1, 1, 0]],
 ", known), and ",
 Cell[BoxData[
  FormBox["\[CapitalXi]", TraditionalForm]],ExpressionUUID->
  "5765724f-9455-410c-b18a-1b8e1a10f25e"],
 " (",
 StyleBox["model",
  FontSlant->"Italic",
  Background->RGBColor[1, 1, 0]],
 StyleBox[", state, unknown parameters",
  FontSlant->"Italic"],
 " to be estimated). Rows of ",
 Cell[BoxData[
  FormBox["\[CapitalZeta]", TraditionalForm]],ExpressionUUID->
  "e1f5a451-c282-4e3b-b834-f2563cf67bfe"],
 " and ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "84ee545a-a45b-43c3-ad12-365049e2f5e2"],
 " come in matched pairs."
}], "Text",
 CellChangeTimes->{{3.727038390871489*^9, 3.727038456274043*^9}, {
  3.7274311898792877`*^9, 3.727431210306458*^9}, {3.72743162057631*^9, 
  3.727431625628214*^9}, {3.727431899653804*^9, 3.727431979499525*^9}, {
  3.727432013573489*^9, 3.7274321573609333`*^9}, {3.727432239814447*^9, 
  3.7274322449709*^9}, {3.7274337661533823`*^9, 3.727433787800761*^9}, {
  3.727440517352091*^9, 3.727440560289133*^9}, {3.727471626984016*^9, 
  3.727471663001911*^9}, {3.7274858550759478`*^9, 3.727485860274253*^9}, {
  3.728091149168085*^9, 
  3.728091201530199*^9}},ExpressionUUID->"ac88bcea-43b3-447b-ade9-\
9f47e70fa366"],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[CapitalZeta]", 
    RowBox[{"k", "\[Times]", "1"}]], "  ", "=", "  ", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["z", "1"]},
       {
        SubscriptBox["z", "2"]},
       {"\[VerticalEllipsis]"},
       {
        SubscriptBox["z", "k"]}
      }], ")"}], "  ", "=", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", GridBox[{
          {
           SubscriptBox["x", "1"], "1"},
          {
           SubscriptBox["x", "2"], "1"},
          {"\[VerticalEllipsis]", "\[VerticalEllipsis]"},
          {
           SubscriptBox["x", "k"], "1"}
         }], ")"}], "\[CenterDot]", 
       RowBox[{"(", GridBox[{
          {"m"},
          {"b"}
         }], ")"}]}], " ", "+", " ", "noise"}], "  ", "=", "  ", 
     RowBox[{
      RowBox[{
       SubscriptBox["A", 
        RowBox[{"k", "\[Times]", "2"}]], "\[CenterDot]", 
       SubscriptBox["\[CapitalXi]", 
        RowBox[{"2", "\[Times]", "1"}]]}], "+", 
      RowBox[{"samples", " ", "of", " ", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", 
         SubscriptBox["\[Sigma]", "\[CapitalZeta]"]}], "]"}]}]}]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.727431219978753*^9, 3.7274313049913387`*^9}, {
  3.72743141969454*^9, 3.7274316161107063`*^9}, {3.727431991078349*^9, 
  3.727431991079677*^9}, {3.727433277603713*^9, 3.727433294425931*^9}, {
  3.727440753860702*^9, 3.7274407556831503`*^9}, {3.7274408733251953`*^9, 
  3.727440951766347*^9}, {3.727441005231421*^9, 3.727441018782874*^9}, {
  3.727471698016046*^9, 
  3.727471719286708*^9}},ExpressionUUID->"edfc4e60-1a5d-4bbc-8586-\
719db51c84cd"],

Cell[TextData[{
 "This extends to any linear system with any number of parameters\.7f (we \
have two) and with tensors in the matrix slots. Below, we extend the linear \
system to polynomials in ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "c83aa156-e89d-4b01-b487-1440cd645ea2"],
 ", wherein we estimate the coefficients the polynomials. Such systems, while \
non-linear in ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ade9370b-5539-4afe-b07d-a5bd4b38546d"],
 ", are linear in the coefficients."
}], "Text",
 CellChangeTimes->{{3.72743218344071*^9, 3.727432337884823*^9}, {
  3.727449535267564*^9, 3.727449543573064*^9}, {3.7274752783628683`*^9, 
  3.727475287576037*^9}, {3.727877589590386*^9, 3.727877610093027*^9}, {
  3.7279658518461113`*^9, 3.727965861732964*^9}, {3.728091257069253*^9, 
  3.7280913297605677`*^9}},ExpressionUUID->"94ca0260-132d-409c-8b19-\
0b4d6bd9f578"],

Cell[CellGroupData[{

Cell["Ground Truth", "Subchapter",
 CellChangeTimes->{{3.727038130736038*^9, 3.727038133799975*^9}, {
   3.727038190200441*^9, 3.727038194262557*^9}, {3.7270382668439693`*^9, 
   3.727038273195747*^9}, 3.727449676637067*^9},
 CellTags->"c:4",ExpressionUUID->"47dd026f-d220-40db-977a-5dd0c33852f3"],

Cell[TextData[{
 "Test the method as follows: make some faked data by sampling a line \
specified by ground truth ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "a6958922-45d9-44d5-a140-5d74dfa03120"],
 " and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "39031738-b4df-4535-8d32-6ba1d755ca94"],
 ", then adding some Gaussian noise. Run the faked data through variaous \
estimation procedures and see how close the estimates come to the ground \
truth. In the real world, we don\[CloseCurlyQuote]t know ground truth, so it\
\[CloseCurlyQuote]s paramount that we trust the method before deploying it. \
Build up trust by testing. "
}], "Text",
 CellChangeTimes->{{3.7274717486938457`*^9, 3.727471863121015*^9}, {
   3.727471943951993*^9, 3.727471974860942*^9}, 3.7274752992891693`*^9, {
   3.727485889951729*^9, 3.727485910971366*^9}, {3.727485957242045*^9, 
   3.727485990073215*^9}, {3.727877625333728*^9, 3.727877661014937*^9}, {
   3.727877785098357*^9, 3.727877790057716*^9}, {3.728091354555441*^9, 
   3.728091378646338*^9}},ExpressionUUID->"b251a480-7d0a-4708-a0bb-\
1953fdf4736b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"groundTruth", ",", "m", ",", "b"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groundTruth", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "b"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", 
      RowBox[{
       RowBox[{"-", "1."}], "/", "3."}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.727038221106352*^9, 3.72703825991599*^9}, {
  3.727450214764965*^9, 
  3.727450221204816*^9}},ExpressionUUID->"bd95db53-9501-422b-9130-\
f0ddc2962414"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partials", "Subchapter",
 CellChangeTimes->{{3.727038381072097*^9, 3.7270383858220654`*^9}, 
   3.727472022244463*^9},
 CellTags->"c:5",ExpressionUUID->"e91ccb44-d532-453b-9dd9-e439997d9905"],

Cell[TextData[{
 "The partials ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "9309b19a-9472-465f-84be-8ecd35011dde"],
 " are a (column) vector of co-vectors (row vectors). Each co-vector is the \
gradient of the observation model, namely of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "\[CenterDot]", "\[CapitalXi]"}], TraditionalForm]],
  ExpressionUUID->"24f492e1-8cbc-4b9e-85e3-f2475b30584a"],
 ", with respect to ",
 Cell[BoxData[
  FormBox["\[CapitalXi]", TraditionalForm]],ExpressionUUID->
  "32a3d80d-1e15-455e-a684-128e0a220123"],
 ", evaluated at specific values of ",
 Cell[BoxData[
  FormBox["\[CapitalXi]", TraditionalForm]],ExpressionUUID->
  "482810e6-322f-4783-a84c-dc625d8b0917"],
 " from the data. Gradients are always",
 StyleBox[" co-vectors",
  FontWeight->"Plain"],
 ", that is, linear transformations of vectors. This fact drives  the dual \
problem, below."
}], "Text",
 CellChangeTimes->{{3.727474059032774*^9, 3.727474241042626*^9}, {
  3.727475321236279*^9, 3.727475337122877*^9}, {3.727877875957012*^9, 
  3.727877901401568*^9}, {3.728091432235373*^9, 
  3.728091454599753*^9}},ExpressionUUID->"db69371d-1adf-4245-bec6-\
355031d69082"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"nData", ",", "min", ",", "max"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{"nData", "=", "119"}],
   Background->RGBColor[1, 1, 0]], ";", 
  RowBox[{"min", "=", 
   RowBox[{"-", "1."}]}], ";", 
  RowBox[{"max", "=", "3."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "partials", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox["partials",
    Background->RGBColor[1, 1, 0]], "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#", ",", "1.0"}], "}"}], "&"}], ",", "nData", ",", 
     RowBox[{"{", 
      RowBox[{"min", ",", "max"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Short", "[", 
  RowBox[{"partials", ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.727038484294626*^9, 3.727038506353806*^9}, {
   3.727038672360093*^9, 3.7270386925152807`*^9}, {3.7270387298032637`*^9, 
   3.727038738723681*^9}, {3.727432689921877*^9, 3.7274327110981913`*^9}, {
   3.727445567876906*^9, 3.727445568010209*^9}, {3.7274468698582373`*^9, 
   3.727446869999188*^9}, 3.727446939266643*^9, {3.7274470220360327`*^9, 
   3.7274470231123457`*^9}, {3.727447792622075*^9, 3.7274477929568863`*^9}, {
   3.727449108405336*^9, 3.727449126986397*^9}, {3.727449270042646*^9, 
   3.727449276077201*^9}, {3.727449337024444*^9, 3.727449352022664*^9}, {
   3.7274494075242367`*^9, 3.727449431344298*^9}, {3.72744956654039*^9, 
   3.727449572786269*^9}, {3.7274496209308167`*^9, 3.727449635986744*^9}, 
   3.727449690711412*^9, {3.727449766317731*^9, 3.727449816846671*^9}, {
   3.727451747352453*^9, 3.727451747877816*^9}, 3.7274561390872173`*^9, {
   3.727462576366873*^9, 3.727462593386175*^9}, {3.727472063650128*^9, 
   3.727472063729579*^9}},ExpressionUUID->"66e73013-3112-4348-a1d9-\
ec6740e171cf"],

Cell[BoxData[
 TagBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.`"}], ",", "1.`"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.9661016949152542`"}], ",", "1.`"}], "}"}], ",", 
    RowBox[{"\[LeftSkeleton]", "115", "\[RightSkeleton]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2.9661016949152543`", ",", "1.`"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3.`", ",", "1.`"}], "}"}]}], "}"}],
  Short[#, 3]& ]], "Output",
 CellChangeTimes->{{3.727038583630406*^9, 3.727038608390233*^9}, 
   3.727038709777071*^9, 3.727038740778534*^9, 3.727055663056172*^9, 
   3.727057129327168*^9, 3.727059177376666*^9, 3.7270594202840557`*^9, 
   3.727059460469883*^9, 3.727059722172241*^9, 3.7273704074561377`*^9, 
   3.727379374177999*^9, 3.7273796189946833`*^9, 3.727382952016055*^9, 
   3.7274396353755617`*^9, 3.72744299207996*^9, 3.727443422013879*^9, 
   3.7274434527589293`*^9, 3.727444587495447*^9, 3.727444680192195*^9, 
   3.7274455717862053`*^9, 3.72744624615656*^9, 3.72744640590419*^9, 
   3.727446838013892*^9, 3.727446872924258*^9, {3.727446907842485*^9, 
   3.727447069879878*^9}, 3.727447290299449*^9, 3.727447347017867*^9, 
   3.7274478385022182`*^9, 3.727449204471116*^9, 3.7274492775476*^9, 
   3.7274496365181932`*^9, 3.727449693340242*^9, {3.727449807165443*^9, 
   3.727449817081092*^9}, 3.727449903758767*^9, 3.727450179720099*^9, 
   3.7274506510519867`*^9, 3.7274509739039373`*^9, 3.7274517486268787`*^9, 
   3.727451981813099*^9, 3.7274548446844063`*^9, 3.727455078961658*^9, 
   3.727455974394829*^9, {3.727456142033311*^9, 3.727456186089284*^9}, 
   3.72745682664186*^9, 3.727457103211014*^9, 3.727462537773409*^9, 
   3.727462600894341*^9, 3.7274720648603897`*^9, 3.727472137401977*^9, 
   3.727485510677791*^9, 3.727486308137322*^9, 3.727878577703927*^9, 
   3.727880786980283*^9, 3.727881187293543*^9, 3.727881367162183*^9, 
   3.7279153846145782`*^9, 3.727918036001253*^9, 3.727918094003922*^9, 
   3.727924197077376*^9, {3.7279277061564293`*^9, 3.7279277315954943`*^9}, 
   3.727967809713481*^9, 3.72796873270875*^9, 3.727969807680747*^9, 
   3.727969954624679*^9, 3.728044351074147*^9, 3.72804644720837*^9, 
   3.728066469128708*^9, 3.728068120342204*^9, 3.728083782832687*^9, 
   3.7280907407468643`*^9, 3.728169444417408*^9, 3.72816954001482*^9, 
   3.728169822168985*^9, 3.7281698821964903`*^9, 
   3.728252954623953*^9},ExpressionUUID->"ab757c3b-f9a5-4236-825f-\
0f570a9c0a72"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Faked Observations \[CapitalZeta]", "Subchapter",
 CellChangeTimes->{{3.727038130736038*^9, 3.727038133799975*^9}, 
   3.727038190200441*^9, {3.7280914789368753`*^9, 3.728091489257578*^9}},
 CellTags->"c:6",ExpressionUUID->"608eebd4-04fe-4c58-b0e3-7eb1ca6ced3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "fake", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fake", "[", 
    RowBox[{"n_", ",", "\[Sigma]_", ",", "A_", ",", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "b_"}], "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "\[Sigma]"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       ".", 
       RowBox[{"{", 
        RowBox[{"m", ",", "b"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.727447704011672*^9, 3.727447786446568*^9}, {
  3.7274490411388807`*^9, 3.727449101412051*^9}, {3.727449980043066*^9, 
  3.727449994241746*^9}, {3.727450133949367*^9, 3.727450162748006*^9}, {
  3.727451390752479*^9, 
  3.727451399962222*^9}},ExpressionUUID->"dcf80067-1b4d-4ca1-a465-\
b6d067fe1e04"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"data", ",", "noiseSigma"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noiseSigma", "=", "0.65"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"fake", "[", 
    RowBox[{"nData", ",", "noiseSigma", ",", "partials", ",", "groundTruth"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Short", "[", 
  RowBox[{"data", ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.727038280219474*^9, 3.727038287790659*^9}, {
  3.7270383211500597`*^9, 3.72703835571806*^9}, {3.7270386358940287`*^9, 
  3.727038663927939*^9}, {3.727038747737464*^9, 3.727038876839672*^9}, {
  3.727050006302822*^9, 3.7270500110829983`*^9}, {3.727432654265699*^9, 
  3.727432659697441*^9}, {3.727432723054358*^9, 3.727432765462573*^9}, {
  3.72744344707723*^9, 3.7274434481794357`*^9}, {3.727446952499505*^9, 
  3.7274469532000103`*^9}, {3.727447283073348*^9, 3.727447284101734*^9}, {
  3.727447801831417*^9, 3.7274478305638647`*^9}, {3.72745000784216*^9, 
  3.727450013288878*^9}, {3.7274501435089684`*^9, 3.727450170037139*^9}, {
  3.727450669288356*^9, 3.727450670595593*^9}, {3.727451668943946*^9, 
  3.727451671078163*^9}, {3.7274720470935698`*^9, 3.727472053265984*^9}, {
  3.7280915253683*^9, 
  3.728091537656971*^9}},ExpressionUUID->"464fd4ff-3f54-4f41-bff3-\
b434b588715a"],

Cell[BoxData[
 TagBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "0.5278225055316503`"}], ",", 
    RowBox[{"-", "1.742541363370183`"}], ",", "0.2747604277499214`", ",", 
    RowBox[{"\[LeftSkeleton]", "113", "\[RightSkeleton]"}], ",", 
    "1.1092917627260273`", ",", "0.8919636524589125`", ",", 
    "0.7624554249177374`"}], "}"}],
  Short[#, 3]& ]], "Output",
 CellChangeTimes->{
  3.7270387677851763`*^9, {3.727038867149591*^9, 3.7270388773964233`*^9}, 
   3.727055663102105*^9, 3.727057129370555*^9, 3.727059177422636*^9, 
   3.72705942033997*^9, 3.7270594605156918`*^9, 3.7270597222146673`*^9, 
   3.727370407509316*^9, 3.72737937420789*^9, 3.727379619053474*^9, 
   3.7273829520789537`*^9, {3.727432741397806*^9, 3.7274327662165937`*^9}, 
   3.7274396353972178`*^9, 3.727442992108829*^9, 3.727443422045128*^9, 
   3.727443452800355*^9, 3.727444587519507*^9, 3.72744468023639*^9, 
   3.72744557183354*^9, 3.7274462462052383`*^9, 3.727446405956995*^9, 
   3.727446838056027*^9, 3.727446872970574*^9, {3.7274469079026823`*^9, 
   3.7274470702684298`*^9}, {3.727447285361125*^9, 3.727447290697486*^9}, 
   3.727447347400682*^9, 3.727447838556155*^9, 3.727449704912554*^9, 
   3.727449903803282*^9, {3.727450008789967*^9, 3.727450014801861*^9}, 
   3.727450179801093*^9, {3.727450656921492*^9, 3.7274506714803667`*^9}, 
   3.727450973950561*^9, 3.727451671368905*^9, 3.727451987158052*^9, 
   3.727454844732745*^9, 3.727455079003149*^9, 3.7274559744493303`*^9, {
   3.727456142089485*^9, 3.7274561861436663`*^9}, 3.7274568266819696`*^9, 
   3.7274571032765923`*^9, 3.727462547831717*^9, 3.727462600948619*^9, {
   3.72747204808424*^9, 3.727472053925476*^9}, 3.727472137462739*^9, 
   3.7274855107778893`*^9, 3.727486308212657*^9, 3.727878577784017*^9, 
   3.727880787054256*^9, 3.7278811873704453`*^9, 3.7278813672409067`*^9, 
   3.7279153846882277`*^9, 3.727918036075748*^9, 3.727918094088941*^9, 
   3.727924197165626*^9, {3.7279277062395906`*^9, 3.727927731659636*^9}, 
   3.727967809786593*^9, 3.7279687327633533`*^9, 3.727969807759448*^9, 
   3.7279699546901617`*^9, 3.728044351191318*^9, 3.728046447285791*^9, 
   3.728066469199588*^9, 3.728068120401382*^9, 3.728083782912451*^9, 
   3.7280907408080997`*^9, 3.72809154205811*^9, 3.728169444492231*^9, 
   3.728169540095767*^9, 3.7281698222504396`*^9, 3.728169882302762*^9, 
   3.728252954702303*^9},ExpressionUUID->"40ebeefe-e3a0-4462-bd25-\
9152d295c2e5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model", "Subchapter",
 CellChangeTimes->{{3.727039137746358*^9, 3.727039138418336*^9}},
 CellTags->"c:7",ExpressionUUID->"d7172986-5c33-442d-923c-ebedb29b0ccc"],

Cell[TextData[{
 "Try the Wolfram built-in which computes an MLE for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalXi]", "=", 
    RowBox[{"(", GridBox[{
       {"m"},
       {"b"}
      }], ")"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "a072ad03-e1f6-4a62-8845-fb0fb07daace"],
 ". The estimated ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "8bb6137a-c373-4e68-859f-b628ae16677d"],
 " and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "d7218397-fec7-4a19-834c-58cc47b9f6a1"],
 " are reasonably close to the ground truth."
}], "Text",
 CellChangeTimes->{{3.727432553517992*^9, 3.727432621798977*^9}, {
  3.727472080939521*^9, 3.727472088160452*^9}, {3.728091559509233*^9, 
  3.7280915965871964`*^9}},ExpressionUUID->"f817be6c-9a8e-4e9f-a43d-\
9f34d5b9987f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "model", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"model", "=", 
   RowBox[{
    StyleBox["LinearModelFit",
     Background->RGBColor[0.87, 0.94, 1]], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"partials", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", "data"}], 
       "}"}], "\[Transpose]"}], ",", "\[Xi]", ",", "\[Xi]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Normal", "[", "model", "]"}]}], "Input",
 CellChangeTimes->{{3.7270391419515553`*^9, 3.727039222672346*^9}, {
   3.727039589022585*^9, 3.727039634463044*^9}, {3.72703984614863*^9, 
   3.7270398612337418`*^9}, {3.727432525241551*^9, 3.727432532127486*^9}, 
   3.727445246314415*^9},ExpressionUUID->"5aeea79a-7696-40cc-9adc-\
259870686894"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.28741906000778855`"}], "+", 
  RowBox[{"0.35324547195892714`", " ", "\[Xi]"}]}]], "Output",
 CellChangeTimes->{
  3.727039636453086*^9, 3.727039861741905*^9, 3.727055663158083*^9, 
   3.727057129421227*^9, 3.727059177473164*^9, 3.727059420390205*^9, 
   3.727059460559739*^9, 3.7270597222647333`*^9, 3.727370407570586*^9, 
   3.727379374273665*^9, 3.727379619119594*^9, 3.727382952138339*^9, 
   3.727432540947384*^9, 3.7274396354423*^9, 3.727442992152419*^9, 
   3.7274434220853767`*^9, 3.727443452837515*^9, 3.7274445875622473`*^9, 
   3.727444680287569*^9, 3.7274451623174067`*^9, 3.727445248914556*^9, 
   3.7274455718832607`*^9, 3.727446246253859*^9, 3.727446406005806*^9, 
   3.7274468381061697`*^9, 3.727446873004697*^9, {3.727446907951789*^9, 
   3.7274470703496027`*^9}, 3.727447290772621*^9, 3.7274473474807863`*^9, 
   3.727447838604089*^9, 3.72744971744767*^9, 3.727449903849738*^9, 
   3.727450179854268*^9, 3.72745067894905*^9, 3.727450974002071*^9, 
   3.7274519905214252`*^9, 3.727454844781467*^9, 3.7274550790484867`*^9, 
   3.727455974499503*^9, {3.7274561421377363`*^9, 3.727456186189336*^9}, 
   3.7274568267039757`*^9, 3.727457103314196*^9, 3.727462551096787*^9, 
   3.727462600989726*^9, 3.7274721375146713`*^9, 3.727485510832881*^9, 
   3.7274863082710543`*^9, 3.727878577840499*^9, 3.727880787101037*^9, 
   3.727881187428447*^9, 3.7278813672674103`*^9, 3.727915384737116*^9, 
   3.72791803614151*^9, 3.7279180941213903`*^9, 3.727924197222649*^9, {
   3.727927706298745*^9, 3.7279277317186337`*^9}, 3.727967809847283*^9, 
   3.7279687328234253`*^9, 3.727969807818206*^9, 3.7279699547399473`*^9, 
   3.7280443512586803`*^9, 3.728046447345396*^9, 3.728066469257868*^9, 
   3.72806812045158*^9, 3.728083782977825*^9, 3.728090740871644*^9, 
   3.728169444560561*^9, 3.728169540157092*^9, 3.72816982231103*^9, 
   3.7281698823703403`*^9, 
   3.728252954766592*^9},ExpressionUUID->"2fb976ee-9625-4385-866c-\
0b29f446da3f"]
}, Open  ]],

Cell["\<\
Un-comment the following line to see everything Wolfram has to say about this \
MLE (it\[CloseCurlyQuote]s a lot of data).\
\>", "Text",
 CellChangeTimes->{{3.727445705251766*^9, 3.727445735756525*^9}, {
   3.727446896680705*^9, 3.727446898174596*^9}, 3.727447110091947*^9, {
   3.728091613989747*^9, 
   3.7280916153070917`*^9}},ExpressionUUID->"e4b9147c-e0bc-4980-a5ff-\
4fd167ac66cb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "\[Rule]", 
       RowBox[{"model", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
    RowBox[{"model", "[", "\"\<Properties\>\"", "]"}]}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.727445423183494*^9, 3.727445453352212*^9}, {
  3.727445496770472*^9, 3.727445513033325*^9}, {3.727445697132193*^9, 
  3.727445698524333*^9}, {3.727446901104203*^9, 3.727446903566482*^9}, {
  3.727453939742375*^9, 3.727453943568625*^9}, {3.727454015364012*^9, 
  3.727454016578137*^9}},ExpressionUUID->"6d9378c4-eccb-470c-a7bb-\
c2341636454d"],

Cell[TextData[{
 "The plot shows that Wolfram does an acceptable job of estimating the \
parameters ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "957969ed-d6e9-4dae-9f5d-a59132086d64"],
 " and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "c753b193-4efd-408f-83db-bd5ff456e748"],
 " that define the line:"
}], "Text",
 CellChangeTimes->{{3.72748603072836*^9, 
  3.7274860648301*^9}},ExpressionUUID->"1d8c675c-4946-4c90-a854-966331b0f2d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"partials", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", "data"}], 
      "}"}], "\[Transpose]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"m", " ", "\[Xi]"}], "+", "b"}], ",", 
       RowBox[{"model", "[", "\[Xi]", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Xi]", ",", "min", ",", "max"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.727039646243634*^9, 3.7270396697516117`*^9}, {
   3.727039719966466*^9, 3.727039823407961*^9}, 3.727447260921829*^9, {
   3.727472117984476*^9, 3.72747212110266*^9}, {3.7274729782058973`*^9, 
   3.727472978941469*^9}},ExpressionUUID->"cab178ce-edf9-4d91-88ee-\
2d777da823c7"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668],
       AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw1VQs0lGkYHsMwq1TYirZUaJVYFKLwfqm1smrRhqLtou3G2VgqRO12UWvb
kEp12rNqi7Ql2pRLzetSsme1IcltJjPuZuQ2jCjtzPf/858z5z9zvv973/e5
fd/87fv8vudyOJyDyp/qzTz9aOUq5claWzDpDn/Wup63mHwtRi9SPI4mQfr2
V2p7sbivsfT2+WrIVi0LZHhuTUDVaptKdH1gutspS4odEqOFyfm1WBmy+GhC
ag9Gi30/OT0sALo9vhtvNeieHioYxh6Bi3JHFy49AZscHIUYG/ZlVbhfJ14w
vB00VX8AaXmXDrQskbz7WT6MF5/5a+lZtKPn5tytdWFytNi/RTlSGyb787U7
M28jbT8uwaoJ+cWHmbfAQ1lN0S5GudXyUU+zHqyNj1F2aMFTJi7vw6x6oEJV
bv8b9JZcrHU8fh87cqevLFsjxBH/38o5a1tRtbrFpAk7exQ2UwzakJYfrMds
y4aUAq+X6K78OO1ZHRpl66/tcRDBVoYgdJNdGo+aGMXDqnbhNeh49OORU/nN
eIUZAN1aeq/eKWvDKNX49pVoJP0xNMAyE3No+2e43vT+5aHyAez/V0VgGRo1
28nuBvVhIB1IgGekl++O36gDCi83D18bWFk36w9icqGNUrJbyJkf0TbqcQw4
lKAUNElwtp6aKlf/h3I/obnsfDemM99DxyhktS2RIlsPjjcPeuYfq0Ifph/8
XtUesCu8Cdh54HnQpjdh/AH1vLCjr+SioqIBoxk8cNoiRtjg0wEsXogtS9Ab
ev4Q4xg+4ITO+VMLeGJk+YJ0rmxDTW87EoZPMDYz/+vxCiGYM3yDcXVkwE33
l8DqAdyARP1f7j3BNkYvkJoVcKKThpDVE64VG/daz5ao9YZ8ozeytIDXaj9A
dtifh8JeSdR+gULPDe6T7KpgIeMn8NsWkrFriVjtN+A/zUnRXiFR+xFkixt+
LeS1A+tXWHPm7Gm/nc+A9TOsiz/YetVaAsGM3yEhT7PtgZ0E2DzAjmVzdT63
6AQXJi9Q99RRVOfdqs4TZGR85m5mU6LOGxgXTMuK9SyFZCaP8KS4pMV0Qgxs
XuE6b45w7F4JUrYS+8F/ygWPpYkyoHJOHwAyVVYt72+BW6rl9AEoW5RdY+Al
Qsn1t0pFB2Fnvu72RodupPAeDEKTYNWCQJEI6faVQ1Cp2+n30fYFJKaLlTuG
YOOhit6AfzrgiUoufznwz/63ccneTHivKi+Wg0+4t0eIfTHaUwMMw1iRdmTM
vEqkdCmGodbxi5abuS1I2x8dgaycOFe3k1IQpakIV8Bm3b/j9PJaYYZK3TQF
SJd4dr3gcggdz3QU9jwu0DEcfYkJqSoDj8JuJ4H1JMNmoPQ7vYPJkgFb2/gi
HFWNX/YO7nr/FLEruApt6YE2BqWBzuOKrSXI2GsMAg8k7jpQKgAKL2QcQt+m
2utuq4F6CngcvHxicoXhlWBAAb2HK4FfcRKda9FLBV/rA1yYCg6Dhg1wlA70
AXK+cw7M0OsEGq9ZE3CFr1MXmvwCKD3XJ8A8LNrZzeE5WtENH8Gz4O1ZiCzB
HSp7FH6EOd6ZComT0kcUL4c4zVwvcHIVsuclh+x3+2adxp4uYPBzSG2dztCY
eyWaUUAckrzgUeKmvnJAyocGSe0rXXtca4Q9fzVI1HLfunH/V0DlLdMgfMXX
Fdr1uXCODswlt3dvj9sTKwGGLy7JCvHkF/FaWP9yieaybf4hBkJg+OMS01Un
9kYniNh8apJti5/+oZE/AFcpn5pk8syuHcv72oC5HzTJNK+ORXavGrGB8qtJ
onmkUCgYBBo/ey1yeL5P5vv9PUDHjdEiHsHNN/x/kLL50CJ7jec8yshpBoZ/
HuH4xs9z35gJzPnNI5ZGgn1Nlu2sHjxSLcr61vbkIDB54pHi2WZzxWMjUET1
0SZJn8470p7aDQEUgDZ5JBLnTW9shCGqlzbxtVlRmBSsAOY+1CYRoavd6jkS
oHLZ6BCTS1FVURkv2ftEh0TMsMy/iQPA6KlDuFopQQplHpm88omNYIOUv7ML
/gdJH7re
       "]]}, {}}, {}, {}, {}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1:eJwVxX081HccAPDD8SO5Yg1RSyVTeZx5bO3znRQ1CkVSnYskKsp6UHGSjstC
dR7mQlvyXGioPKxvSWjhhXOccBwyDh0/T5Xjtv3xfr3X+4a4+8tTKBSX//z/
EaZRu0wmwYLRl0kFBWIsJB1XTs9KsM7D5u8eZosxI8DPeXhMgr3pPS0Zv4ux
vyu3trFTgnvb5pffSRHj4A3K5WnFEjxQZcK6dF2Mo+oGky18JHgsPv2Cg7cY
59DuHQx48REvmYd5ClXEeDJTpbs5fAJvuGKqrRE4igvytdqjX4vxtcinSaeX
j+Dt1/oMg21G8NsgHSyqG8bBnWzVbyo/YF/NkJKK2A/4jbZff6niIFaz7uHe
MB7Cs5vmV0ZG9uPs7QYWQeIBnGoXFsCI6cauFexa+1siHLnlTYPLtx14z2z3
Gub3/Xj1nyxRtn4r9jXR3pX3Ty+W6br+xTlVjz2O5DvYmXVjH6VPzr7xlXi9
50ymXK4APz4RYmuQy8VxLXqxCVs68COF0O3Afww6lsxjcmE87IRlc0UxryDa
Pzk1f7oFq3r0eVw82wj6lKrIkNBGbHQ+/QWHwwOmFW1cU6se6+XwuVF3BRBH
5a/YrF2DGxQe381a7IValwVTmncF7jvODjSOEUFJdAAdLhfhsqM3tbJ2DMHK
K7hno+4dPMbPs94/MwwMFZtNQkka7L5OkzZdHIWW0iHuAKsEohx2NPuajkNJ
9bNBy5NV0G/3wqGm4iNovmsVdjXUgJugULPo3iRwn1JL1GrrYd03/ers2Slo
a+KnX9jaBBSmtY+jzTQU5qwOtNVtheaTF0u/SpkBx/BU9bYOHuzl1KKIiVlw
bLUwymZ1gKjTUq/ReB7OeGuO2St1wbHcBCXDm5/gzOf6Z1+qu2Hm9jIIbPoM
nEZsGLFTCLaVySWOqguQsGJMMYPRD0HBypstjkvh5eujTHaFCIp/yJxWyFkE
6t1pp0MLAyBK1n0jkpeB1dhZHWuvIeBQ6efd9SkonK7+45eMD0ATlj+Qr6Wg
UPVXXO/eYaBERB2wPSeHPPd5LdVbj8BCHr14QEMeOedqlOlcHYUz3OJ4jRp5
ZBZXdvZKlxieb2UrqwcroLpH/icumY/D8j2hRtdpVBQ8alt0KHQCOo1beJer
qYj6ZFbq1PwRCjNBf4iuiDx3i5sTVCbBq9hKfe2SIlLwFlXV503CVdYfUT0F
SsjAzNko1mMK8kbW3qM5E2g/p2FnxdwU3MhgMYR7CWTqZKZ68/MUMNwnNhW5
EUh1MbXFSzoFWtXVJS4HCVRzIuDwJzkSYhIP193yJZC5ndI5azUSjlulTS27
TKAVoh3p5RtJ0LuxyonIIdA7E0w+cSVBahOu1plHoNxBg+dR+0kQTAy25RQS
KPq3hAg3TxISD5Ye3fWEQHbydOWpwyQsbXH/hVVNoHy+dK1ZAAk9rYmZCjwC
xYbb7S6KIOF5zLwfj08gP/MHNOY1EpK2+WzOEhAIhlXaXaJJ+DnbpMxeSKC5
fV30CTYJlWFNb6NGCeS/Mey8URIJKcaWiW7jBPpJ0GcrTSHh3ED6gfUSAq2J
d5S9SyPB0Pl038sZAvHmNONO3SeBKtf+8PY8gYoLmfu2PSChv3xbEOMLgX5l
DK9SzSahOijL1GyRQAFf733/PpeE1HWqszIZgez/Lr9fUEDCv0Lec4Y=
        "]]},
      Annotation[#, "Charting`Private`Tag$2286#1"]& ], 
     TagBox[
      {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1:eJwVz3s0lGkcwPFxfWepWdSqrQ3tIomtk9S4tL+nOGgzlklHSojaSqiwNpJr
I7ValrCG5qxLk8tidkizyFOE6rjklhE7ZniZtw1TLqlcZts/vufz93dzwHn2
KVUajcb61P/6xFr0KZUKPE2uFbPjSSyZcdaZnVdgbnOTZmsMif1PB7pOvFZg
58IL1jZRJD7lzn3cPqDAf/i1ZxiGkTj0a/q93CoFZr9MYk0GkjihdSzLyk+B
RV0zTRxnEvMZeV6nG6dxYt3zChGDxG94nw11xkzhL9JTkwxuj+Gy0nV9Sc3/
YsJhpbaDP4r3xo+YhTIpzHXfl9X1UIZDB1K0DerGcfLM6jOeI1Lcsj5QWq0x
hqOZpZyo/hE8b7KgExcnxeb7BtMVqyQ4x/bSaf/kIXzBe7ncwmAYx5m3PGFt
eYGDuLsE55kv8ZdCjuyOcTe+k87QOhIuxsqN7g8yz7XhyOzhcCLlBfbTfO8a
cLMOp3iwrHwe9OGKH8/bmN7lYjfr7qHaxR78p1rYXuivgDKzA7fEa7qxC1a+
q0x+BDcL2xwhtxNrHx45HHmhHeb0xuOPNT7DFhH5jZmZvdDUZ5aWNN+Kjfj9
3IQMMeipCF3ehTTjJ2oVGUXL/4BBrpPjtBXGIydTzlomy+ArjRoWhyHCNcev
rytyICGi6m02012AX/eX7Dk0NwE7PizQieACfCCRsdQR+Qpok7rX7SeicIKj
Q2fA9kl4o2raGevyO0htGx2b/p6GM9k7hRvjy8BDXK5fmfcGyDCfo+SBGjA0
kOqmzL8Fpk9XHm+yHmixe/ycmbOwX3Ss+cSnr84zkdVrsufAvki+fiKgBdwy
H6MrU/PQY8/K97V8CrIBa6N2ywUYPRcSkVrbDifu/qppdv09jD9g6+s7PYe5
dC042/EBsnTa85FOD9jUZQmctRchy3an7anuXggKpW+1OrkEi57FbU2ifqiy
582q8Zfhm7pwZXTcAMiyNrbIVJVQ/fkPW4KDByFT3TeCbUxDKoJrH+4zh4Ah
uVeo+piGbm+pGF1eHAbalQRPm4sqqChNUh8zLoHFEt+qUT1VtLOg1nCblxRC
uFU39ZpU0bOZJO8aNxmItqXQdUPVEF3QxqvbNwqrvg+zSGSoo2I9W5tQ4zEY
sHzeG9WgjiJDhAe/20BCOQ+MSV8NxA/xrq5XknCkarfuphUNFDsYaVorHYfL
nIKE4TJNlLKXq9vRNwEl1KY8hiuB5pwmPX4TyeHqbY6/xI1A0RGzXjca5ODP
njKp9CDQSsHH40kP5bCuoUHA8iIQfZke9NMTOSSnHWtNDSDQhmqTRG+xHE7u
zn2rFUUgZOgn3PxeDkZX17oQfALdWOjWE+6hYIkZs3qghEA6JoPry+0oEE+N
9fDLCXSLLTUoBgrSvKqPO/1FIF7FtHm2MwUr5uxwTgOBBIHaDtFeFAx3p/HU
egn0ossxfP/PFIiSFwJ7+wl0dPlglN1lCm7Z+W0tEhNIan4oblccBQfvfFuz
X0IginPiF9NrFNRd6nia8IpAS3axRVo5FGRbWqd5TBIo/iynVC2Pgouj+Z6b
FQRSz0mtWuJRYOYaPPJwjkCrZrj103wK1FX6itMXCJRhWPhIXkaB9J5dkP9H
AumzStuklRQ0BBVt37FMoPxoQcegkIIcQ+15pZJARiX3e3tqKfgP7D16pA==

        "]]},
      Annotation[#, "Charting`Private`Tag$2286#2"]& ]}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-1., 3.}, {-1.742541363370183, 2.001373114302955}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.7270397600884542`*^9, 3.727039824579692*^9}, 
   3.727055663223078*^9, 3.727057129486121*^9, 3.7270591775352287`*^9, {
   3.7270594204521437`*^9, 3.727059460621175*^9}, 3.727059722329212*^9, 
   3.7273704078372583`*^9, 3.7273793744929037`*^9, 3.727379619346348*^9, 
   3.72738295235072*^9, 3.727439635504332*^9, 3.7274429922215157`*^9, 
   3.727443422152643*^9, 3.727443452894998*^9, 3.7274445876245737`*^9, 
   3.727444680345767*^9, 3.727445572187066*^9, 3.727446246645545*^9, 
   3.727446406395307*^9, 3.727446838396817*^9, {3.7274468849772997`*^9, 
   3.727447072208765*^9}, {3.72744726321743*^9, 3.727447292342368*^9}, 
   3.727447349128606*^9, 3.7274478387626667`*^9, 3.727449904022327*^9, 
   3.727450180015175*^9, 3.727454252117652*^9, 3.727454844917451*^9, 
   3.7274550791704597`*^9, 3.7274559746420507`*^9, {3.727456142274695*^9, 
   3.7274561863233337`*^9}, 3.727456826835528*^9, 3.7274571034544353`*^9, 
   3.727462557970257*^9, 3.727462601129395*^9, 3.727472137742113*^9, 
   3.727485511026442*^9, 3.7274863084589243`*^9, 3.727878578108341*^9, 
   3.727880787187166*^9, 3.727881187660624*^9, 3.727881367362421*^9, 
   3.727915384979436*^9, 3.727918036407303*^9, 3.727918094232634*^9, 
   3.727924197467864*^9, {3.7279277065514917`*^9, 3.72792773181036*^9}, 
   3.7279678100081873`*^9, 3.727968732916506*^9, 3.727969807912593*^9, 
   3.727969954824*^9, 3.728044351393855*^9, 3.7280464474397182`*^9, 
   3.728066469373081*^9, 3.728068120547882*^9, 3.728083783120768*^9, 
   3.728090741113459*^9, 3.72816944482609*^9, 3.728169540411261*^9, 
   3.728169822560478*^9, 3.728169882589735*^9, 
   3.728252955037623*^9},ExpressionUUID->"278bc652-65da-4301-8529-\
abfe95398215"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Normal Equations ", "Subchapter",
 CellChangeTimes->{{3.727038154048767*^9, 3.7270381788082533`*^9}, {
  3.72737126177953*^9, 3.727371269395361*^9}, {3.7273713004742193`*^9, 
  3.727371301473422*^9}, {3.727432388690963*^9, 3.727432389111678*^9}},
 CellTags->"c:8",ExpressionUUID->"43b81392-6992-487a-bf0e-469291f15ff6"],

Cell[TextData[{
 "Equation 1 can be solved for a value of ",
 Cell[BoxData[
  FormBox["\[CapitalXi]", TraditionalForm]],ExpressionUUID->
  "e1070982-4510-452d-9104-4027b4282bf6"],
 " that minimizes the square error ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"J", "(", "\[CapitalXi]", ")"}], 
    OverscriptBox["=", "def"], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[CapitalZeta]", "-", 
        RowBox[{"A", "\[CenterDot]", "\[CapitalXi]"}]}], ")"}], 
      "\[Transpose]"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{"\[CapitalZeta]", "-", 
       RowBox[{"A", "\[CenterDot]", "\[CapitalXi]"}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"a1b9d468-03dc-49c4-9943-08e96ac761de"],
 ", which is the same as maximizing the likelihood ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "\[ThinSpace]", "(", "\[ThinSpace]", 
    RowBox[{"Z", "\[VerticalSeparator]", "\[CapitalXi]"}], "\[ThinSpace]", 
    ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "9c939515-2fd8-483c-8d91-92bc6c692f12"],
 ". Because the noise ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalN]", "(", 
     RowBox[{"0", ",", "\[Sigma]"}], ")"}], " "}], TraditionalForm]],
  ExpressionUUID->"d2ef2ed6-3502-41a9-ab64-83e47fa693fe"],
 "has zero mean (or zero ",
 StyleBox["bias",
  FontSlant->"Italic"],
 "), The solution turns out to be exactly what one would get from naive \
algebra.  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "A"}], TraditionalForm]],
  ExpressionUUID->"8524cb7a-422e-4376-9160-8b30cfd59b34"],
 " is square. When it is invertible,"
}], "Text",
 CellChangeTimes->{{3.7274327843718157`*^9, 3.7274328812568607`*^9}, {
   3.7274329695492764`*^9, 3.727432987909341*^9}, {3.7274405929522963`*^9, 
   3.727440597776662*^9}, {3.7274408305087957`*^9, 3.727440834532775*^9}, {
   3.727441137039894*^9, 3.7274412589545507`*^9}, {3.727441298555641*^9, 
   3.7274413240290527`*^9}, {3.727443711138123*^9, 3.727443712008112*^9}, 
   3.727443932952423*^9, {3.7274449899160423`*^9, 3.727444993644582*^9}, {
   3.7274721541913548`*^9, 3.727472171381256*^9}, {3.728091667557364*^9, 
   3.728091738028015*^9}},ExpressionUUID->"e57c8e28-d199-4aab-b7d6-\
d16b6b2262f8"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "A"}], ")"}], 
     RowBox[{"-", "1"}]], "\[CenterDot]", 
    RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "Z"}], "  ", "=", "  ", 
   "\[CapitalXi]"}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7274329995816317`*^9, 3.727433086256638*^9}, {
   3.727440616369582*^9, 3.727440619713708*^9}, 3.727440980127179*^9, {
   3.727441064009115*^9, 3.7274410867129498`*^9}, 3.7274412680182333`*^9, {
   3.727443724893661*^9, 3.7274437756712503`*^9}, {3.727443806351503*^9, 
   3.727443813377001*^9}, 
   3.727445003473629*^9},ExpressionUUID->"7ec11082-1448-47e4-99ef-\
4714737b0f5a"],

Cell["That gives exactly the same answer as Wolfram\[CloseCurlyQuote]s \
built-in:", "Text",
 CellChangeTimes->{{3.72747218573221*^9, 3.727472199188305*^9}, {
  3.7280917625845823`*^9, 
  3.728091764046361*^9}},ExpressionUUID->"71697bff-f2d9-42a5-8098-\
7fe76cdba4d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Inverse", "[", 
   RowBox[{
    RowBox[{"partials", "\[Transpose]"}], ".", "partials"}], "]"}], ".", 
  RowBox[{"partials", "\[Transpose]"}], ".", "data"}]], "Input",
 CellChangeTimes->{{3.727039915051565*^9, 3.727039947873397*^9}, {
  3.7274446395823927`*^9, 
  3.727444668828559*^9}},ExpressionUUID->"517fb11c-782d-49b8-917a-\
d34f728e4a59"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.3532454719589272`", ",", 
   RowBox[{"-", "0.2874190600077885`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.727039950530216*^9, 3.7270556632408323`*^9, 3.7270571295031*^9, 
   3.7270591775686493`*^9, 3.727059420486622*^9, {3.727059460678652*^9, 
   3.727059488023638*^9}, 3.727059722365232*^9, 3.727370407864249*^9, 
   3.727379374524898*^9, 3.727379619403*^9, 3.7273829524231453`*^9, 
   3.727439635518877*^9, 3.72744299227162*^9, 3.727443422204742*^9, 
   3.7274434529244432`*^9, 3.7274445876536283`*^9, {3.727444644095763*^9, 
   3.727444680375827*^9}, 3.727445572201291*^9, 3.7274462466755257`*^9, 
   3.727446406427293*^9, 3.727446838427972*^9, {3.727446885017421*^9, 
   3.727447072404998*^9}, 3.727447292581995*^9, 3.727447349354774*^9, 
   3.7274478387943707`*^9, 3.727449904059287*^9, 3.727450180032485*^9, 
   3.72745484494238*^9, 3.727455079217379*^9, 3.727455974674*^9, {
   3.727456142288823*^9, 3.727456186372755*^9}, 3.727456826850039*^9, 
   3.727457103498486*^9, 3.7274626011682777`*^9, 3.7274721377771683`*^9, 
   3.7274855110572844`*^9, 3.727486308524558*^9, 3.727878578139612*^9, 
   3.727880787216714*^9, 3.727881187690591*^9, 3.727881367391988*^9, 
   3.727915385038457*^9, 3.727918036443694*^9, 3.727918094268628*^9, 
   3.727924197544126*^9, {3.727927706619681*^9, 3.727927731843884*^9}, 
   3.727967810043667*^9, 3.727968732947627*^9, 3.727969807968458*^9, 
   3.72796995487074*^9, 3.728044351457707*^9, 3.728046447476817*^9, 
   3.7280664694244013`*^9, 3.7280681205745*^9, 3.728083783151114*^9, 
   3.7280907411475573`*^9, 3.728169444868794*^9, 3.7281695404344788`*^9, 
   3.7281698225833893`*^9, 3.728169882612453*^9, 
   3.728252955102865*^9},ExpressionUUID->"128d120e-0cac-4dd6-b2fc-\
d1d8e53de738"]
}, Open  ]],

Cell[TextData[{
 "The matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "A"}], ")"}], 
     RowBox[{"-", "1"}]], "\[CenterDot]", 
    RowBox[{"A", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "04ef20b8-51b5-460f-b822-21c6e642d720"],
 " is the ",
 StyleBox["Moore-Penrose left pseudoinverse",
  FontSlant->"Italic"],
 ". Wolfram has a built-in for it. We get exactly the same answer as above:"
}], "Text",
 CellChangeTimes->{{3.727433101666657*^9, 3.727433150009388*^9}, {
  3.7280917743950377`*^9, 
  3.728091785282933*^9}},ExpressionUUID->"22066f22-5f02-4533-b3d3-\
2bdd51ce3ac6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox["PseudoInverse",
    Background->RGBColor[0.87, 0.94, 1]], "[", "partials", "]"}], ".", 
  "data"}]], "Input",
 CellChangeTimes->{{3.7273712853724957`*^9, 
  3.727371293874542*^9}},ExpressionUUID->"9edc8455-1cfe-45cf-b25c-\
52a429d0fde9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.3532454719589271`", ",", 
   RowBox[{"-", "0.28741906000778844`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7273712944857807`*^9, 3.727379374585855*^9, 3.7273796194663477`*^9, 
   3.727382952487862*^9, 3.7274396355559683`*^9, 3.727442992319318*^9, 
   3.727443422251007*^9, 3.7274434529627523`*^9, 3.7274445876951447`*^9, 
   3.727444680417789*^9, 3.7274455722476873`*^9, 3.727446246720119*^9, 
   3.72744640647122*^9, 3.727446838471692*^9, {3.727446885072898*^9, 
   3.727447072503195*^9}, 3.727447292697041*^9, 3.7274473494713697`*^9, 
   3.727447838830246*^9, 3.7274499040967627`*^9, 3.727450180082849*^9, 
   3.727454844964015*^9, 3.727455079266862*^9, 3.727455974717*^9, {
   3.727456142338996*^9, 3.727456186421357*^9}, 3.7274568268760567`*^9, 
   3.727457103548245*^9, 3.7274626012243567`*^9, 3.727472137829957*^9, 
   3.7274855111041203`*^9, 3.7274863085745363`*^9, 3.727878578191661*^9, 
   3.727880787262898*^9, 3.7278811877447987`*^9, 3.7278813674336567`*^9, 
   3.727915385085929*^9, 3.7279180365110283`*^9, 3.7279180943317223`*^9, 
   3.727924197609661*^9, {3.727927706685451*^9, 3.727927731906424*^9}, 
   3.7279678100965147`*^9, 3.727968733006201*^9, 3.727969808022567*^9, 
   3.727969954920972*^9, 3.728044351520423*^9, 3.7280464475530863`*^9, 
   3.72806646947083*^9, 3.7280681206141787`*^9, 3.728083783213682*^9, 
   3.728090741206085*^9, 3.7281694449283533`*^9, 3.72816954049078*^9, 
   3.728169822646145*^9, 3.7281698826713457`*^9, 
   3.728252955169929*^9},ExpressionUUID->"acb74e95-8e68-4b6e-a195-\
8c5dd45bf9b1"]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "A"}], ")"}], 
     RowBox[{"-", "1"}]], "\[CenterDot]", 
    RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "\[CapitalZeta]"}], 
   TraditionalForm]],ExpressionUUID->"d629675c-f1af-4371-900e-61ae690a0095"],
 " is a nasty computation at even moderate scale: in memory usage, in time, \
and in numerical risk. Eliminate these defects with a recurrence. "
}], "Text",
 CellChangeTimes->{{3.727472215578988*^9, 3.727472331662753*^9}, {
  3.727472374436943*^9, 3.727472378052897*^9}, {3.727475400731699*^9, 
  3.727475478400813*^9}, {3.727486165404456*^9, 3.727486166210432*^9}, {
  3.7278779774894447`*^9, 3.7278779789823847`*^9}, {3.7279659504745617`*^9, 
  3.7279659782582006`*^9}},ExpressionUUID->"85229b37-7e0e-4646-b20e-\
f235abeab01d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Recurrence", "Chapter",
 CellChangeTimes->{{3.7270402093685093`*^9, 3.727040216990353*^9}, {
  3.72744887906024*^9, 3.727448879173937*^9}},
 CellTags->"c:9",ExpressionUUID->"fd4fd582-c1a0-4c42-9348-d74fc4ea628a"],

Cell[TextData[{
 StyleBox["Fold",
  FontSlant->"Italic"],
 " the following recurrence over ",
 Cell[BoxData[
  FormBox["\[CapitalZeta]", TraditionalForm]],ExpressionUUID->
  "604c3712-17a2-49f9-be34-dd3b93db078a"],
 " and ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "cf261e04-8ab6-46fc-8bda-0e7b27452129"],
 ":"
}], "Text",
 CellChangeTimes->{{3.7274333353229113`*^9, 3.727433378179881*^9}, {
  3.7274334464649353`*^9, 3.727433551754867*^9}, {3.727433834133542*^9, 
  3.727433857990193*^9}, {3.7274406408677483`*^9, 3.727440686530654*^9}, {
  3.7274413441593647`*^9, 3.7274413518281183`*^9}, {3.727472397267685*^9, 
  3.727472404763022*^9}, {3.727475498217351*^9, 
  3.727475507311516*^9}},ExpressionUUID->"bb72127d-3f0d-4da3-b426-\
15c588d476b8"],

Cell[BoxData[{
 FormBox[
  RowBox[{"\[Psi]", "\[LeftArrow]", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[CapitalLambda]", "+", 
       RowBox[{
        RowBox[{"a", "\[Transpose]"}], "\[CenterDot]", "a"}]}], ")"}], 
     RowBox[{"-", "1"}]], "\[CenterDot]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "\[Transpose]"}], "\[CenterDot]", "\[Zeta]"}], "+", 
      RowBox[{"\[CapitalLambda]", "\[CenterDot]", "\[Psi]"}]}], ")"}]}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"\[CapitalLambda]", "\[LeftArrow]", 
   RowBox[{"(", 
    RowBox[{"\[CapitalLambda]", "+", 
     RowBox[{
      RowBox[{"a", "\[Transpose]"}], "\[CenterDot]", "a"}]}], ")"}]}], 
  TraditionalForm]}], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7274335859903107`*^9, 3.727433717944153*^9}, {
  3.727435926163211*^9, 3.7274359787146387`*^9}, {3.7274435816067543`*^9, 
  3.7274435995641823`*^9}, {3.727443898455867*^9, 
  3.727443902554981*^9}},ExpressionUUID->"016e5a68-3e36-4cea-9454-\
b798ab33d773"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["\[Psi]", TraditionalForm]],ExpressionUUID->
  "84ecfef9-a385-4ee2-835c-20343526e4eb"],
 " is the current estimate of \[CapitalXi], ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "41864a27-6f36-420e-b645-2927d78e3708"],
 " and ",
 Cell[BoxData[
  FormBox["\[Zeta]", TraditionalForm]],ExpressionUUID->
  "2b565737-a5ee-44e7-8efe-f18183bf67de"],
 " are matched rows of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "6b37a4e5-effb-4aee-9c93-86475a33aa78"],
 " and ",
 Cell[BoxData[
  FormBox["\[CapitalZeta]", TraditionalForm]],ExpressionUUID->
  "fd030f9e-1732-4ac1-8aec-397d5675748d"],
 ", and ",
 Cell[BoxData[
  FormBox["\[CapitalLambda]", TraditionalForm]],ExpressionUUID->
  "87eb8a64-1e2e-4913-8996-51feec2cb0a3"],
 " accumulates ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "A"}], TraditionalForm]],
  ExpressionUUID->"7020e26d-692e-481d-8e10-cda9feb1b0b2"],
 ". "
}], "Text",
 CellChangeTimes->{{3.727433690566415*^9, 3.727433691990076*^9}, {
   3.727433722702998*^9, 3.727433752037438*^9}, {3.727433801728943*^9, 
   3.727433813439355*^9}, {3.727435879529455*^9, 3.727435920139254*^9}, {
   3.7274395624863253`*^9, 3.72743960583661*^9}, {3.727439679294853*^9, 
   3.727439942216538*^9}, {3.727440429170088*^9, 3.727440449936098*^9}, {
   3.727440693988052*^9, 3.727440706787099*^9}, {3.727442440538804*^9, 
   3.7274424436438828`*^9}, {3.727443225488162*^9, 3.727443283700737*^9}, {
   3.727443629007498*^9, 3.727443630821762*^9}, {3.727445076605159*^9, 
   3.7274450788697367`*^9}, {3.727454527614051*^9, 3.727454553816103*^9}, {
   3.7274545955114317`*^9, 3.727454595511548*^9}, {3.7274546866285877`*^9, 
   3.727454763133893*^9}, {3.727455239597176*^9, 3.727455255845674*^9}, {
   3.7274553253206472`*^9, 3.727455326184396*^9}, 3.727455653598051*^9, {
   3.727472422563363*^9, 3.7274724518468323`*^9}, {3.7274743159268417`*^9, 
   3.7274743397668333`*^9}, {3.727475519390863*^9, 
   3.727475555533572*^9}},ExpressionUUID->"0e10d69e-7208-46f3-893f-\
ad44ce117fee"],

Cell["\<\
Derive the recurrence as follows: Treat the estimate-so-far, \
\>", "Text",
 CellChangeTimes->{{3.727433690566415*^9, 3.727433691990076*^9}, {
   3.727433722702998*^9, 3.727433752037438*^9}, {3.727433801728943*^9, 
   3.727433813439355*^9}, {3.727435879529455*^9, 3.727435920139254*^9}, {
   3.7274395624863253`*^9, 3.72743960583661*^9}, {3.727439679294853*^9, 
   3.727439942216538*^9}, {3.727440429170088*^9, 3.727440449936098*^9}, {
   3.727440693988052*^9, 3.727440706787099*^9}, {3.727442440538804*^9, 
   3.7274424436438828`*^9}, {3.727443225488162*^9, 3.727443283700737*^9}, {
   3.727443629007498*^9, 3.727443630821762*^9}, {3.727445076605159*^9, 
   3.7274450788697367`*^9}, {3.727454527614051*^9, 3.727454553816103*^9}, {
   3.7274545955114317`*^9, 3.727454595511548*^9}, {3.7274546866285877`*^9, 
   3.727454763133893*^9}, {3.727455239597176*^9, 3.727455255845674*^9}, {
   3.7274553253206472`*^9, 3.727455326184396*^9}, 3.727455653598051*^9, {
   3.727472422563363*^9, 3.7274724518468323`*^9}, {3.7274743159268417`*^9, 
   3.727474381777117*^9}, {3.7274744338469057`*^9, 3.727474441826235*^9}, {
   3.727474630428966*^9, 3.727474631651125*^9}, {3.727474814968113*^9, 
   3.7274748698817673`*^9}, {3.727475577962327*^9, 3.7274756335231857`*^9}, {
   3.7278780344572*^9, 3.727878045059162*^9}, 3.727966016823514*^9, {
   3.7279661542692223`*^9, 3.727966155428653*^9}, {3.727966432921638*^9, 
   3.7279665200041933`*^9}},ExpressionUUID->"77e515e0-b4b9-495c-85af-\
429d50b65af5"],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[Psi]", 
    RowBox[{"so", "-", "far"}]], 
   OverscriptBox["=", "def"], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "A"}], ")"}], 
     RowBox[{"-", "1"}]], "\[CenterDot]", 
    RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", 
    SubscriptBox["\[CapitalZeta]", 
     RowBox[{"so", "-", "far"}]]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.727433690566415*^9, 3.727433691990076*^9}, {
   3.727433722702998*^9, 3.727433752037438*^9}, {3.727433801728943*^9, 
   3.727433813439355*^9}, {3.727435879529455*^9, 3.727435920139254*^9}, {
   3.7274395624863253`*^9, 3.72743960583661*^9}, {3.727439679294853*^9, 
   3.727439942216538*^9}, {3.727440429170088*^9, 3.727440449936098*^9}, {
   3.727440693988052*^9, 3.727440706787099*^9}, {3.727442440538804*^9, 
   3.7274424436438828`*^9}, {3.727443225488162*^9, 3.727443283700737*^9}, {
   3.727443629007498*^9, 3.727443630821762*^9}, {3.727445076605159*^9, 
   3.7274450788697367`*^9}, {3.727454527614051*^9, 3.727454553816103*^9}, {
   3.7274545955114317`*^9, 3.727454595511548*^9}, {3.7274546866285877`*^9, 
   3.727454763133893*^9}, {3.727455239597176*^9, 3.727455255845674*^9}, {
   3.7274553253206472`*^9, 3.727455326184396*^9}, 3.727455653598051*^9, {
   3.727472422563363*^9, 3.7274724518468323`*^9}, {3.7274743159268417`*^9, 
   3.727474381777117*^9}, {3.7274744338469057`*^9, 3.727474441826235*^9}, {
   3.727474630428966*^9, 3.727474631651125*^9}, {3.727474814968113*^9, 
   3.7274748698817673`*^9}, {3.727475577962327*^9, 3.7274756335231857`*^9}, {
   3.7278780344572*^9, 3.727878045059162*^9}, 3.727966016823514*^9, {
   3.7279661542692223`*^9, 3.727966155428653*^9}, {3.727966432921638*^9, 
   3.727966534440386*^9}},ExpressionUUID->"501bd69d-ec91-4a6f-a746-\
86cc49e98913"],

Cell[TextData[{
 "as just one more (a-priori) observation with information matrix \
(proportional to inverse covariance) ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["A", 
       RowBox[{"so", "-", "far"}]], "\[Transpose]"}], "\[CenterDot]", 
     SubscriptBox["A", 
      RowBox[{"so", "-", "far"}]]}]}], TraditionalForm]],ExpressionUUID->
  "f70acf2e-dd95-4266-8e73-17f50ce74189"],
 ". The scalar ",
 StyleBox["performance",
  FontSlant->"Italic"],
 " or ",
 StyleBox["squared error",
  FontSlant->"Italic"],
 " of the estimate, so far, is"
}], "Text",
 CellChangeTimes->{{3.727433690566415*^9, 3.727433691990076*^9}, {
   3.727433722702998*^9, 3.727433752037438*^9}, {3.727433801728943*^9, 
   3.727433813439355*^9}, {3.727435879529455*^9, 3.727435920139254*^9}, {
   3.7274395624863253`*^9, 3.72743960583661*^9}, {3.727439679294853*^9, 
   3.727439942216538*^9}, {3.727440429170088*^9, 3.727440449936098*^9}, {
   3.727440693988052*^9, 3.727440706787099*^9}, {3.727442440538804*^9, 
   3.7274424436438828`*^9}, {3.727443225488162*^9, 3.727443283700737*^9}, {
   3.727443629007498*^9, 3.727443630821762*^9}, {3.727445076605159*^9, 
   3.7274450788697367`*^9}, {3.727454527614051*^9, 3.727454553816103*^9}, {
   3.7274545955114317`*^9, 3.727454595511548*^9}, {3.7274546866285877`*^9, 
   3.727454763133893*^9}, {3.727455239597176*^9, 3.727455255845674*^9}, {
   3.7274553253206472`*^9, 3.727455326184396*^9}, 3.727455653598051*^9, {
   3.727472422563363*^9, 3.7274724518468323`*^9}, {3.7274743159268417`*^9, 
   3.727474381777117*^9}, {3.7274744338469057`*^9, 3.727474441826235*^9}, {
   3.727474630428966*^9, 3.727474631651125*^9}, {3.727474814968113*^9, 
   3.7274748698817673`*^9}, {3.727475577962327*^9, 3.7274756335231857`*^9}, {
   3.7278780344572*^9, 3.727878045059162*^9}, 3.727966016823514*^9, {
   3.7279661542692223`*^9, 3.727966155428653*^9}, {3.727966432921638*^9, 
   3.7279665258422337`*^9}, {3.728091815451824*^9, 
   3.728091821154443*^9}},ExpressionUUID->"458ce310-6734-4e36-a65c-\
7771535a1724"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"J", "(", "x", ")"}], "  ", "=", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CapitalZeta]", 
         RowBox[{"so", "-", "far"}]], "-", 
        RowBox[{
         SubscriptBox["A", 
          RowBox[{"so", "-", "far"}]], "\[CenterDot]", "x"}]}], ")"}], 
      "\[Transpose]"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[CapitalZeta]", 
        RowBox[{"so", "-", "far"}]], "-", 
       RowBox[{
        SubscriptBox["A", 
         RowBox[{"so", "-", "far"}]], "\[CenterDot]", "x"}]}], ")"}]}], "  ", 
    "=", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", 
        SubscriptBox["\[Psi]", 
         RowBox[{"so", "-", "far"}]]}], ")"}], "\[Transpose]"}], 
     "\[CenterDot]", "\[CapitalLambda]", "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{"x", "-", 
       SubscriptBox["\[Psi]", 
        RowBox[{"so", "-", "far"}]]}], ")"}]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.727433690566415*^9, 3.727433691990076*^9}, {
   3.727433722702998*^9, 3.727433752037438*^9}, {3.727433801728943*^9, 
   3.727433813439355*^9}, {3.727435879529455*^9, 3.727435920139254*^9}, {
   3.7274395624863253`*^9, 3.72743960583661*^9}, {3.727439679294853*^9, 
   3.727439942216538*^9}, {3.727440429170088*^9, 3.727440449936098*^9}, {
   3.727440693988052*^9, 3.727440706787099*^9}, {3.727442440538804*^9, 
   3.7274424436438828`*^9}, {3.727443225488162*^9, 3.727443283700737*^9}, {
   3.727443629007498*^9, 3.727443630821762*^9}, {3.727445076605159*^9, 
   3.7274450788697367`*^9}, {3.727454527614051*^9, 3.727454553816103*^9}, {
   3.7274545955114317`*^9, 3.727454595511548*^9}, {3.7274546866285877`*^9, 
   3.727454763133893*^9}, {3.727455239597176*^9, 3.727455255845674*^9}, {
   3.7274553253206472`*^9, 3.727455326184396*^9}, 3.727455653598051*^9, {
   3.727472422563363*^9, 3.7274724518468323`*^9}, {3.7274743159268417`*^9, 
   3.727474381777117*^9}, {3.7274744338469057`*^9, 3.727474441826235*^9}, {
   3.727474630428966*^9, 3.727474631651125*^9}, {3.727474814968113*^9, 
   3.7274748698817673`*^9}, {3.727475577962327*^9, 3.7274756335231857`*^9}, {
   3.7278780344572*^9, 3.727878045059162*^9}, {3.727966018203845*^9, 
   3.727966033785829*^9}, {3.727966098475103*^9, 3.7279661060884457`*^9}, {
   3.727966143206888*^9, 3.727966171156918*^9}, {3.7279662043636503`*^9, 
   3.727966213619438*^9}, {3.727966500313883*^9, 
   3.727966508975876*^9}},ExpressionUUID->"069cf11b-95eb-4b0f-af06-\
a2d3b934a885"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "dabda0f9-23ef-422e-9934-9019237efd52"],
 " is the unknown true parameter vector, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    RowBox[{"so", "-", "far"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "684f54e2-bac0-42af-ad38-c1084a76ae15"],
 " is the column vector of all observations so-far, and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["A", 
       RowBox[{"so", "-", "far"}]], "\[Transpose]"}], "\[CenterDot]", 
     SubscriptBox["A", 
      RowBox[{"so", "-", "far"}]]}]}], TraditionalForm]],ExpressionUUID->
  "88dc0af1-fc18-4f07-8ec8-6c0cef0ffb99"],
 " . Adding a new observation, ",
 Cell[BoxData[
  FormBox["\[Zeta]", TraditionalForm]],ExpressionUUID->
  "f1276f71-b142-463f-9ad8-441cb4641cde"],
 " and its corresponding partial row co-vector ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "53497380-bd47-4d43-9f90-bf6637131b87"],
 ", increases the error ",
 Cell[BoxData[
  FormBox[
   RowBox[{"J", 
    RowBox[{"(", "x", ")"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f0d40762-7e96-4647-bdc6-37929527ce7b"],
 " by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Zeta]", "-", 
       RowBox[{"a", "\[CenterDot]", "x"}]}], ")"}], "\[Transpose]"}], 
    "\[CenterDot]", 
    RowBox[{"(", 
     RowBox[{"\[Zeta]", "-", 
      RowBox[{"a", "\[CenterDot]", "x"}]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"9ec14d68-822d-4fce-a2c9-85c5fb353fe0"],
 ". Minimize the new total error with respect to ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "96d4bc3a-53e7-428b-90b0-341c7f7145b3"],
 " to find the recurrence (exercise)."
}], "Text",
 CellChangeTimes->{{3.727433690566415*^9, 3.727433691990076*^9}, {
   3.727433722702998*^9, 3.727433752037438*^9}, {3.727433801728943*^9, 
   3.727433813439355*^9}, {3.727435879529455*^9, 3.727435920139254*^9}, {
   3.7274395624863253`*^9, 3.72743960583661*^9}, {3.727439679294853*^9, 
   3.727439942216538*^9}, {3.727440429170088*^9, 3.727440449936098*^9}, {
   3.727440693988052*^9, 3.727440706787099*^9}, {3.727442440538804*^9, 
   3.7274424436438828`*^9}, {3.727443225488162*^9, 3.727443283700737*^9}, {
   3.727443629007498*^9, 3.727443630821762*^9}, {3.727445076605159*^9, 
   3.7274450788697367`*^9}, {3.727454527614051*^9, 3.727454553816103*^9}, {
   3.7274545955114317`*^9, 3.727454595511548*^9}, {3.7274546866285877`*^9, 
   3.727454763133893*^9}, {3.727455239597176*^9, 3.727455255845674*^9}, {
   3.7274553253206472`*^9, 3.727455326184396*^9}, 3.727455653598051*^9, {
   3.727472422563363*^9, 3.7274724518468323`*^9}, {3.7274743159268417`*^9, 
   3.727474381777117*^9}, {3.7274744338469057`*^9, 3.727474441826235*^9}, {
   3.727474630428966*^9, 3.727474631651125*^9}, {3.727474814968113*^9, 
   3.7274748698817673`*^9}, {3.727475577962327*^9, 3.7274756335231857`*^9}, {
   3.7278780344572*^9, 3.727878045059162*^9}, {3.727966018203845*^9, 
   3.727966022744957*^9}, {3.727966060652214*^9, 3.7279660814388037`*^9}, {
   3.727966122293776*^9, 3.727966131387149*^9}, {3.727966225308963*^9, 
   3.7279663153865147`*^9}, {3.72796657797972*^9, 
   3.7279665841676197`*^9}},ExpressionUUID->"67ca1e83-e46d-4973-b522-\
be62ac11bdaf"],

Cell[TextData[{
 "Bootstrap the recurrence with initial values of \[Psi] and \
\[CapitalLambda], namely ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "0"], TraditionalForm]],ExpressionUUID->
  "73a85ed3-e894-4bfc-a96e-efefe9df0681"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalLambda]", "0"], TraditionalForm]],ExpressionUUID->
  "775c31a5-4ac9-4b8f-b3a8-c0737b324519"],
 ". We show below that choices for the values of these affect regularization \
against over-fitting. "
}], "Text",
 CellChangeTimes->{{3.727433690566415*^9, 3.727433691990076*^9}, {
   3.727433722702998*^9, 3.727433752037438*^9}, {3.727433801728943*^9, 
   3.727433813439355*^9}, {3.727435879529455*^9, 3.727435920139254*^9}, {
   3.7274395624863253`*^9, 3.72743960583661*^9}, {3.727439679294853*^9, 
   3.727439942216538*^9}, {3.727440429170088*^9, 3.727440449936098*^9}, {
   3.727440693988052*^9, 3.727440706787099*^9}, {3.727442440538804*^9, 
   3.7274424436438828`*^9}, {3.727443225488162*^9, 3.727443283700737*^9}, {
   3.727443629007498*^9, 3.727443630821762*^9}, {3.727445076605159*^9, 
   3.7274450788697367`*^9}, {3.727454527614051*^9, 3.727454553816103*^9}, {
   3.7274545955114317`*^9, 3.727454595511548*^9}, {3.7274546866285877`*^9, 
   3.727454763133893*^9}, {3.727455239597176*^9, 3.727455255845674*^9}, {
   3.7274553253206472`*^9, 3.727455326184396*^9}, 3.727455653598051*^9, {
   3.727472422563363*^9, 3.7274724518468323`*^9}, {3.727475653063583*^9, 
   3.727475668421556*^9}, {3.727878056292527*^9, 3.7278781337625647`*^9}, {
   3.727966321732579*^9, 3.727966322440028*^9}, {3.727966591137054*^9, 
   3.727966628253271*^9}, {3.727966659401678*^9, 3.7279667699874363`*^9}, {
   3.728091848600717*^9, 
   3.728091848856659*^9}},ExpressionUUID->"7d01d2b4-4b18-4655-8a4c-\
1f7d486f72c5"],

Cell[TextData[{
 "The example below starts with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Psi]", "0"], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {"0", "0"}
       }], ")"}], "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "f13cc747-4760-4277-bf16-4bb8e28f1d04"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalLambda]", "0"], "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]], "0"}
        }], ")"}], 
      RowBox[{"(", GridBox[{
         {"0", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}
        }], ")"}]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "132cdd99-6a92-4a2f-a994-ff259000e19f"],
 ". "
}], "Text",
 CellChangeTimes->{{3.727433690566415*^9, 3.727433691990076*^9}, {
   3.727433722702998*^9, 3.727433752037438*^9}, {3.727433801728943*^9, 
   3.727433813439355*^9}, {3.727435879529455*^9, 3.727435920139254*^9}, {
   3.7274395624863253`*^9, 3.72743960583661*^9}, {3.727439679294853*^9, 
   3.727439942216538*^9}, {3.727440429170088*^9, 3.727440449936098*^9}, {
   3.727440693988052*^9, 3.727440706787099*^9}, {3.727442440538804*^9, 
   3.7274424436438828`*^9}, {3.727443225488162*^9, 3.727443283700737*^9}, {
   3.727443629007498*^9, 3.727443630821762*^9}, {3.727445076605159*^9, 
   3.7274450788697367`*^9}, {3.727454527614051*^9, 3.727454553816103*^9}, {
   3.7274545955114317`*^9, 3.727454595511548*^9}, {3.7274546866285877`*^9, 
   3.727454763133893*^9}, {3.727455239597176*^9, 3.727455255845674*^9}, {
   3.7274553253206472`*^9, 3.727455326184396*^9}, 3.727455653598051*^9, {
   3.727472422563363*^9, 3.7274724518468323`*^9}, {3.727475653063583*^9, 
   3.727475668421556*^9}, {3.727878056292527*^9, 3.7278781337625647`*^9}, {
   3.727966321732579*^9, 3.727966322440028*^9}, {3.727966591137054*^9, 
   3.727966628253271*^9}, {3.727966659401678*^9, 
   3.72796676698983*^9}},ExpressionUUID->"07922d7a-506f-4713-b30e-\
6f3628d06609"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "update", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"update", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Psi]_", ",", "\[CapitalLambda]_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Zeta]_", ",", "a_"}], "}"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalPi]", "=", 
       RowBox[{"(", 
        RowBox[{"\[CapitalLambda]", "+", 
         RowBox[{
          RowBox[{"a", "\[Transpose]"}], ".", "a"}]}], ")"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Inverse", "[", "\[CapitalPi]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "\[Transpose]"}], ".", "\[Zeta]"}], "+", " ", 
          RowBox[{"\[CapitalLambda]", ".", "\[Psi]"}]}], ")"}]}], ",", 
       "\[CapitalPi]"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"MatrixForm", "/@", "\[IndentingNewLine]", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {"mBar"},
         {"bBar"}
        }], ")"}], ",", "\[CapitalPi]"}], "}"}], "=", 
    RowBox[{
     StyleBox["Fold",
      Background->RGBColor[1, 1, 0]], "[", 
     RowBox[{"update", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", GridBox[{
           {"0"},
           {"0"}
          }], ")"}], ",", 
        RowBox[{"(", GridBox[{
           {"1.0*^-6", "0"},
           {"0", "1.0*^-6"}
          }], ")"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"List", "/@", "data"}], ",", 
         RowBox[{"List", "/@", "partials"}]}], "}"}], "\[Transpose]"}]}], 
     "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.727054852495049*^9, 3.72705494257406*^9}, {
   3.727055026792467*^9, 3.727055093506559*^9}, {3.7270551930291023`*^9, 
   3.727055263833913*^9}, {3.727055297216107*^9, 3.7270554270906563`*^9}, {
   3.7270560338846903`*^9, 3.72705612788085*^9}, {3.7270561855129213`*^9, 
   3.7270561959544077`*^9}, {3.727056250031129*^9, 3.727056367103942*^9}, {
   3.727056427865035*^9, 3.727056443080068*^9}, {3.727056561323501*^9, 
   3.727056598046468*^9}, {3.727056640141169*^9, 3.727056654582451*^9}, {
   3.727056728700244*^9, 3.7270567914565277`*^9}, {3.727056869366274*^9, 
   3.727056921039433*^9}, 3.72705709924362*^9, {3.727057420502048*^9, 
   3.7270575464285316`*^9}, {3.7270577446377487`*^9, 3.727057775909028*^9}, {
   3.7270578799866133`*^9, 3.727057901007744*^9}, 3.7270581603330593`*^9, {
   3.727058349930079*^9, 3.7270584478842707`*^9}, {3.727058490337566*^9, 
   3.727058577824399*^9}, {3.727058673744141*^9, 3.7270586947547493`*^9}, {
   3.727058788099071*^9, 3.7270588909590683`*^9}, {3.727058934322414*^9, 
   3.7270589393580847`*^9}, {3.72705898616982*^9, 3.7270589868650723`*^9}, {
   3.7270592331231947`*^9, 3.727059237300102*^9}, {3.7274435231168203`*^9, 
   3.727443546500602*^9}, {3.727443876120749*^9, 3.7274438848810577`*^9}, {
   3.727444759010458*^9, 3.727444822403467*^9}, {3.727444904584729*^9, 
   3.727444917600658*^9}, {3.727444951170147*^9, 3.72744495624857*^9}, {
   3.727455276322372*^9, 3.7274553027713842`*^9}, {3.727455828581184*^9, 
   3.727455858661305*^9}, {3.7274561810931997`*^9, 3.727456183162497*^9}, {
   3.727472496770452*^9, 3.727472540592374*^9}, {3.727472571262414*^9, 
   3.7274725926081057`*^9}, {3.727473460371025*^9, 3.727473470385874*^9}, {
   3.727967024755598*^9, 3.7279670373987417`*^9}, 
   3.727967235445434*^9},ExpressionUUID->"a3797c17-be41-4136-8ecd-\
5a7b55603224"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.3532454679888166`"},
       {
        RowBox[{"-", "0.2874190536226594`"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"280.35593320338984`", "119.`"},
       {"119.`", "119.000001`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.727472529149095*^9, 3.727472541371006*^9}, {
   3.727472582072073*^9, 3.727472596728858*^9}, 3.72747347227721*^9, 
   3.727485511156743*^9, 3.727486308620812*^9, 3.727878578245182*^9, 
   3.727880787316627*^9, 3.727881187795374*^9, 3.72788136748368*^9, 
   3.7279153851348257`*^9, 3.727918036577284*^9, 3.7279180943800097`*^9, 
   3.727924197677032*^9, {3.727927706752205*^9, 3.727927731973207*^9}, 
   3.727967810149074*^9, 3.7279687330645437`*^9, 3.727969808085505*^9, 
   3.727969954973427*^9, 3.728044351569767*^9, 3.72804644760787*^9, 
   3.728066469525443*^9, 3.728068120668467*^9, 3.728083783280686*^9, 
   3.728090741272605*^9, 3.728169444994749*^9, 3.728169540556728*^9, 
   3.7281698227111*^9, 3.7281698827372704`*^9, 
   3.72825295523654*^9},ExpressionUUID->"b02e9284-fb20-48cf-839b-\
5ad3e91b103c"]
}, Open  ]],

Cell[TextData[{
 "The estimates ",
 Cell[BoxData[
  FormBox["mBar", TraditionalForm]], "Code",ExpressionUUID->
  "ace851a5-9f4d-49ce-a0fa-1ee094af68d5"],
 " and ",
 Cell[BoxData[
  FormBox["bBar", TraditionalForm]], "Code",ExpressionUUID->
  "1f76bfd3-e9db-47db-a0f3-738e5d40384b"],
 " are exactly what we got from Wolfram\[CloseCurlyQuote]s built-in. For this \
example, the choice of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "0"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7a752cc3-5524-4727-98d1-99e9e3e3c2f9"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalLambda]", "0"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1040a599-038c-43fc-961e-93c029f458cd"],
 " had negligible effect."
}], "Text",
 CellChangeTimes->{{3.727455669635949*^9, 3.727455714844105*^9}, {
  3.727456293561727*^9, 3.727456338621636*^9}, {3.727456381984915*^9, 
  3.727456493199937*^9}, {3.7274567040936413`*^9, 3.727456704869124*^9}, {
  3.727456739701139*^9, 3.72745677855204*^9}, {3.727472821547103*^9, 
  3.727472872838442*^9}, {3.7279667472572412`*^9, 
  3.72796679667021*^9}},ExpressionUUID->"537d49e2-8fcc-4dda-a513-\
5e51dde5f1ef"],

Cell[TextData[{
 "The mappings of ",
 Cell[BoxData[
  FormBox["List", TraditionalForm]], "Code",ExpressionUUID->
  "370d0a8b-9c99-495c-8b0f-e38240d3f06a"],
 " over the data and partials convert them into column vectors, as required \
by the recurrences in linear-algebra form (column vectors and row \
co-vectors). The earlier applications of Wolfram built-ins and the normal \
equations are promiscuous: they treat lists as column vectors or row-vectors \
as needed by implicit context, then compute inner (dot) products as if the \
distinction did not matter. Python\[CloseCurlyQuote]s numpy has the same \
dubious feature. I call it dubious because such looseness inhibits extension \
to higher dimensions and \.7ftensors. If we are scrupulous in expressing \
column vectors as matrices with one column and co-vectors as matrices with \
one row, we have an easier time with extensions."
}], "Text",
 CellChangeTimes->{{3.727473114735071*^9, 3.727473196429072*^9}, 
   3.727475691841303*^9, {3.727879000591062*^9, 3.727879183230468*^9}, {
   3.727966817515026*^9, 3.727966992448154*^9}, {3.728091889609682*^9, 
   3.7280919220828123`*^9}},ExpressionUUID->"d8883e07-acc1-4242-a8cb-\
c40067337121"],

Cell[TextData[{
 "We might also fold this recurrence over an asynchronous stream, in which \
case it runs in constant memory, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", "n", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "a43af123-6e23-4747-99f5-4541967c6079"],
 ", where ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "554653cf-ce3e-4f63-b5d1-49baddb2469f"],
 " is the dimension (length) of ",
 Cell[BoxData[
  FormBox["\[CapitalXi]", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5cad892a-a66c-4479-a419-39792c33e9e0"],
 ", same as the dimension of each row of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "332e127a-feaa-4be6-a475-985ccedc0886"],
 "."
}], "Text",
 CellChangeTimes->{{3.727878157797224*^9, 
  3.72787827045693*^9}},ExpressionUUID->"498562a8-7fb9-41c8-89eb-\
57fe2a769482"],

Cell[TextData[{
 "The final value of ",
 Cell[BoxData[
  FormBox["\[CapitalLambda]", TraditionalForm]],ExpressionUUID->
  "39d494bd-234a-46ce-b910-d7f503d343eb"],
 " (called ",
 Cell[BoxData[
  FormBox["\[CapitalPi]", TraditionalForm]],ExpressionUUID->
  "8c23b7e5-b715-408b-91a1-2fb52b1f7699"],
 " in the code, a returned value), is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["A", "full"], "\[Transpose]"}], "\[CenterDot]", 
     SubscriptBox["A", "full"]}], "+", 
    SubscriptBox["\[CapitalLambda]", "0"]}], TraditionalForm]],
  ExpressionUUID->"1891af79-d866-486f-a629-9b2b77a22d21"],
 ". The difference between \[CapitalPi] and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["A", "full"], "\[Transpose]"}], "\[CenterDot]", 
    SubscriptBox["A", "full"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "d79187f3-f0a0-4931-8c09-8a661166ccf3"],
 " must be ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalLambda]", "0"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "c764f547-094a-4d7e-9887-56726f224d1b"],
 ":"
}], "Text",
 CellChangeTimes->{{3.727455669635949*^9, 3.727455714844105*^9}, {
  3.727456293561727*^9, 3.727456338621636*^9}, {3.727456381984915*^9, 
  3.727456493199937*^9}, {3.7274567040936413`*^9, 3.727456704869124*^9}, {
  3.727456739701139*^9, 3.72745677855204*^9}, {3.727472821547103*^9, 
  3.727472866769026*^9}, {3.72747570063941*^9, 3.72747570624365*^9}, {
  3.727486207037271*^9, 3.727486226047611*^9}, {3.727967052949963*^9, 
  3.727967092304611*^9}},ExpressionUUID->"436872f7-3223-44e3-a641-\
7304e3a78257"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]", "-", 
  RowBox[{
   RowBox[{"partials", "\[Transpose]"}], ".", "partials"}]}]], "Input",
 CellChangeTimes->{{3.7274551709419003`*^9, 3.727455208922634*^9}, {
  3.727455747486219*^9, 
  3.727455758602953*^9}},ExpressionUUID->"0371799a-125d-4d58-835d-\
8ff44b347f11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"9.999999974752427`*^-7", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "9.999999974752427`*^-7"}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.72745518631077*^9, 3.7274552106865807`*^9}, {
   3.7274552828550367`*^9, 3.727455294638937*^9}, 3.727455760140656*^9, {
   3.72745583557261*^9, 3.7274558626374598`*^9}, 3.727455974817852*^9, {
   3.7274561424375877`*^9, 3.7274561865312757`*^9}, 3.727456826962592*^9, 
   3.727457103648644*^9, 3.7274626013231*^9, 3.727472137933955*^9, 
   3.727485511219474*^9, 3.7274863086743803`*^9, 3.727878578292219*^9, 
   3.727880787367092*^9, 3.72788118784524*^9, 3.727881367533016*^9, 
   3.7279153851883383`*^9, 3.7279180366404953`*^9, 3.727918094433138*^9, 
   3.727924197744144*^9, {3.727927706819661*^9, 3.727927732038946*^9}, 
   3.727967810195277*^9, 3.7279687331233892`*^9, 3.7279698081358833`*^9, 
   3.727969955024419*^9, 3.728044351619812*^9, 3.7280464476574707`*^9, 
   3.728066469570793*^9, 3.7280681207187157`*^9, 3.728083783348742*^9, 
   3.728090741322768*^9, 3.728169445060842*^9, 3.728169540624917*^9, 
   3.7281698227788277`*^9, 3.728169882804495*^9, 
   3.728252955301944*^9},ExpressionUUID->"bf0e6abc-124c-4ae5-813a-\
6187771d6b02"]
}, Open  ]],

Cell[TextData[{
 "The covariance of this estimate ",
 Cell[BoxData[
  FormBox["\[CapitalXi]", TraditionalForm]],ExpressionUUID->
  "05f6e13c-eb2e-49b9-b7d4-f01f499237e6"],
 " is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     FractionBox[
      RowBox[{"n", "-", "1"}], 
      RowBox[{"n", "-", "2"}]], ")"}], "*", 
    RowBox[{"Variance", "\[ThinSpace]", "[", "\[ThinSpace]", 
     RowBox[{"\[CapitalZeta]", "-", 
      RowBox[{"A", "\[CenterDot]", "\[CapitalXi]"}]}], "\[ThinSpace]", "]"}], 
    "*", 
    SuperscriptBox["\[CapitalLambda]", 
     RowBox[{"-", "1"}]]}], TraditionalForm]],ExpressionUUID->
  "ed6dc5b0-2569-4482-a89f-9e45c1d9c8e7"],
 " except for a small contribution from the a-priori information ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalLambda]", "0"], TraditionalForm]],ExpressionUUID->
  "117837c1-2354-4d76-b779-38f2077da583"],
 ". The correction factor ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    FractionBox[
     RowBox[{"n", "-", "1"}], 
     RowBox[{"n", "-", "2"}]], ")"}], TraditionalForm]],ExpressionUUID->
  "b55c017a-1015-4a56-951f-cf8b3a01de97"],
 " is a generalization \.7fof Bessel\[CloseCurlyQuote]s correction. The ",
 Cell[BoxData[
  FormBox["2", TraditionalForm]],ExpressionUUID->
  "b7c81e78-cd2f-451d-8792-9b212764ec84"],
 " in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", "-", "2"}], ")"}], TraditionalForm]],ExpressionUUID->
  "d9f330f5-17bd-4ad7-b656-bdd5eb0f57d5"],
 " in the denominator is due to the fact that we\[CloseCurlyQuote]re \
estimating two parameters from the data (see ",
 ButtonBox["VAN DE GEER, Least Squares Estimation, Volume 2, pp. \
1041\[Dash]1045, in Encyclopedia of Statistics in Behavioral Science, Eds. \
Brian S. Everitt & David C. Howell, Wiley, 2005",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://stat.ethz.ch/~geer/bsa199_o.pdf"], None},
  ButtonNote->"https://stat.ethz.ch/~geer/bsa199_o.pdf"],
 "). The denominator of the correction, in general, is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "-", "p"}], TraditionalForm]],ExpressionUUID->
  "5b344576-2589-491a-bed2-c362a3e367e3"],
 ", where ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "ab45ec8c-fdab-4d50-a890-e44870c87fa3"],
 " is the number of data and ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "606cb52c-426a-44c2-baf8-3756d84116c8"],
 " is the number of parameters being estimated."
}], "Text",
 CellChangeTimes->{{3.7274567852393503`*^9, 3.727456791351314*^9}, {
  3.7274626311713448`*^9, 3.727462680678966*^9}, {3.727472647355248*^9, 
  3.727472725986993*^9}, {3.7274728947945757`*^9, 3.727472940968391*^9}, {
  3.727474911778737*^9, 3.727474913439685*^9}, {3.727475723944086*^9, 
  3.727475733135212*^9}, {3.7279249725397797`*^9, 3.727924984997408*^9}, {
  3.727967100099558*^9, 3.7279671039316263`*^9}, {3.7280919485134687`*^9, 
  3.728091949527707*^9}},ExpressionUUID->"684d9ed8-36d2-459e-b878-\
5b3dcfc106d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{
     RowBox[{"partials", "\[Transpose]"}], ".", "partials"}], "]"}], "*", 
   FractionBox[
    RowBox[{"nData", "-", "1"}], 
    RowBox[{"nData", "-", "2"}]], "*", 
   RowBox[{"Variance", "[", 
    RowBox[{"data", "-", 
     RowBox[{"partials", ".", 
      RowBox[{"{", 
       RowBox[{"mBar", ",", "bBar"}], "}"}]}]}], "]"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7274431897876062`*^9, 3.7274432610082397`*^9}, {
   3.7274547829132023`*^9, 3.7274548281175823`*^9}, {3.727454917043985*^9, 
   3.727454946560256*^9}, {3.727455103776779*^9, 3.727455133855278*^9}, {
   3.727455965944152*^9, 3.727455966694631*^9}, {3.7274560116101933`*^9, 
   3.727456093212741*^9}, 3.72745616117476*^9, {3.727456227849722*^9, 
   3.727456234387219*^9}, 
   3.727472952057025*^9},ExpressionUUID->"1794261e-bc00-4147-8301-\
8d76460f977f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0020599578709234014`", 
      RowBox[{"-", "0.002059957870923402`"}]},
     {
      RowBox[{"-", "0.0020599578709234014`"}], "0.004853121085734794`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.727454928111648*^9, 3.72745494746028*^9}, 
   3.727455079366056*^9, {3.727455124455585*^9, 3.72745513496389*^9}, {
   3.727455812047991*^9, 3.727455864570829*^9}, {3.7274559677572517`*^9, 
   3.727455974867505*^9}, {3.727456050499832*^9, 3.727456094070848*^9}, {
   3.7274561424870367`*^9, 3.7274561865735826`*^9}, 3.727456239429667*^9, 
   3.7274568270134773`*^9, 3.727457103698028*^9, 3.7274626013731823`*^9, 
   3.727472137981408*^9, 3.727472954371911*^9, 3.727485511269794*^9, 
   3.7274863087240047`*^9, 3.727878578345954*^9, 3.7278807874127703`*^9, 
   3.7278811878958673`*^9, 3.727881367587798*^9, 3.72791538523671*^9, 
   3.727918036690276*^9, 3.7279180944824457`*^9, 3.727924197810088*^9, {
   3.727927706882574*^9, 3.727927732105157*^9}, 3.727967810245639*^9, 
   3.727968733172824*^9, 3.727969808184746*^9, 3.7279699550719757`*^9, 
   3.728044351669427*^9, 3.728046447707358*^9, 3.728066469624007*^9, 
   3.728068120768632*^9, 3.728083783416733*^9, 3.728090741371833*^9, 
   3.7281694451273947`*^9, 3.7281695406895*^9, 3.728169822844509*^9, 
   3.72816988287199*^9, 
   3.728252955370139*^9},ExpressionUUID->"b9e49f38-fed2-4edf-990c-\
56ff24d038a0"]
}, Open  ]],

Cell[TextData[{
 "Except for the reversed order, this is the same covariance matrix that \
Wolfram\[CloseCurlyQuote]s ",
 Cell[BoxData[
  FormBox["LinearModel", TraditionalForm]], "Code",
  FormatType->"TraditionalForm",ExpressionUUID->
  "927b6594-6052-40b2-8ebb-205fa75a1b9c"],
 " reports:"
}], "Text",
 CellChangeTimes->{{3.727454999214408*^9, 3.7274550230616837`*^9}, {
  3.7274550552077837`*^9, 3.727455069630582*^9}, {3.727456815268976*^9, 
  3.72745682043734*^9}, {3.727462715836411*^9, 3.7274627328032312`*^9}, {
  3.7281214802053127`*^9, 
  3.72812148718871*^9}},ExpressionUUID->"131da65d-6802-432c-8b70-\
cde6d0bff1dd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reverse", "@", 
   RowBox[{"(", 
    RowBox[{"Reverse", "/@", 
     RowBox[{
      StyleBox["model",
       Background->RGBColor[1, 1, 0]], "[", "\"\<CovarianceMatrix\>\"", 
      "]"}]}], ")"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7274549491384163`*^9, 3.727454976961426*^9}, {
  3.727455029510784*^9, 
  3.727455047125711*^9}},ExpressionUUID->"83646139-4eb0-4c6e-a6e8-\
07eb66ecae26"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0020599578709234005`", 
      RowBox[{"-", "0.0020599578709234005`"}]},
     {
      RowBox[{"-", "0.0020599578709234005`"}], "0.004853121085734791`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.727454966848208*^9, 3.727454977604638*^9}, 
   3.727455048234387*^9, 3.7274550794174843`*^9, {3.727455816251672*^9, 
   3.727455842245935*^9}, 3.727455974915807*^9, {3.72745614253647*^9, 
   3.727456186624792*^9}, 3.727456827063628*^9, 3.727457103748019*^9, 
   3.727462601420088*^9, 3.727472138034376*^9, 3.727485511317802*^9, 
   3.7274863087704897`*^9, 3.727878578395075*^9, 3.727880787467642*^9, 
   3.727881187944561*^9, 3.727881367638068*^9, 3.7279153852886133`*^9, 
   3.727918036745358*^9, 3.727918094551241*^9, 3.727924197877178*^9, {
   3.727927706952642*^9, 3.727927732168346*^9}, 3.727967810295855*^9, 
   3.7279687332273684`*^9, 3.72796980823939*^9, 3.72796995512359*^9, 
   3.728044351719689*^9, 3.728046447758238*^9, 3.728066469672233*^9, 
   3.7280681208188887`*^9, 3.728083783480638*^9, 3.7280907414232063`*^9, 
   3.728169445193625*^9, 3.728169540756772*^9, 3.728169822911014*^9, 
   3.728169882937654*^9, 
   3.728252955435904*^9},ExpressionUUID->"405957cf-3126-49c1-919a-\
e0ee650a6dc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Don\[CloseCurlyQuote]t Invert That Matrix\.7f", "Subchapter",
 CellChangeTimes->{{3.727456856590333*^9, 3.727456866525626*^9}, {
  3.727456903416147*^9, 3.727456929038941*^9}},
 CellTags->"c:10",ExpressionUUID->"3fc0471d-6547-492c-a7f0-88c7972d7ead"],

Cell[TextData[{
 "See ",
 ButtonBox["https://www.johndcook.com/blog/2010/01/19/dont-invert-that-matrix/\
",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.johndcook.com/blog/2010/01/19/dont-invert-that-matrix/"],
     None},
  ButtonNote->
   "https://www.johndcook.com/blog/2010/01/19/dont-invert-that-matrix/"],
 " \n\nIn general, when you see a matrix expression ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["A", 
     RowBox[{"-", "1"}]], "\[CenterDot]", "B"}], TraditionalForm]],
  ExpressionUUID->"32698cd4-2dcc-4b05-9117-50af35fbcccc"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Inverse", "[", "A", "]"}], ".", "B"}], TraditionalForm]], "Code",
  
  FormatType->"TraditionalForm",ExpressionUUID->
  "0208196a-6c21-4a62-9f05-79b2f4e5fe89"],
 " in Wolfram, you usually can and should replace it with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"linsolve", "(", 
    RowBox[{"A", ",", "B"}], ")"}], TraditionalForm]],ExpressionUUID->
  "be8cdc7c-8184-4fb1-be9e-ee14c7115835"],
 ", or ",
 Cell[BoxData[
  FormBox[
   RowBox[{"LinearSolve", "[", 
    RowBox[{"A", ",", "B"}], "]"}], TraditionalForm]], "Code",
  FormatType->"TraditionalForm",ExpressionUUID->
  "4e7fbc22-09d2-4e39-a5b5-b93b7697af49"],
 " in Wolfram. "
}], "Text",
 CellChangeTimes->{{3.727377065079856*^9, 3.7273770966536922`*^9}, {
  3.727456910929248*^9, 3.727456922321958*^9}, {3.727967129773798*^9, 
  3.727967138858366*^9}, {3.7279671799345827`*^9, 3.727967207643837*^9}, {
  3.7281215143410273`*^9, 
  3.728121560473433*^9}},ExpressionUUID->"22774012-9eff-4ac3-a496-\
e6a67fad0936"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "update", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["update",
     Background->RGBColor[1, 1, 0]], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Psi]_", ",", "\[CapitalLambda]_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Zeta]_", ",", "a_"}], "}"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalPi]", "=", 
       RowBox[{"(", 
        RowBox[{"\[CapitalLambda]", "+", 
         RowBox[{
          RowBox[{"a", "\[Transpose]"}], ".", "a"}]}], ")"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LinearSolve", "[", 
        RowBox[{"\[CapitalPi]", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "\[Transpose]"}], ".", "\[Zeta]"}], "+", 
           RowBox[{"\[CapitalLambda]", ".", "\[Psi]"}]}], ")"}]}], "]"}], ",",
        "\[CapitalPi]"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {"mBar"},
         {"bBar"}
        }], ")"}], ",", "\[CapitalPi]"}], "}"}], "=", 
    RowBox[{
     StyleBox["Fold",
      Background->RGBColor[1, 1, 0]], "[", 
     RowBox[{
      StyleBox["update",
       Background->RGBColor[1, 1, 0]], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", GridBox[{
           {"0"},
           {"0"}
          }], ")"}], ",", 
        RowBox[{"(", GridBox[{
           {"1.0*^-6", "0"},
           {"0", "1.0*^-6"}
          }], ")"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"List", "/@", "data"}], ",", 
         RowBox[{"List", "/@", "partials"}]}], "}"}], "\[Transpose]"}]}], 
     "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.727054852495049*^9, 3.72705494257406*^9}, {
   3.727055026792467*^9, 3.727055093506559*^9}, {3.7270551930291023`*^9, 
   3.727055263833913*^9}, {3.727055297216107*^9, 3.7270554270906563`*^9}, {
   3.7270560338846903`*^9, 3.72705612788085*^9}, {3.7270561855129213`*^9, 
   3.7270561959544077`*^9}, {3.727056250031129*^9, 3.727056367103942*^9}, {
   3.727056427865035*^9, 3.727056443080068*^9}, {3.727056561323501*^9, 
   3.727056598046468*^9}, {3.727056640141169*^9, 3.727056654582451*^9}, {
   3.727056728700244*^9, 3.7270567914565277`*^9}, {3.727056869366274*^9, 
   3.727056921039433*^9}, 3.72705709924362*^9, {3.727057420502048*^9, 
   3.7270575464285316`*^9}, {3.7270577446377487`*^9, 3.727057775909028*^9}, {
   3.7270578799866133`*^9, 3.727057901007744*^9}, 3.7270581603330593`*^9, {
   3.727058349930079*^9, 3.7270584478842707`*^9}, {3.727058490337566*^9, 
   3.727058577824399*^9}, {3.727058673744141*^9, 3.7270586947547493`*^9}, {
   3.727058788099071*^9, 3.7270588909590683`*^9}, {3.727058934322414*^9, 
   3.7270589393580847`*^9}, {3.72705898616982*^9, 3.7270589868650723`*^9}, {
   3.7270592331231947`*^9, 3.727059237300102*^9}, {3.727370367915408*^9, 
   3.727370398721291*^9}, {3.727457046333558*^9, 3.727457067436592*^9}, {
   3.727473022344759*^9, 3.727473052764071*^9}, {3.727473241324421*^9, 
   3.7274732753376427`*^9}, {3.7274734820130367`*^9, 
   3.727473491340034*^9}},ExpressionUUID->"8455ac8b-46ce-48d7-bcde-\
ffa8bac951e1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.35324546798842227`"},
       {
        RowBox[{"-", "0.28741905362199754`"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"280.35593320338984`", "119.`"},
       {"119.`", "119.000001`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.727473265842018*^9, 3.7274732757004232`*^9}, 
   3.727473492609377*^9, 3.727485511701943*^9, 3.727486309173321*^9, 
   3.727878578445228*^9, 3.7278807875164957`*^9, 3.727881187996175*^9, 
   3.72788136768466*^9, 3.7279153853534393`*^9, 3.727918036812088*^9, 
   3.727918094615041*^9, 3.7279241979432487`*^9, {3.727927707015217*^9, 
   3.72792773222125*^9}, 3.727967810349496*^9, 3.7279687332731037`*^9, 
   3.7279698083019648`*^9, 3.7279699551693897`*^9, 3.728044351771216*^9, 
   3.7280464478070717`*^9, 3.7280664697246733`*^9, 3.728068120868615*^9, 
   3.728083783546753*^9, 3.728090741492902*^9, 3.728169445260518*^9, 
   3.728169540823485*^9, 3.728169822977787*^9, 3.7281698830032377`*^9, 
   3.728252955627798*^9},ExpressionUUID->"6f10acfb-11ef-4556-8c8e-\
d87a80e39a6e"]
}, Open  ]],

Cell[TextData[{
 "Because this example is small, ",
 Cell[BoxData[
  FormBox["Inverse", TraditionalForm]], "Code",
  FormatType->"TraditionalForm",ExpressionUUID->
  "1e8b6ec0-9f26-4e41-ac8c-020e2f7853de"],
 " has no obvious numerical issues, and the result is exactly as above."
}], "Text",
 CellChangeTimes->{{3.727473280120357*^9, 3.7274732832085*^9}, {
  3.7279911307811337`*^9, 3.727991131940103*^9}, {3.728121572695258*^9, 
  3.728121612596923*^9}},ExpressionUUID->"0c24c54b-b13d-4dfb-a8cb-\
ab88032612f8"],

Cell["\<\
We have eliminated memory bloat by accumulating estimate updates one \
observation at a time, each with its paired partial. We reduce computation \
time and numerical risk by solving a linear system instead of inverting a \
matrix.\
\>", "Text",
 CellChangeTimes->{{3.727475777156247*^9, 3.727475832537896*^9}, {
  3.72748624599329*^9, 
  3.727486246966188*^9}},ExpressionUUID->"ef86be51-850b-4e60-8316-\
442ba4e18123"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The Dual Problem", "Chapter",
 CellChangeTimes->{{3.7273771343297157`*^9, 3.727377139800111*^9}},
 CellTags->"c:11",ExpressionUUID->"7a3df452-4da6-4c03-a169-ea05a896b45d"],

Cell[TextData[{
 "When the model --- the thing we\[CloseCurlyQuote]re trying to estimate --- \
is a co-vector (row-vector), e.g., a gradient, we have the dual (transposed) \
problem. In that case, the observations ",
 Cell[BoxData[
  FormBox["\[CapitalOmega]", TraditionalForm]],ExpressionUUID->
  "0fcd49da-549d-4513-bc2a-55e5a3acca81"],
 " and the model ",
 Cell[BoxData[
  FormBox["\[CapitalGamma]", TraditionalForm]],ExpressionUUID->
  "c54ce737-c37c-4bf4-9780-c31893284bab"],
 " are now\.7f co-vectors with elements \[Omega] and \[Gamma]  instead of \
\[Zeta] and \[Psi]. The co-partials ",
 Cell[BoxData[
  FormBox["\[CapitalTheta]", TraditionalForm]],ExpressionUUID->
  "595110e6-8484-4e8f-924b-1631a75a7403"],
 " (replacing ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "a5959bab-c708-499c-8174-f99a22842500"],
 ") are now a co-vector of column vectors \[Theta]. The observation equation \
looks like ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalOmega]", "=", 
    RowBox[{"\[CapitalGamma]", "\[CenterDot]", "\[CapitalTheta]"}]}], 
   TraditionalForm]],ExpressionUUID->"1de13883-b79d-4fc7-96bd-cf06cf9564dc"],
 " and the error-so-far like ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x", "-", "\[Gamma]"}], ")"}], "\[CenterDot]", 
    "\[CapitalLambda]", "\[CenterDot]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "\[Gamma]"}], ")"}], "\[Transpose]"}]}], 
   TraditionalForm]],ExpressionUUID->"b1dadb23-5a5d-431a-a7d4-4fd905f473fa"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    RowBox[{
     SubscriptBox["\[CapitalTheta]", 
      RowBox[{"so", "-", "far"}]], "\[CenterDot]", 
     RowBox[{
      SubscriptBox["\[CapitalTheta]", 
       RowBox[{"so", "-", "far"}]], "\[Transpose]"}]}]}], TraditionalForm]],
  ExpressionUUID->"3e9237e0-1492-41e0-9db9-9439ab6ebd6b"],
 ". We don\[CloseCurlyQuote]t change the name of \[CapitalLambda] because it\
\[CloseCurlyQuote]s symmetric. Adding a new observation ",
 Cell[BoxData[
  FormBox["\[Omega]", TraditionalForm]],ExpressionUUID->
  "26a398ad-1d0d-4db9-818d-7de4a635932a"],
 " introduces new error ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Omega]", "-", 
      RowBox[{"x", "\[CenterDot]", "\[Theta]"}]}], ")"}], "\[CenterDot]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Omega]", "-", 
       RowBox[{"x", "\[CenterDot]", "\[Theta]"}]}], ")"}], "\[Transpose]"}]}],
    TraditionalForm]],ExpressionUUID->
  "032998b6-a96c-4d29-a61c-9ced58867980"],
 ". Minimizing the total error yields"
}], "Text",
 CellChangeTimes->{{3.727371218106142*^9, 3.727371240353272*^9}, {
   3.727371321069407*^9, 3.7273713296417093`*^9}, {3.7273713611621637`*^9, 
   3.7273714263190937`*^9}, {3.727371840069378*^9, 3.727371867019196*^9}, {
   3.727372044036509*^9, 3.727372359143402*^9}, {3.7273723988812304`*^9, 
   3.727372407831134*^9}, {3.727372456820087*^9, 3.727372576254916*^9}, {
   3.727372611880259*^9, 3.727372641828212*^9}, {3.727372745304285*^9, 
   3.727372762735136*^9}, {3.727373158078546*^9, 3.727373237360611*^9}, {
   3.727373343633808*^9, 3.727373660775297*^9}, {3.727373697002878*^9, 
   3.727373742098151*^9}, {3.7273741179275093`*^9, 3.727374119292781*^9}, 
   3.727374177681995*^9, {3.727374220080714*^9, 3.727374222719513*^9}, {
   3.7273750571767797`*^9, 3.7273750585288754`*^9}, {3.7273752241900177`*^9, 
   3.727375304998845*^9}, {3.727375354434124*^9, 3.727375583810218*^9}, {
   3.727375623795074*^9, 3.727375730528801*^9}, {3.727375806827318*^9, 
   3.727375932949609*^9}, {3.727376001504113*^9, 3.7273760221258574`*^9}, {
   3.727376063086153*^9, 3.727376156532493*^9}, {3.727376198118507*^9, 
   3.7273762919936867`*^9}, {3.727376351159185*^9, 3.727376363855044*^9}, {
   3.727376403668652*^9, 3.727376583289638*^9}, {3.727381968753878*^9, 
   3.7273821258780212`*^9}, {3.727382164112809*^9, 3.7273822084773273`*^9}, {
   3.727382248170485*^9, 3.7273823090681543`*^9}, {3.727382364895949*^9, 
   3.7273824245463467`*^9}, {3.727382516398245*^9, 3.727382517532123*^9}, {
   3.727382625583332*^9, 3.727382645314341*^9}, {3.727385201688477*^9, 
   3.72738520738167*^9}, {3.727385254691243*^9, 3.727385293535783*^9}, {
   3.727385323848435*^9, 3.727385374988439*^9}, {3.7273854084548693`*^9, 
   3.727385428127161*^9}, {3.727385559242544*^9, 3.72738569411847*^9}, {
   3.72738573051742*^9, 3.727385964398753*^9}, {3.727386005984235*^9, 
   3.72738615274949*^9}, {3.7273861954556293`*^9, 3.727386233565445*^9}, {
   3.727386269771594*^9, 3.727386271096093*^9}, {3.72738631202649*^9, 
   3.727386328269546*^9}, {3.727386360536889*^9, 3.7273864416740427`*^9}, {
   3.727386563853504*^9, 3.7273865694578733`*^9}, {3.727473691712545*^9, 
   3.727473706980104*^9}, {3.727473910423223*^9, 3.727473930847046*^9}, {
   3.7274739978523407`*^9, 3.727474003956037*^9}, {3.727475018387333*^9, 
   3.7274752353192043`*^9}, {3.7274758667159777`*^9, 
   3.7274761487187138`*^9}, {3.727485043325775*^9, 3.727485063734617*^9}, {
   3.727878432124065*^9, 
   3.727878474409099*^9}},ExpressionUUID->"cab07210-8bc7-463f-9916-\
06164277be49"],

Cell[BoxData[{
 FormBox[
  RowBox[{"\[Gamma]", "\[LeftArrow]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Gamma]", "\[CenterDot]", "\[CapitalLambda]"}], "+", 
      RowBox[{"\[Omega]", "\[CenterDot]", 
       RowBox[{"\[Theta]", "\[ThinSpace]", "\[Transpose]"}]}]}], 
     "\[ThinSpace]", ")"}], ".", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[CapitalLambda]", "+", 
       RowBox[{"\[Theta]", "\[CenterDot]", 
        RowBox[{"\[Theta]", "\[ThinSpace]", "\[Transpose]"}]}]}], 
      "\[ThinSpace]", ")"}], 
     RowBox[{"-", "1"}]]}]}], TraditionalForm], "\n", 
 FormBox[
  RowBox[{"\[CapitalLambda]", "\[LeftArrow]", 
   RowBox[{"(", 
    RowBox[{"\[CapitalLambda]", "+", 
     RowBox[{"\[Theta]", "\[CenterDot]", 
      RowBox[{"\[Theta]", "\[ThinSpace]", "\[Transpose]"}]}]}], 
    "\[ThinSpace]", ")"}]}], TraditionalForm]}], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.727473769463854*^9, 3.7274737789509773`*^9}, {
  3.727473829318837*^9, 3.727473867909276*^9}, {3.727476024957868*^9, 
  3.727476030734923*^9}, {3.727476186696595*^9, 3.727476277887042*^9}, {
  3.727476413804344*^9, 3.727476415307171*^9}, {3.727519463791893*^9, 
  3.727519480366523*^9}},ExpressionUUID->"33120922-77c1-4a41-844d-\
dedb9b99a61c"],

Cell[TextData[{
 "straight transposes of equation 3. ",
 Cell[BoxData[
  FormBox["LinearSolve", TraditionalForm]], "Code",ExpressionUUID->
  "cb78cef6-6105-441c-b121-2693c4ccb84d"],
 " operates on the transposed right-hand side of the recurrence, and we \
transpose the solution to get the recurrence. We apply this dual model to the \
transpose of the original data:"
}], "Text",
 CellChangeTimes->{{3.727476457185042*^9, 3.727476506319212*^9}, {
  3.727476549477606*^9, 3.7274765535653963`*^9}, {3.727878507367712*^9, 
  3.727878521964983*^9}, {3.7279672954218388`*^9, 
  3.727967307737608*^9}},ExpressionUUID->"326bc6e7-2170-49eb-ae12-\
cfc1dd19591b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Short", "[", 
  RowBox[{
   RowBox[{"Transpose", "/@", 
    RowBox[{"List", "/@", "partials"}]}], ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.72747707307362*^9, 3.727477115704844*^9}, {
  3.7279673222701263`*^9, 
  3.727967373721106*^9}},ExpressionUUID->"b416eae6-0974-4a7b-9d82-\
71e83d50f700"],

Cell[BoxData[
 TagBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"-", "1.`"}], "}"}], ",", 
      RowBox[{"{", "1.`", "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"-", "0.9661016949152542`"}], "}"}], ",", 
      RowBox[{"{", "1.`", "}"}]}], "}"}], ",", 
    RowBox[{"\[LeftSkeleton]", "115", "\[RightSkeleton]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2.9661016949152543`", "}"}], ",", 
      RowBox[{"{", "1.`", "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "3.`", "}"}], ",", 
      RowBox[{"{", "1.`", "}"}]}], "}"}]}], "}"}],
  Short[#, 3]& ]], "Output",
 CellChangeTimes->{{3.727477084780794*^9, 3.727477117039559*^9}, 
   3.7274855118872547`*^9, 3.727486309346143*^9, 3.727878578500392*^9, 
   3.72788078756756*^9, 3.727881188048245*^9, 3.7278813677339783`*^9, 
   3.727915385401812*^9, 3.7279180369804287`*^9, 3.727918094667513*^9, 
   3.72792419801117*^9, {3.727927707085987*^9, 3.727927732269897*^9}, {
   3.727967328044313*^9, 3.727967374382712*^9}, 3.72796781039671*^9, 
   3.727968733327298*^9, 3.727969808356143*^9, 3.727969955220028*^9, 
   3.728044351820155*^9, 3.7280464478574*^9, 3.728066469771554*^9, 
   3.728068120919256*^9, 3.728083783615262*^9, 3.728090741576128*^9, 
   3.728169445436224*^9, 3.728169540889641*^9, 3.7281698230448112`*^9, 
   3.728169883071618*^9, 
   3.728252955686994*^9},ExpressionUUID->"eb9f10cd-478b-430f-9aed-\
71e476e716c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "coUpdate", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["coUpdate",
     Background->RGBColor[1, 1, 0]], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Gamma]_", ",", "\[CapitalLambda]_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]_", ",", "\[Theta]_"}], "}"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalPi]", "=", 
       RowBox[{"(", 
        RowBox[{"\[CapitalLambda]", "+", 
         RowBox[{"\[Theta]", ".", 
          RowBox[{"\[Theta]", "\[Transpose]"}]}]}], ")"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"LinearSolve", "[", 
         RowBox[{"\[CapitalPi]", ",", 
          RowBox[{
           RowBox[{"\[CapitalLambda]", ".", 
            RowBox[{"\[Gamma]", "\[Transpose]"}]}], "+", 
           RowBox[{"\[Theta]", ".", 
            RowBox[{"\[Omega]", "\[Transpose]"}]}]}]}], "]"}], 
        "\[Transpose]"}], ",", "\[CapitalPi]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{
   StyleBox["Fold",
    Background->RGBColor[1, 1, 0]], "[", 
   RowBox[{
    StyleBox["coUpdate",
     Background->RGBColor[1, 1, 0]], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {"0", "0"}
        }], ")"}], ",", 
      RowBox[{"(", GridBox[{
         {"1.0*^-6", "0"},
         {"0", "1.0*^-6"}
        }], ")"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"List", "/@", 
        RowBox[{"List", "/@", "data"}]}], ",", 
       RowBox[{"Transpose", "/@", 
        RowBox[{"List", "/@", "partials"}]}]}], "}"}], "\[Transpose]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.727373282942794*^9, 3.727373311804191*^9}, {
   3.727376180517476*^9, 3.727376181653618*^9}, {3.7273767470214643`*^9, 
   3.727376772415944*^9}, {3.727376838568122*^9, 3.727376996930687*^9}, {
   3.72738256636836*^9, 3.727382569358986*^9}, {3.727382665863063*^9, 
   3.727382700900879*^9}, {3.7273827517208357`*^9, 3.7273827939392014`*^9}, {
   3.727382854392722*^9, 3.727382887313746*^9}, {3.727382928030025*^9, 
   3.7273829350883923`*^9}, {3.727383062267906*^9, 3.7273833443529673`*^9}, {
   3.727383375173339*^9, 3.727383375684123*^9}, {3.727383409608202*^9, 
   3.727383500022263*^9}, {3.727476338632511*^9, 3.7274763769100018`*^9}, {
   3.727476597581078*^9, 3.7274770426433783`*^9}, {3.727477148842947*^9, 
   3.727477169094758*^9}, 3.7274773761933823`*^9, {3.727477430990588*^9, 
   3.7274774638671503`*^9}, {3.7274774973342*^9, 3.7274775628692408`*^9}, 
   3.727967383277925*^9},ExpressionUUID->"7ddbbe8b-21a9-42dc-9716-\
202e9b6e3456"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.35324546798842227`", 
        RowBox[{"-", "0.28741905362199754`"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"280.35593320338984`", "119.`"},
       {"119.`", "119.000001`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.727383072193253*^9, 3.727383354047873*^9, 3.727383390761856*^9, 
   3.7273834247745028`*^9, {3.727383458844083*^9, 3.7273835011111603`*^9}, 
   3.727442992945771*^9, 3.72744342284167*^9, 3.727443453425893*^9, 
   3.727444588221921*^9, 3.727444680887401*^9, 3.7274455727767982`*^9, 
   3.727446247275579*^9, 3.727446407013369*^9, 3.72744683899579*^9, {
   3.7274468858224363`*^9, 3.727447006380907*^9}, {3.727447047179235*^9, 
   3.72744708786588*^9}, 3.727447307524426*^9, 3.727447364795184*^9, 
   3.7274478393573503`*^9, 3.727449904650557*^9, 3.72745018058704*^9, 
   3.7274550798510838`*^9, 3.727455975376423*^9, {3.727456143282322*^9, 
   3.7274561870786343`*^9}, 3.727457104301549*^9, 3.7274626019151583`*^9, 
   3.727472138649213*^9, {3.727476713990739*^9, 3.727476741082378*^9}, 
   3.727476781425972*^9, {3.727476852153051*^9, 3.727476875672526*^9}, 
   3.727477048974312*^9, {3.727477150418499*^9, 3.727477170510271*^9}, 
   3.7274773773967867`*^9, 3.727477433395472*^9, {3.727477479732809*^9, 
   3.7274775639291077`*^9}, 3.727485511931388*^9, 3.7274863093907747`*^9, 
   3.727878578548321*^9, 3.727880787616843*^9, 3.727881188097982*^9, 
   3.727881367783843*^9, 3.727915385450048*^9, 3.7279180370407333`*^9, 
   3.7279180947349854`*^9, 3.727924198197872*^9, {3.727927707221209*^9, 
   3.727927732334594*^9}, 3.7279678104450483`*^9, 3.72796873339045*^9, 
   3.727969808418737*^9, 3.727969955270645*^9, 3.7280443518882*^9, 
   3.7280464479120703`*^9, 3.728066469825574*^9, 3.72806812096865*^9, 
   3.728083783681383*^9, 3.72809074183177*^9, 3.728169445494536*^9, 
   3.728169541066454*^9, 3.728169823201066*^9, 3.7281698832458076`*^9, 
   3.72825295575315*^9},ExpressionUUID->"2be7795d-b08b-4ceb-a30f-\
e5ad1f848418"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application of the Dual Problem", "Subchapter",
 CellChangeTimes->{{3.7274775822773733`*^9, 3.727477598570956*^9}},
 CellTags->"c:12",ExpressionUUID->"244abd98-9ff2-4cbb-957c-454f2602af00"],

Cell[TextData[{
 "The finite-difference method of policy-gradient machine learning provides a \
motivating example of the dual problem (see ",
 ButtonBox["http://www.scholarpedia.org/article/Policy_gradient_methods",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.scholarpedia.org/article/Policy_gradient_methods"], None},
  
  ButtonNote->"http://www.scholarpedia.org/article/Policy_gradient_methods"],
 "). \n\nImagine a scalar function ",
 Cell[BoxData[
  FormBox[
   RowBox[{"J", "(", "\[Theta]", ")"}], TraditionalForm]],ExpressionUUID->
  "a46cd651-f70b-4e54-9a6e-79b25be38dd7"],
 " of a column ",
 Cell[BoxData[
  FormBox["K", TraditionalForm]],ExpressionUUID->
  "ab77f425-87e5-438e-a999-1aa211a17e08"],
 "-vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", 
    RowBox[{"K", "\[Times]", "1"}]], TraditionalForm]],ExpressionUUID->
  "530b2f34-3906-48d5-af1a-6fe88ef3be97"],
 ". We want to estimate its gradient co-vector ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Del]", "J"}], TraditionalForm]],ExpressionUUID->
  "1baa8577-d9b7-4297-b4ca-ceff99f13c83"],
 ", given a batch of ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalI]", TraditionalForm]],ExpressionUUID->
  "16c4d51a-b042-4c78-b089-d3f26f019b67"],
 " random increments ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalDelta]\[CapitalTheta]", 
     RowBox[{"K", "\[Times]", "\[ScriptCapitalI]"}]], ","}], 
   TraditionalForm]],ExpressionUUID->"07503476-cdb0-4917-b1e9-2a5bbc9dd003"],
 " from the system ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[Del]", "J"}], "\[CenterDot]", 
     "\[CapitalDelta]\[CapitalTheta]"}], "=", 
    RowBox[{"\[CapitalDelta]", "\[ThinSpace]", "J"}]}], TraditionalForm]],
  ExpressionUUID->"7b50038e-f020-411d-a8a2-3c512776b63e"],
 ". Here, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Del]", "J"}], TraditionalForm]],ExpressionUUID->
  "9f1abe83-d0e2-43da-a239-0e56844ff5d8"],
 " takes the role of the model whose state parameters ",
 Cell[BoxData[
  FormBox["\[CapitalGamma]", TraditionalForm]],ExpressionUUID->
  "13159cff-0fd5-42f2-88dd-3dfe54451576"],
 " we want to estimate, ",
 Cell[BoxData[
  FormBox["\[CapitalDelta]\[CapitalTheta]", TraditionalForm]],ExpressionUUID->
  "e8af39e2-8f2f-44b9-9891-43d8fb9a20fe"],
 " takes the role of the partials of the model w.r.t. those parameters, and \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", "\[ThinSpace]", "J"}], TraditionalForm]],
  ExpressionUUID->"7283a09d-4a9c-4d7a-bf28-7284694732f9"],
 " takes the role of measured data. Let ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", "\[ThinSpace]", 
    SubscriptBox["J", 
     RowBox[{"\[ScriptCapitalI]", "\[Times]", "1"}]]}], TraditionalForm]],
  ExpressionUUID->"b150a273-134d-41de-89ec-a18131d86339"],
 " be a ",
 StyleBox["batch",
  FontSlant->"Italic"],
 " of observed increments to ",
 Cell[BoxData[
  FormBox["J", TraditionalForm]],ExpressionUUID->
  "cfe89e57-0ac0-495d-b341-1b42902614f8"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalDelta]\[CapitalTheta]", 
    RowBox[{"K", "\[Times]", "\[ScriptCapitalI]"}]], TraditionalForm]],
  ExpressionUUID->"a4dd2cda-aed9-4a18-8bbe-2a27aefc37f0"],
 " be a matrix of the ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalI]", TraditionalForm]],ExpressionUUID->
  "cf54303a-6d4c-4789-96f9-78229c49e87c"],
 " corresponding column-vector random increments to the input vectors ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", 
    RowBox[{"K", "\[Times]", "1"}]], TraditionalForm]],ExpressionUUID->
  "63e9ca28-5dcc-463b-aaab-a5f0f7b650c8"],
 ". The right pseudoinverse ",
 Cell[BoxData[
  FormBox[
   RowBox[{"RPI", 
    OverscriptBox["=", "def"], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]\[CapitalTheta]", 
         RowBox[{"K", "\[Times]", "\[ScriptCapitalI]"}]], "\[CenterDot]", 
        SubsuperscriptBox["\[CapitalDelta]\[CapitalTheta]", 
         RowBox[{"K", "\[Times]", "\[ScriptCapitalI]"}], "\[Transpose]"]}], 
       ")"}], 
      RowBox[{"-", "1"}]], "\[CenterDot]", 
     SubsuperscriptBox["\[CapitalDelta]\[CapitalTheta]", 
      RowBox[{"K", "\[Times]", "\[ScriptCapitalI]"}], "\[Transpose]"]}]}], 
   TraditionalForm]],ExpressionUUID->"ba4a5a39-1a06-4e05-9e99-d9d1a27f325d"],
 " solves ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[Del]", "\[ThinSpace]", 
      SubscriptBox["J", 
       RowBox[{"\[ScriptCapitalI]", "\[Times]", "1"}]]}], "\[CenterDot]", 
     SubscriptBox["\[CapitalDelta]\[CapitalTheta]", 
      RowBox[{"K", "\[Times]", "\[ScriptCapitalI]"}]]}], "=", 
    RowBox[{"\[CapitalDelta]", "\[ThinSpace]", 
     SubscriptBox["J", 
      RowBox[{"\[ScriptCapitalI]", "\[Times]", "1"}]]}]}], TraditionalForm]],
  ExpressionUUID->"c9d377eb-a6b1-41cd-9897-feb501018138"],
 " to yield ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Del]", "\[ThinSpace]", 
     SubscriptBox["J", 
      RowBox[{"\[ScriptCapitalI]", "\[Times]", "1"}]]}], "\[TildeTilde]", 
    RowBox[{"\[CapitalDelta]", "\[ThinSpace]", 
     RowBox[{
      SubscriptBox["J", 
       RowBox[{"\[ScriptCapitalI]", "\[Times]", "1"}]], "\[CenterDot]", 
      "RPI"}]}]}], TraditionalForm]],ExpressionUUID->
  "ad9393d1-07c0-4272-a9d5-2784ac220021"],
 ". \n\nUse the co-update recurrence for this problem."
}], "Text",
 CellChangeTimes->{{3.727371218106142*^9, 3.727371240353272*^9}, {
   3.727371321069407*^9, 3.7273713296417093`*^9}, {3.7273713611621637`*^9, 
   3.7273714263190937`*^9}, {3.727371840069378*^9, 3.727371867019196*^9}, {
   3.727372044036509*^9, 3.727372359143402*^9}, {3.7273723988812304`*^9, 
   3.727372407831134*^9}, {3.727372456820087*^9, 3.727372576254916*^9}, {
   3.727372611880259*^9, 3.727372641828212*^9}, {3.727372745304285*^9, 
   3.727372762735136*^9}, {3.727373158078546*^9, 3.727373237360611*^9}, {
   3.727373343633808*^9, 3.727373660775297*^9}, {3.727373697002878*^9, 
   3.727373742098151*^9}, {3.7273741179275093`*^9, 3.727374119292781*^9}, 
   3.727374177681995*^9, {3.727374220080714*^9, 3.727374222719513*^9}, {
   3.7273750571767797`*^9, 3.7273750585288754`*^9}, {3.7273752241900177`*^9, 
   3.727375304998845*^9}, {3.727375354434124*^9, 3.727375583810218*^9}, {
   3.727375623795074*^9, 3.727375730528801*^9}, {3.727375806827318*^9, 
   3.727375932949609*^9}, {3.727376001504113*^9, 3.7273760221258574`*^9}, {
   3.727376063086153*^9, 3.727376156532493*^9}, {3.727376198118507*^9, 
   3.7273762919936867`*^9}, {3.727376351159185*^9, 3.727376363855044*^9}, {
   3.727376403668652*^9, 3.727376583289638*^9}, {3.727381968753878*^9, 
   3.7273821258780212`*^9}, {3.727382164112809*^9, 3.7273822084773273`*^9}, {
   3.727382248170485*^9, 3.7273823090681543`*^9}, {3.727382364895949*^9, 
   3.7273824245463467`*^9}, {3.727382516398245*^9, 3.727382517532123*^9}, {
   3.727382625583332*^9, 3.727382645314341*^9}, {3.727477798829159*^9, 
   3.727477804771535*^9}, 3.72748531820835*^9, {3.7274853820587463`*^9, 
   3.727485407991457*^9}, {3.727485470328353*^9, 3.72748548941591*^9}, {
   3.727971127714642*^9, 
   3.727971222057963*^9}},ExpressionUUID->"0a7a1364-3eef-423e-9bb5-\
533da0f1e902"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Regularization By A-Priori: Example", "Chapter",
 CellChangeTimes->{{3.7278786048568163`*^9, 3.727878609238576*^9}, {
  3.7278835476425943`*^9, 3.727883549040578*^9}, {3.727924834507627*^9, 
  3.727924836977462*^9}, {3.727925756497532*^9, 3.727925760501575*^9}},
 CellTags->"c:13",ExpressionUUID->"e904f61a-2aac-4df2-b65e-b53e5d38a4bd"],

Cell[TextData[{
 "Chris Bishop\[CloseCurlyQuote]s book ",
 StyleBox[ButtonBox["Pattern Recognition and Machine Learning",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.amazon.com/Pattern-Recognition-Learning-Information-\
Statistics/dp/0387310738"], None},
  ButtonNote->
   "https://www.amazon.com/Pattern-Recognition-Learning-Information-\
Statistics/dp/0387310738"],
  FontSlant->"Italic"],
 " has an extended example fitting polynomials, linear in their coefficients, \
starting in section 1.1. The higher the order of the polynomial, the more it \
tends to over-fit a small data set. Bishop presents ",
 StyleBox["maximum posterior",
  FontSlant->"Italic"],
 " or MAP regularization as a cure for over-fitting. \n\nRLS and the Kalman \
fold each require an a-priori estimate of the coefficients and an a-priori \
uncertainty in the coefficients. RLS takes the estimate of uncertainty as an \
information matrix. The Kalman fold takes the estimate of uncertainty as a \
covariance matrix. The Kalman fold additionally requires an estimate of \
observation noise. Both RLS and the Kalman fold automatically regularize the \
fit, avoiding over-fitting for even modest magnitudes of the uncertainty of \
the a-priori estimates. In this section, we show this regularization and \
relate it to its cousin, MAP."
}], "Text",
 CellChangeTimes->{{3.727878623850936*^9, 3.727878709219612*^9}, {
   3.727878861523492*^9, 3.7278788615269413`*^9}, {3.727879302741879*^9, 
   3.727879309849668*^9}, 3.727883517024404*^9, {3.727922726553706*^9, 
   3.727922764150456*^9}, 3.727922954590423*^9, {3.727924470079568*^9, 
   3.727924536073629*^9}, {3.7279245945103197`*^9, 3.727924814835289*^9}, {
   3.7279675670922203`*^9, 3.727967666149938*^9}, {3.727971057289061*^9, 
   3.727971066302681*^9}, {3.728121698098153*^9, 3.7281219113362703`*^9}, {
   3.728251250200307*^9, 3.7282512840101357`*^9}, {3.7282513246052217`*^9, 
   3.728251329374619*^9}},ExpressionUUID->"543cb2a0-0e2a-471b-99c3-\
db8f3d5a2502"],

Cell[TextData[{
 "First, a sequence of ",
 StyleBox["n",
  FontSlant->"Italic"],
 " inputs, equally spaced in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    RowBox[{
     RowBox[{"0", ".."}], "1"}], "]"}], TraditionalForm]],ExpressionUUID->
  "29ce8c8d-9344-4003-8aa1-108c7bd407ca"],
 ". Like MATLAB ",
 Cell[BoxData[
  FormBox["linspace", TraditionalForm]], "Code",ExpressionUUID->
  "6dd8d76e-6e1c-4c38-aa2d-e8be23e061fe"],
 "."
}], "Text",
 CellChangeTimes->{{3.727903592625655*^9, 3.727903632159232*^9}, {
   3.7279036735048943`*^9, 3.727903706547583*^9}, {3.727905942818769*^9, 
   3.727905962112603*^9}, {3.7280864904938383`*^9, 3.72808650130811*^9}, 
   3.7281253834656553`*^9},ExpressionUUID->"67f8d26c-0487-4c33-aa2f-\
6276299b9da3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "bishopTrainingSetX", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bishopTrainingSetX", "[", "n_", "]"}], ":=", 
   RowBox[{"Array", "[", 
    RowBox[{"Identity", ",", "n", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1."}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"bishopTrainingSetX", "[", "10", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7278793831155243`*^9, 3.727879483430056*^9}, {
  3.7278795217592373`*^9, 3.7278795713344812`*^9}, {3.727879616737006*^9, 
  3.727879619545887*^9}, {3.727879705352076*^9, 3.7278797261345243`*^9}, {
  3.7278805381565742`*^9, 3.727880538743538*^9}, {3.727922980939206*^9, 
  3.7279229886203623`*^9}},ExpressionUUID->"fb3ccbeb-20e3-4e2c-9e79-\
93ea92eb3b36"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 0.}, {2., 0.1111111111111111}, {3., 0.2222222222222222}, {
      4., 0.3333333333333333}, {5., 0.4444444444444444}, {6., 
      0.5555555555555556}, {7., 0.6666666666666666}, {8., 
      0.7777777777777777}, {9., 0.8888888888888888}, {10., 
      1.}}]}, {}}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 10.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.7279036576643267`*^9, 3.7279153856605663`*^9, 3.727918037116987*^9, 
   3.7279180948276176`*^9, {3.7279229839121304`*^9, 3.727922989728109*^9}, 
   3.7279241982632713`*^9, {3.727927707284925*^9, 3.727927732385895*^9}, 
   3.727967810497973*^9, 3.72796873344042*^9, 3.727969808476139*^9, 
   3.7279699553203173`*^9, 3.728044351955875*^9, 3.728046448005164*^9, 
   3.728066469870434*^9, 3.728068121014494*^9, 3.728083783783091*^9, 
   3.7280907419079514`*^9, 3.728169445558825*^9, 3.728169541122375*^9, 
   3.7281698232597103`*^9, 3.728169883302211*^9, 
   3.728252955818722*^9},ExpressionUUID->"789ceae9-ab02-4543-9990-\
fb4365078279"]
}, Open  ]],

Cell[TextData[{
 "Ground truth is a single cycle of a sine wave. Add some noise to a sample \
of the ground truth taken at the values of the training set X. Bishop doesn\
\[CloseCurlyQuote]t state his observation noise, but I have gathered some \
clues and I guess ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sigma]", "z"], "=", 
    RowBox[{
     SubscriptBox["\[Sigma]", "t"], "=", "0.30"}]}], TraditionalForm]],
  ExpressionUUID->"f7563510-3ca6-49c1-a9be-eaa9281a75a2"],
 " to create the fake data set (this is suspiciously the same as Bishop\
\[CloseCurlyQuote]s ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Beta]", 
    RowBox[{"\[ThinSpace]", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5e1c9aed-0fa1-4fe0-b11e-445ca9400a35"],
 "; we return to this point below). \n\nNote that Wolfram\[CloseCurlyQuote]s \
built-in ",
 Cell[BoxData[
  FormBox["NormalDistribution", TraditionalForm]], "Code",
  FormatType->"TraditionalForm",ExpressionUUID->
  "391719cb-f0ae-47d9-b6f8-cf0a16d1de30"],
 " takes the standard deviation as its second argument, not the variance, \
which is the square of standard deviation. Mixing up standard deviation and \
variance is an easy mistake because we don\[CloseCurlyQuote]t have types for \
them: they\[CloseCurlyQuote]re just unchecked numbers. Bishop uses variance \
as second argument, so beware. "
}], "Text",
 CellChangeTimes->{{3.727925037995728*^9, 3.7279251079034653`*^9}, {
  3.7281672861902847`*^9, 3.728167315662861*^9}, {3.728217520627878*^9, 
  3.7282175317062597`*^9}, {3.728217692277302*^9, 3.728217821974227*^9}, {
  3.72821832687463*^9, 3.7282183503446493`*^9}, {3.728219468837654*^9, 
  3.728219505064865*^9}, {3.728251312926087*^9, 
  3.728251372591283*^9}},ExpressionUUID->"49fbe227-c052-4592-a399-\
d4ad384aaf80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"bishopFakeY", ",", "bishopGroundTruthY"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bishopGroundTruthY", "[", "xs_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"2.", "\[Pi]", "#"}], "]"}], "&"}], "/@", "xs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bishopFakeY", "[", 
    RowBox[{"xs_", ",", "\[Sigma]_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "@", "xs"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bishopGroundTruthY", "[", "xs", "]"}], "\[IndentingNewLine]", 
      "+", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0.", ",", "\[Sigma]"}], "]"}], ",", "n"}], "]"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.727879752743185*^9, 3.7278799854455643`*^9}, {
  3.727880015690054*^9, 3.7278800794720173`*^9}, {3.727880507980577*^9, 
  3.7278805461972027`*^9}},ExpressionUUID->"cff4dd11-5349-4864-acae-\
eb90ff29fe6d"],

Cell[TextData[{
 "Take a sample and assign it the name ",
 Cell[BoxData[
  FormBox["bishopTrainingSet", TraditionalForm]], "Code",ExpressionUUID->
  "f9cdc4b8-56b6-4315-84c8-cce498dec61d"],
 ". It isn\[CloseCurlyQuote]t his actual training set (which I didn\
\[CloseCurlyQuote]t find in print), just my simulation of it."
}], "Text",
 CellChangeTimes->{{3.7278832163983307`*^9, 3.7278832375275517`*^9}, {
  3.727906008140655*^9, 3.727906061879993*^9}, {3.727967692026178*^9, 
  3.727967840843544*^9}, {3.727967872455134*^9, 3.7279678771043777`*^9}, {
  3.727969674731044*^9, 3.727969699819124*^9}, {3.727969774693037*^9, 
  3.727969782528049*^9}, {3.727969836960168*^9, 3.727969942714082*^9}, {
  3.72796998393566*^9, 3.727969992896991*^9}, {3.727970026070797*^9, 
  3.727970373300626*^9}, {3.727970485196838*^9, 3.727970512318493*^9}, {
  3.727970712603229*^9, 3.7279707772612677`*^9}, {3.727971265852014*^9, 
  3.7279713568853807`*^9}, {3.7281671900202827`*^9, 3.7281672837287903`*^9}, {
  3.728167321065092*^9, 
  3.728167321584338*^9}},ExpressionUUID->"e447814c-2e6b-4e89-81da-\
15737a60a88f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"bishopTrainingSet", ",", "bishopFake", ",", "bishopFakeSigma"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bishopFake", "[", 
    RowBox[{"n_", ",", "\[Sigma]_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xs", "=", 
       RowBox[{"bishopTrainingSetX", "[", "n", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ys", "=", 
         RowBox[{"bishopFakeY", "[", 
          RowBox[{"xs", ",", "\[Sigma]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"xs", ",", "ys"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bishopFakeSigma", "=", "0.30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bishopTrainingSet", "=", 
   RowBox[{"bishopFake", "[", 
    RowBox[{"10", ",", "bishopFakeSigma"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.72788015184029*^9, 3.727880231778208*^9}, {
   3.727880385369709*^9, 3.727880413342643*^9}, 3.727880526308257*^9, {
   3.727967805222126*^9, 3.72796780531704*^9}, {3.7279697920516977`*^9, 
   3.72796979498647*^9}, {3.727969950515656*^9, 3.727969950591378*^9}, {
   3.727994080862403*^9, 
   3.727994108975196*^9}},ExpressionUUID->"2f201b63-7491-442b-bf7d-\
737d03ac1688"],

Cell["Make a plot like Bishop\[CloseCurlyQuote]s figure 1.7 (page 10).", \
"Text",
 CellChangeTimes->{{3.727906073807754*^9, 3.727906077471641*^9}, {
  3.727915536304657*^9, 3.7279155386681232`*^9}, {3.7279713648223457`*^9, 
  3.727971369779395*^9}},ExpressionUUID->"357da196-1d26-48ce-866a-\
a9e0972ea669"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"lp", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"bishopTrainingSet", "\[Transpose]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Graphics", "@", 
           RowBox[{"{", 
            RowBox[{"Blue", ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], "}"}]}], 
          ",", ".05"}], "}"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lp", ",", 
       RowBox[{"(*", " ", 
        RowBox[{"once", " ", "to", " ", "set", " ", "the", " ", "scale"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2.", "\[Pi]", " ", "x"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0.", ",", "1."}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Green"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", "lp"}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"again", " ", "to", " ", "overdraw", " ", "the", " ", "plot"}],
        " ", "*)"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<t\>\""}], "}"}]}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.727880085493072*^9, 3.72788013972164*^9}, {
   3.7278802437563953`*^9, 3.7278802581076803`*^9}, {3.7278803034902487`*^9, 
   3.727880361169203*^9}, {3.7278804194474173`*^9, 3.727880429435811*^9}, 
   3.7278806446621532`*^9, {3.7278807572759333`*^9, 3.7278807745809507`*^9}, {
   3.727880893504468*^9, 3.7278809867037153`*^9}, {3.7278810338930473`*^9, 
   3.727881110077335*^9}, {3.7278811411219473`*^9, 3.7278813474824867`*^9}, {
   3.727881617681645*^9, 3.727881731860063*^9}, {3.727882548678594*^9, 
   3.72788267853528*^9}, {3.727882716394725*^9, 3.727882813824841*^9}, {
   3.727882846153562*^9, 3.727882924674261*^9}, {3.72788567102006*^9, 
   3.727885671857286*^9}, {3.727923022530311*^9, 
   3.727923022847533*^9}},ExpressionUUID->"25ef9dce-c320-447e-a283-\
f6b2b7d4691e"],

Cell[BoxData[
 GraphicsBox[{{{}, {
     {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
      AbsoluteThickness[1.6], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0., -0.04062897392391766}, Automatic, 
       Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.1111111111111111, 0.6298276161005479}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.2222222222222222, 0.7965838945500382}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.3333333333333333, 1.8165645808849842}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.4444444444444444, 0.060760183737638584}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.5555555555555556, -0.08592843036234976}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.6666666666666666, -0.9303991345973857}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.7777777777777777, -1.0318282491969533}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.8888888888888888, -0.6038327316456199}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {1., 0.32976957055648}, Automatic, 
       Scaled[{0.05, 0.05}]]}, {}}, {}, {}, {}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 1, 0], Thickness[Large], Opacity[1.], 
       LineBox[CompressedData["
1:eJwVmXc81d8fxykaEhFCFEnRoCGK6i1kVxRakpBCISOaIkoisioZ0TLKykpy
7M29drLKusO995AtX/3O76/7eP5xPvdz3u/X6z3ulbVxOXl5CRcXVwY3F9f/
Pw0v05tLGOaHp4v5mgb3+R7m0ZZ07ZdQgZe5nRNSERdhb8LL2C8SOnAjKken
LdwFjBo7s+MkzOBBSuntpHAfOG038z1cwg42+L5pOBUeCr3Kj7VDJDxA7ehq
M/PnCfBG9MSjIAl/UEXz32+FZIDvii9bn0hEwn7RFB3p+wjOnE3MGBt/BwFF
34/yHaXCqn++lnobMiDfq1ylqKsT5E059PKnOaCQtoGiz+oDr6YD8HLyKwyN
dJ2tXDEI63KE+ri5EcguT+U2FBqBvAHtBsrBMvjrXr0vbZYOHfq+4yF6ZeB2
s0Bu31IGTKcXixmfLIPMB6ulC1YzQO3OgUs1V8qg1VplS8omBhSsVZ4uCS8D
HYbYETVjBnzVkZTJppeB7ZUkEe54BhR9GHOPjCyHE12dnmoHmVDmGLf+LKsC
PonRm17YjMIXhpOT1XQFfPt3fuNXx1F4d1X9my1XJUTaRTS2uo1CgH3nOWeR
Sig0uqkx5TcK+jZCMQ8PVoLq8aAt9KRRoJwNEE8ProRsW/mnwb9HoUf/uujS
nVUgGW12vewsCxqrNS6vUKuCD6VLalddYkGxLl/u6iNVcKznp+7xqyxI0Plo
Jm5eBR6tS5OKb7LARvN3xM57VRCW7fbeOIIFdDVz4TONVVCvI2AtVc+CqS2H
BD9fr4bH5mj6/j42HB7Qqg7yrgb3abkg94NseBSn73P1YTXc3rSr4aI2G8RE
zLDcq2pQSrQ222jKBlVuJ0pMRTWoJT0/rH6NDd7dL0MD19dAyf67jb1v2LAQ
OiloV1sDwk7q7KalHNAxmq8+0lYDF4c6s3NXciB4GdeDjf01EGSXz4oQ5ID0
vVVjPydrgHn+eZ7qeg4cdtxENZWphbM5Tz1E93DAR8ckDLxqYaDcdZeqFQeW
zKWtWS9fBw5+Dv1zGRxY36g1Acp10J8tZXs7hwMqiV3tdgfqwEut0WCigAOX
DZa/Tj9WB89iCzSaSjlQ88pGXutmHfzSk4tQaOVAqLqEukN1Haz8r1nWeZID
yQKZUs+a60A65pqZxywHSgZ0/2V310FFgWKX2wIH/gR5VCzgOgiBde1neDBY
dFOOh4nXA4TdvVOzFoPU3Ue2+Q71oJYWm75vN4Z9JtK6Pe718Kv+S1iJCobj
m3MUuO/Xw0Pu+Vzt/Rh8Gn6zDcPr4Sv1VdUewDAgdci7r7AeuIMO0b8YY0j5
PhHMy98AmCXuccQeQ9nzIJdtYg1Q69m22cQBw8/LsidPyDQAuzRv1elrGPgF
Tqx7pdIAY7zj3sfcMLhapSbuuNAAr+Syi3ruYVD9Z513Kr0Bziu7GPlHYDA+
VuJ3tKAB/hgkbV8ZjcH29cYTamUNYMDiCnj0EkOYWh9NsqMBOGsH3zjGYWC4
nJcY+K8Bph4IXv/xAQNXceFw6/JGONVnv0w2BYMYv2R2pVAjrF5xQcQmDYNW
8g/DFPlG6A7gDm7MwBD7y/yu67FGqDYM7zYowJCtlKtvc7oRlKLVV1kUYqi5
KyJqdqkRirmupp0rwjAl3vpZzbMRWsKvaBwrIfEzNelfjG0EO7XJ4M5qDNxl
hlohrEbYt3Fp5IN2DOJrUgV8phth+1X16LWdGJSsVna7cjVBfoT0koQfGM7N
V7ubiTRB5m1X0YRuDDl7jr5ff7AJShSvyej8xlD34N2N1bpN8N5Xwj5mAMOv
pqWH/51ogl1RX4QZgxhWO5V1DNg2AavYNcFlBIP9W1iR+rQJclRr7suOYrg7
Ht/2OqoJHnY9nlBnYYiAxTchCU0gNkZvMGZjKOkuOnDjSxNkawV/OosxdChK
LbP93gQy10yzzcYwsLzutJhVN4H60Pf1+uMYJETUnfZ3N0FXyAdx8QkMu2xe
qW0bboIxpZy0ScK6mbNLpXATTP73NLF2EoObcX7svyUUaJqj5lhOYwiMEXMY
56fAKsm+ZskZDAl0z32DYhQQOzFl0ky4wV+lqWobBUzbozy2zmFQF6xf8nwf
BYJ5fpu0EU5+dUntvCYFepM7VbznSX43zzrJG1HgeY2RzNq/GB6mP3uDzSmg
zBFa+57w2H759q/WFHikwL1aaQGDVfm3lf5OFMjlm1idTlj9B91N3JcC/yWb
bo74jzzfxufjwFMKHJe9f2CWsBhbtOdTNAUWvu4wN1vE4O/1aY1XIgVOx2p7
fSQ8zq199MgnCqjeTEsYJ2wV3HVrVT4F/t060bTnH7mPmGt6eykFPltJL3Ui
rJ64bDChgQKtF3kPxxBO3h63zrGTAu8Pzd8vISyWt9dYZYACMwfHK3sJ+2vW
PVhkUUB764DwH8J/6qxza2YokGpYffk/wpmpfz0MuKkweSuu+B9hGtYNTV9G
hSh+O+k5whv2haes5adCWp+UH4Ow2e3ecm8hKiyYNLCohJ8ihb5eMSpM69+6
kEG4jMdjVkuKChm7drb5E541QMLJslTon54wMSWsHMq3c/VWwgI9rSKE7dvM
9dx2UOGt67Qlhdw/TiLxUuduKnx9acF6QLjNinXnoBoVDgcK+ykSXvVOLTrx
IBV6KrQ21JL4ajH8MpdpUaHszJLSi4RvKTXVOelRIb7F2ZFN8pPpLjFMNaZC
6NFkSTfCtAK7f/tOUkHOoLmZTfK7YTFD4vVpKhjNCYRZEzbX/ruX6wIVjKcD
zeuIPoIDdY9ftqHCdzuHTdsJzwn3+ilfp4LHd+HW5lmi3zMKcZFu5P4BB/PX
EbaPc8+f86KC5t1nb82IHtu28rHK/ajgcz4w6ssUeZ+DauZnXlJhZ6LzMO8f
8j6+fi7f40h8Z2yEeIg/NlQ3Ptn0lgrW2Xf05oifgk3tilmfqYBV9FtriN+u
2j/f6ltOhSaj9W4LdKL/tJ4jIzVUkFmBZ7JpxH9jWy2NmqigdMg/yJr4WedO
cZhoFxWWmN3ofEP8vjFsdC6FQ4UTkRbr83oxFF/yScmeoALzupuyZg/R3961
Z7/NUiEu4u6dsp+kvnWoFzQsaYas5y1FGaT+iEsH3cRizXDukjLe0YwhnyO9
ZXZ9M6yxONfoTSH9oySrnUu2GbZGh48UNWKIsu1SEd7eDOwnffU76zAIpypM
qEAzjN5Qc84uw5B1pyjpkE4zeKYK7y4h9dDkmMlJXYNmaIyP2FNVjCF0zCvr
9Klm+Dl5c6KQ1FN+tWqX21eagXe8+LZeNgbeisssFNoM+fOXRdkJGN5Fzb2u
iWwG6v10Lh9S33WuhBg1v2qGBr4De1e+xuDHl5s68LYZSu3vuS4j/WHRhMeB
t6AZ6sb4L7x7SvTamzRs+KsZ4qfLnjl7Yhid6e9r39UClYH8Gke0MeRdCS0z
VG2BvPWe8pGkvz3oPPwBabRA/NFd4n0axH/5cddTdFvIPDkoeZr0R62b5xfu
WrZAj3/Wl97NGGImOyQ2B7ZAypMZpcOk3+qPN5q59bfA/ejBbLMiDqy9dG8/
bagFDmUGMILyOdBH3SFlyWyB0tP+JwqyOeCR+XTw6FQLLOOTy5hN5kCCi4Gb
xKpW+BJydEgwigPT7IrQEtVWcEi75PDKiQPvmN/qBJ61AuIduCsnzAHnFyfk
HCNaIchXf50VPwfUdAbvVL5shfyPijZhyzhQF8e38+7bVrgyWCvYM8+GcZOz
oYyCVlBU5pkVHCTzVf70qYrBVhgfmHAZzWJD18PdvbcOtEGS94zQPQM2CEh/
xENDbWAu8kve3ZoFmhYPewcZbWCZGZusROY/t9CL9QOcNrBOjTk7aMqCDm7x
j79m22Cj9KVj+7VZED8SaNXD3w5rrr35HCbPAqVMx8ZWlXbIbnk0sEAfhWPa
Smll/u3g2cnFRSXzabBDrv2bzR1Q/TjwbOM5JjA1Pweu2tYBlP7yEVlTJuiJ
v0+9qdwBp+YCuF30mLCkOpJjrN4BnX9jmH/2MuHWZo+bcyc6oKbg8o9EfibY
9+95dPJOB3gU60bGFzHgiHnme56WDvAJ1w3cuo7M35ppQ1d9OsFUbWJIOp8G
HnsqcsTKfwDX9HKKa/8Q9KdXPG2W/QkNJy8rPnT+DX8d214r3u6GM1S9yL33
u2H7keWL9t964NOIcWKNUhvoJcleyVrXByWrbim4tVWDl/TFTb8t++FPO7/9
Ilcm7GCZr+o89gv2t1htyAhOR2sFx1ZUzP8CKxGZg++9ahAPep0hF/sb3mzN
3qw73IqcVL51rTQaAOO6hBSVn90ozcDmTfH0AHy9tSu3PPo3mhqVXDMSPQgm
YW/PWH4bQrmn9JZG6gzByRChwS21NBRoVBAgpTcEDgnlhbWtNGSprbjivcEQ
MPGpz/Z9NLRk76rVeccJL4T+eDZBQ8eFKWI/zgyBZbjx4gtpOqJTLbZJXR8C
nW02Wk9d6UjyuL3pu6ghUhftOgeFGMhHPyAhZ2QIFGst/FqPMFGL1VXLXYwh
sMhbGvPNkIk2expJfBodgmN99jfiTjFRXaJQxNuxISjs7rM4fpmJRP7GPQqf
H4LI0eZSu0AmSv6cd91VYBheHw/TtWlkIqowXWOH6jAEXVqgPj85ijYp1s9+
3D8Mhk9Ehz+fG0WekJ4rpzEMr6IPepfbjCLJax7K6zWHYS6LV6TbbRTZVXLJ
8RkOwwfaWta38FE06yXBR78wDCxKoZdW8yiS7TX88TZgGIyOHpGyMGChoDKN
DPPAYSj43k05aMpCfz7ueLT86TAsFxSMJosVKnMTUHEKGwYVCzfT0qssZLei
JXTP62F4mL9M7/NjFkree1avNHMYyq0jjHgrWEgp6EpeX/cwOKwIlv2oykbR
LmdCwvqGofNKi0DwITb6Z2Zgp/V7GKwVghqu6rARdeN24Q8jw3CS+SZr5Uk2
upHLuX59fBi6qLvZ9GtslPPLU35h2QioyiQ9Xp/IRupq/pESe0ZgRs44S2cp
B3XYSKjGqYzA6aLIiW8rOMj9WXqnjNoIhDyXGdouwEGfhn9IKhwcgc7+vLop
cQ7aELkzUVV3BASeqzzZrcRBS8Y7Pp86NwK/d674pHeag+pTFatD/EagO0GQ
NfyWg652FF8VChgBzUzdQNdkDuJZYsYX9XgEcjza0yY+cdDhs/ePxQaPQPFw
lP9gLgdlLm9tTY0eAY01RlYO1RwUaXf3V3XqCPDm1FbyMzjIcgNljrt1BKyS
bC6mbcFIQMIt91v7CBjV7loWvg2j0rWiNzx/jIAra0mJixJGW1aep9N7RyBi
VO/qGlWM8MRIB4U+Aiz3qWsjOhj51S5+iVscgUgHY8sha4xUKhJdTnPTQGlG
LEfDDiNasc52IR4anKBdEgi6gpFxTlCS/0oaSE5nVa1yxkg0Qey5kwgNJo3O
7Xh7G6NkDyXnA9toZG8AXtlwjM65NCtO7KABfiEqQY/EaLWjx/AnZRqc/++O
7IcXGLldLLSU2UeDmC8d/MvjMNIw1DVarkkDxWCH/ZYfMeLoMJaVatHgvd/J
7p8pGL2B4LLbR2lw5E79NZNPGPHsaznAMaSBe0f8GZksjJo2Wim0m9Ngr3ue
5qlCjB5Icg89O0ODZ8GzOk+KMNor+i5B/zy5H++NPXnFGL3kY4oVWdNgV+aT
qskyjGymPHnfOtHAeWVwGU89RlN1IQOuvjQ4vH7iqUsXRj2r2q8uPKSBLv9r
k9mfGJUZS+HHj2igOdUtc6sHo7Cm1L/xT2ngZZw6YNOP0baWapHGKHKf9+6/
O4YwWrNW8PWZlzQYX0qd3TiC0cwpC9mhGBrYai2IX6JhVNE+tPNvAg2+vwpw
q2dgZNXFraeYSuKJ1vppcjDSkTRozPlEgzGNV50GGKPt58NOaWbQQKTx3V6j
MYxmezZYn86hwUeJE4v7/mDUJ20/MpBHA29d92sbJzCqtPp8zfkrYUeFX1yT
GIX/0rgVUEyDN3b2nWlTGHnLPvy3ppQGFrH+5zynMbpoUxcQW06DG8+sBlRn
MNoxdCb8Sw0NNpg++pc4i5Gw/BtxqKfBWs9bkUZzGM1dpsXXNdLAYN5tJ5tw
Fc0z7XcLDa5+73IU/4vRJ4Xvu6+3E70cWRBIIhzhwFMw20kD0dzQPLkFjG6n
Gh32/0kDlzz3S3GErUfDKwR7aaA69ERQ8D+MdHf8NHzdTwPozi3xJrzzumzz
lgEa8Kj1evwkLJJ+9XT2EA2Sn9O2qyxiNM/J6D1Eo8Hiw+LhAMK/lGdsaxk0
iHh/LInM26ja9TDTjEWDT8F+l4T+YZSeFeD6i0ODU03GckaEI/80TDuN08Bk
MY52l/CdvSL3ZiZooJ7hkP6BsI3H+aUPp2lw3Y10I8L6uUlPBOZosO6HvvYA
YeVphmDMX6JHl2NCk4TF1HZHyy/SIKwy/TfZP9CCl7dUFhcdmq445pD9Aw0W
oKSDS+lg/dvnCdk/UN3cMsUaXjoEF41ZjxLOVD+ecWoFHa75lai3E35xJ2pf
Px8d2IWTYvmE7xf1fHNcTYdaVuRUGGG7/+S0pgXJ+bjUDhvChoedanyF6RBi
eqRwB+HdPtnHV4vSgfXU/g2HxEO8ZK7t5To6hDcpPkkmvMh15PxmSTpsiYn1
OEd46Ejg7wwpOqxxbrHhIVzvR7misZEOrjW/Tn0g8X/JY+VxcjN5/hLa4RaS
v0Xbdfuat9DB0YYrzoqwXTl16oQiHToqi44Nkvzv8tP2OqZEh3/N0R/b5zGK
/r2g1rCLDrp7p0y0CS9o5s0a7qXDxpXex1KInmr+KdzW308H7+oHmlZEf0oX
B9Sr1elwUt5C7TPRZ2Tx679HD9Hh4gDHd5Lo1/qewD1tLTqs/Ci99hrR98z8
hM9hYzqsyP6+7d84RpbnPmt+P06H03c5FWsIl3215z5oSoepXu8cSeKnZ95d
fgcs6JB2JzByHfHfluniABVrOnjk3b2YS/wZbO6t+8WGDlUci7QndIz+5Oxe
vucyHWILo49bED8Xu78LVHYk5+ddYn8Q/1uMP3m6zYMOnwMErHxJfSgy0TZO
uUkH5lDIdfE+jDZlLvAr3KLDU+/Jjo+knnCcXZ7J36eD+p+fBRmk/gSwzJ7L
BNIhh7Gz3LYVI6aRwMmEIDoM18+nfW/GyCStWnhDCB3uc38YF6RiJOWoHrk+
nA76Tfui4howyqFtfCEWSwcxq2n9C5UYSep1nY6Kp0Omp93m2+WkXn4IFxdJ
pIOJibR1aCmp95d5Y4Q+kPMn9OeTvpP8DzBj+TPpIDf8o8o5F6O1fblJSyro
8FwydPertyRe/Pfu5VfRyZyYl78iESM+DZ0z12pJvEHnhEs8RktetqzuaKKD
D+tRruwrEi9T7J3SRYe9Vq3u659hRK1UOGGC6bDJVMnB9ib5/kmsyPuHDoqN
52x13En+N+XzFE7S4Rz15x0pV4yQz9FCuXmSjydXV2U7EP8esJGf4WHAzVHj
YjdLkp/Pr//GSTJg9VJufSNNjFb02HSclGZA+/GWF/EHMfLn25a1XIYBVZ2X
RRn7ib+vFNjfkGfAfPqyeNvdGDnKtjfr7GKAzx6ZpViW+DtKIHn0KAP6WBdF
rLkx4r3na3bgBgNqG4PCv3zloJxx1hxyZ0BhVqqvJunndvZnEnRvMsD2Ou9g
ZSYHVZxQZp66w4C6++1chR85yH9Tr49zAAMG7ynV6EWR+aBmf9rbVwx4m2H0
aN6ZzBdrx7gFyhjw9ZO5fKUUB2U/Pv8xsoIB+xs2JNms4yCbhSrj9dUMKBOe
zZ8V4qCy4bgXCg0MCA3flSOwnIP8Cox2ancwIDbeU2RgjI24rT6e8WYyoLdG
PnlrORtxpVhlDAgzoYcWI7Hfho2qWJ3OCaJM6Gj6omx3no2Cd5kqWYozIXWs
pe6xGRutK9D+3C7NBJ7WtS9zddlIqVohrUaBCdSHBVVp29jIcvjPh/TDTPDi
MT3EM85CX2Ufx992ZAKlQNTcw4uF3GIyQoTLmGB8kb2X4jSK8hdiHpdVMMHd
4PbudbajaMHqka9bNRNG534/O03m1cdyFzxbGpjQrrzEvVR/FMV+4rsQ3smE
tnWa8uryo6iy+PIOYTYTYNLZqrSHicQH19cLiY9CEPX8zH5dJvq+PXCFkPMo
lNtWyNosZSAhQ7cdfgIsuHyUz7Dx4gjq2UltvVXEgsminY5FsoMoMx42D1mx
wdGtsLL8RT+6kKEqJL3IBtl8s8LqiB/oQUCib08qBzh9P6plnlHRZ7r0awFj
DK9vWiZLx5aiwLgA677jGIp4rZWkLUqR3Um2fLophk+Meqd1a0qRVFFR5rHT
GCZ4NWwWHpagoNDzVcE2GJ54VGwR7SxGV1VfjfPdwtBKF7sZ5V6INvmL6C//
gKHlWvzqXx+y0OL+u6s7kzEc+NHZ3S+RhbrYgy0f0jDIPWx3/xmcicJOf7mg
m4Vh0E/4nO9wOvq37aR7QBHZs+8ojaXdTUU9zaHxS1sxTKdEbYlISUQFj2Zs
W9sx3HRyMRYJfYMiNS4qvv2BoTssp0GGEY+M3ivlaPVhoOq/ipu6H4MKvRtr
fRkYfukkFGqnPkfRO/eFmrIw2G0x1FjDfIZuDMSayWIMeyZsokJ9gpCC8bX+
kkkMze20K16pvoiHu+1d2AyGzcL9myp9bqNfuRqO1vMYviZ52kSk3kBFjm+V
d/2HQS32uk9B6iX0YuOqqf//Lrd5d8j//98q/h8q4Y1y
        "]]},
      Annotation[#, "Charting`Private`Tag$2686#1"]& ]}, {}, {}}, {{}, {
     {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
      AbsoluteThickness[1.6], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0., -0.04062897392391766}, Automatic, 
       Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.1111111111111111, 0.6298276161005479}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.2222222222222222, 0.7965838945500382}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.3333333333333333, 1.8165645808849842}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.4444444444444444, 0.060760183737638584}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.5555555555555556, -0.08592843036234976}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.6666666666666666, -0.9303991345973857}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.7777777777777777, -1.0318282491969533}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {0.8888888888888888, -0.6038327316456199}, 
       Automatic, Scaled[{0.05, 0.05}]], InsetBox[
       GraphicsBox[
        {RGBColor[0, 0, 1], AbsolutePointSize[6], AbsoluteThickness[1.6], 
         CircleBox[{0, 0}]}], {1., 0.32976957055648}, Automatic, 
       Scaled[{0.05, 0.05}]]}, {}}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"t\"", TraditionalForm]},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.}, {-1.0318282491969533`, 1.8165645808849842`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.727880775294775*^9, 3.727880787730764*^9}, {
   3.727880934685656*^9, 3.7278809872854*^9}, {3.727881034647586*^9, 
   3.72788111070538*^9}, {3.727881149340519*^9, 3.727881273359902*^9}, {
   3.727881331668276*^9, 3.727881367908173*^9}, {3.727881679253851*^9, 
   3.727881732639435*^9}, {3.727882562737458*^9, 3.727882578070189*^9}, {
   3.727882623588429*^9, 3.727882694410623*^9}, {3.727882734556818*^9, 
   3.727882799272423*^9}, {3.727882852380828*^9, 3.727882925334324*^9}, 
   3.7278856759136066`*^9, 3.7278870450627317`*^9, 3.7279153858103523`*^9, 
   3.72791803725655*^9, 3.72791809498518*^9, 3.727923023895686*^9, 
   3.7279241984537888`*^9, 3.727925186689782*^9, {3.7279277074383373`*^9, 
   3.727927732567607*^9}, 3.727967810615572*^9, 3.7279687335582027`*^9, 
   3.727969808589816*^9, 3.7279699554358187`*^9, 3.7280443521874313`*^9, 
   3.728046448171671*^9, 3.7280664700061007`*^9, 3.728068121166772*^9, 
   3.7280837839406548`*^9, 3.728090742104409*^9, 3.728169445708262*^9, 
   3.728169541253911*^9, 3.728169823409259*^9, 3.728169883432933*^9, 
   3.728252955971521*^9},ExpressionUUID->"7f2732fb-6996-4d3e-836b-\
7fc7d5c5a97c"]
}, Open  ]],

Cell[TextData[{
 "Write a function for partials. Quietly map the indeterminate ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["0", "0"], TraditionalForm]],ExpressionUUID->
  "b579cedc-762e-4d8b-9c45-f853e45c0428"],
 " to 1. Test it symbolically."
}], "Text",
 CellChangeTimes->{{3.727925195515706*^9, 3.727925232785982*^9}, {
   3.7279678941263742`*^9, 3.727967900133898*^9}, {3.72797367998691*^9, 
   3.727973685039398*^9}, 3.728086523246662*^9, {3.72816734159263*^9, 
   3.7281673598690157`*^9}},ExpressionUUID->"2df64f76-f5e6-41f4-954e-\
eaed7db1833c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "partialsFn", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partialsFn", "[", 
    RowBox[{"order_", ",", "xs_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"Quiet", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["#", 
           RowBox[{"i", "-", "1"}]], "/.", 
          RowBox[{"{", 
           RowBox[{"Indeterminate", "\[Rule]", "1"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"order", "+", "1"}]}], "}"}]}], "]"}]}]}], "&"}], "@", 
    "xs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "@", 
  RowBox[{"partialsFn", "[", 
   RowBox[{"6", ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      SubscriptBox["x", "2"], ",", 
      SubscriptBox["x", "\[CapitalMu]"]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.727887092392867*^9, 3.7278870953121367`*^9}, {
  3.7278927196950607`*^9, 3.727893003172378*^9}, {3.727903114052039*^9, 
  3.7279031476650763`*^9}, {3.7279033176045437`*^9, 3.727903339378933*^9}, {
  3.727915570017507*^9, 3.727915600803166*^9}, {3.7279156539215097`*^9, 
  3.727915686797736*^9}, {3.727923101166524*^9, 
  3.727923181040741*^9}},ExpressionUUID->"bc5a2a90-6d11-4306-91f1-\
da70821677f7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      SubscriptBox["x", "1"], 
      SubsuperscriptBox["x", "1", "2"], 
      SubsuperscriptBox["x", "1", "3"], 
      SubsuperscriptBox["x", "1", "4"], 
      SubsuperscriptBox["x", "1", "5"], 
      SubsuperscriptBox["x", "1", "6"]},
     {"1", 
      SubscriptBox["x", "2"], 
      SubsuperscriptBox["x", "2", "2"], 
      SubsuperscriptBox["x", "2", "3"], 
      SubsuperscriptBox["x", "2", "4"], 
      SubsuperscriptBox["x", "2", "5"], 
      SubsuperscriptBox["x", "2", "6"]},
     {"1", 
      SubscriptBox["x", "\[CapitalMu]"], 
      SubsuperscriptBox["x", "\[CapitalMu]", "2"], 
      SubsuperscriptBox["x", "\[CapitalMu]", "3"], 
      SubsuperscriptBox["x", "\[CapitalMu]", "4"], 
      SubsuperscriptBox["x", "\[CapitalMu]", "5"], 
      SubsuperscriptBox["x", "\[CapitalMu]", "6"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7279231186573143`*^9, 3.7279231819525948`*^9}, 
   3.7279241985452023`*^9, {3.727927707499826*^9, 3.727927732638883*^9}, 
   3.7279678106408577`*^9, 3.727968733627557*^9, 3.727969808625535*^9, 
   3.727969955460413*^9, 3.728044352257525*^9, 3.728046448251258*^9, 
   3.728066470133565*^9, 3.728068121219434*^9, 3.728083784014492*^9, 
   3.728090742211894*^9, 3.728169445777561*^9, 3.728169541293954*^9, 
   3.7281698234776993`*^9, 3.728169883478408*^9, 
   3.728252956051774*^9},ExpressionUUID->"c1b26ac9-3e84-4416-a803-\
6ff2e62dc970"]
}, Open  ]],

Cell["\<\
Mechanize the normal equations; we expect it to over-fit, and we show that \
below.\
\>", "Text",
 CellChangeTimes->{{3.7279232272996387`*^9, 3.727923264174778*^9}, {
  3.727925248541918*^9, 3.7279252612235193`*^9}, {3.728219535976645*^9, 
  3.728219544909062*^9}, {3.728251418408484*^9, 
  3.728251422388431*^9}},ExpressionUUID->"db54f786-8f99-4ab2-9bc6-\
f4d6a700b629"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "mleFit", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mleFit", "[", 
    RowBox[{"order_", ",", "trainingSet_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xs", "=", 
        RowBox[{
        "trainingSet", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"ys", "=", 
        RowBox[{
        "trainingSet", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{
       RowBox[{"PseudoInverse", "[", 
        RowBox[{"partialsFn", "[", 
         RowBox[{"order", ",", "xs"}], "]"}], "]"}], ".", "ys"}],
      Background->RGBColor[1, 1, 0]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mleFit", "[", 
  RowBox[{"3", ",", "bishopTrainingSet"}], "]"}]}], "Input",
 CellChangeTimes->{{3.727885728192296*^9, 3.727885779639097*^9}, {
  3.727885809907544*^9, 3.727885814458734*^9}, {3.727886129093534*^9, 
  3.7278861410970383`*^9}, {3.72788617438813*^9, 3.7278862220128107`*^9}, {
  3.7278865585658693`*^9, 3.727886599363595*^9}, {3.7279031627619*^9, 
  3.727903227220593*^9}, {3.727913081988744*^9, 3.7279130820838013`*^9}, {
  3.727913123878634*^9, 3.727913123932819*^9}, {3.728090725899406*^9, 
  3.7280907259084253`*^9}, {3.728169613067173*^9, 
  3.728169613076036*^9}},ExpressionUUID->"5968dc96-c225-4989-9d86-\
0022ee0eec9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.2070006316484814`"}], ",", "13.727311365560077`", ",", 
   RowBox[{"-", "39.19275674896413`"}], ",", "26.018920162011536`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7278862229627943`*^9, {3.727886559667815*^9, 3.727886599739743*^9}, {
   3.72790316911255*^9, 3.727903214869055*^9}, 3.7279033439958277`*^9, {
   3.727913077175877*^9, 3.727913082662711*^9}, 3.727913124658298*^9, 
   3.727915385897655*^9, 3.727915689226351*^9, 3.727918037352195*^9, 
   3.727918095083848*^9, 3.7279241986227837`*^9, {3.727927707553419*^9, 
   3.727927732702104*^9}, 3.727967810695971*^9, 3.727968733693976*^9, 
   3.7279698086933317`*^9, 3.727969955502687*^9, 3.728044352304865*^9, 
   3.728046448308305*^9, 3.728066470172489*^9, 3.72806812129386*^9, 
   3.728083784080934*^9, 3.728090742292589*^9, 3.72816944582929*^9, 
   3.728169541357428*^9, 3.728169823527856*^9, 3.728169883537332*^9, 
   3.728252956118902*^9},ExpressionUUID->"40aa425e-d84f-417b-96ec-\
40baf2e2c061"]
}, Open  ]],

Cell[TextData[{
 "Confer Bishop\[CloseCurlyQuote]s equation 3.3, page 138, where he writes \
the parameters to estimate as ",
 Cell[BoxData[
  FormBox[
   StyleBox["w",
    FontWeight->"Bold"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f93adc3c-853e-4c72-9d86-2aa88377c8d3"],
 " and the observation equation as"
}], "Text",
 CellChangeTimes->{{3.727967934130774*^9, 3.727967994255875*^9}, {
  3.728167384043807*^9, 3.7281673844840384`*^9}, {3.7282203912603188`*^9, 
  3.728220431494154*^9}, {3.7282205477554483`*^9, 3.728220580377705*^9}, {
  3.728220691138853*^9, 3.72822075490273*^9}, {3.728222921609508*^9, 
  3.728222923769473*^9}, {3.72822433008339*^9, 
  3.728224339280476*^9}},ExpressionUUID->"65ec69af-ce5e-4394-a4c7-\
9b7025018373"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"y", "(", 
    RowBox[{
     StyleBox["x",
      FontWeight->"Bold"], 
     StyleBox[",",
      FontWeight->"Plain"], 
     StyleBox[" ",
      FontWeight->"Plain"], 
     StyleBox["w",
      FontWeight->"Bold"]}], 
    StyleBox[")",
     FontWeight->"Plain"]}], 
   StyleBox["=",
    FontWeight->"Plain"], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"j", "=", "0"}], "\[CapitalMu]"], 
    RowBox[{
     SubscriptBox[
      StyleBox["w",
       FontWeight->"Plain"], "j"], 
     RowBox[{
      SubscriptBox["\[Phi]", 
       RowBox[{"\[ThinSpace]", "j"}]], "\[ThinSpace]", "(", 
      StyleBox["x",
       FontWeight->"Bold"], ")"}]}]}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.7282207613079443`*^9, 3.728220889669578*^9}, {
  3.728221929311122*^9, 3.728221929312549*^9}, {3.7282229942899933`*^9, 
  3.728223000986117*^9}, {3.728251451814763*^9, 
  3.728251478938428*^9}},ExpressionUUID->"c23f6a20-2521-4b32-bdf7-\
92fc5ac48ac3"],

Cell[TextData[{
 "(bias term incorporated as coefficient of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["0", "th"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "856ceccb-b337-46f7-acfb-9cde919fa114"],
 " basis function). This is a predictive model: you give me some concrete \
inputs ",
 Cell[BoxData[
  FormBox[
   StyleBox["x",
    FontWeight->"Bold"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "15dedbdc-ea13-4583-be2d-b0f2fd3052c4"],
 ", some parameters ",
 Cell[BoxData[
  FormBox[
   StyleBox["w",
    FontWeight->"Bold"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5c7a5a42-af1e-409a-a658-bfca1a86f03c"],
 ", and I\[CloseCurlyQuote]ll give you a predicted observation ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6aae751e-38d8-4953-867b-5863b83af9f4"],
 " in terms of a number of basis functions ",
 Cell[BoxData[
  FormBox["\[Phi]", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "81dd4bd5-3e34-40e2-8c3d-0e0c557b5c29"],
 " equal in length to the number of parameters. In the polynomial case, the \
number of parameters is one more than the order ",
 Cell[BoxData[
  FormBox["\[CapitalMu]", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ab13ff31-c2c7-47c2-8dd5-58fb42fbf222"],
 " of the polynomials. Bishop converts ",
 Cell[BoxData[
  FormBox[
   StyleBox["w",
    FontWeight->"Bold"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2413a212-ea76-40c0-9640-4e8b71d6160d"],
 " into a co-vector and writes"
}], "Text",
 CellChangeTimes->{{3.728220906295454*^9, 3.728220946192494*^9}, {
   3.7282218953744383`*^9, 3.728221919178042*^9}, {3.728222933472761*^9, 
   3.728222989706678*^9}, {3.728223024410286*^9, 3.728223057641677*^9}, {
   3.72822435625596*^9, 3.728224387983367*^9}, 
   3.728251485977022*^9},ExpressionUUID->"412f8bcc-f4b4-4465-92b5-\
d143af7effdc"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"y", "(", 
    RowBox[{
     StyleBox["x",
      FontWeight->"Bold"], 
     StyleBox[",",
      FontWeight->"Plain"], 
     StyleBox[" ",
      FontWeight->"Plain"], 
     StyleBox["w",
      FontWeight->"Bold"]}], 
    StyleBox[")",
     FontWeight->"Plain"]}], 
   StyleBox["=",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{
     StyleBox["w",
      FontWeight->"Bold"], 
     StyleBox["\[Transpose]",
      FontWeight->"Plain"]}], 
    RowBox[{
     StyleBox["\[Phi]",
      FontWeight->"Bold"], 
     StyleBox["\[ThinSpace]",
      FontWeight->"Plain"], "(", 
     StyleBox["x",
      FontWeight->"Bold"], 
     StyleBox[")",
      FontWeight->"Plain"]}]}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.7282219448855343`*^9, 
  3.728222027597753*^9}},ExpressionUUID->"d56aaaf7-ca14-41d7-a295-\
97ae45d3304a"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["\[Phi]",
     FontWeight->"Bold"], "\[ThinSpace]", "(", 
    StyleBox["x",
     FontWeight->"Bold"], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7664d159-29b2-44e2-8792-094becf35ae2"],
 " is an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"\[CapitalMu]", "+", "1"}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2c7292a6-4c65-41e9-b006-06cbefd16de3"],
 "-vector of basis functions, the transpose of one row of our partials matrix \
",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ed495fe0-6173-47f1-97f1-6ccd7a93693a"],
 ". We claim it\[CloseCurlyQuote]s better always to think of partials or  \
gradients as co-vectors (row vectors or covariant vectors, see ",
 ButtonBox["https://goo.gl/DkeVmM",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://goo.gl/DkeVmM"], None},
  ButtonNote->"https://goo.gl/DkeVmM"],
 "). To find best-fit values for ",
 Cell[BoxData[
  FormBox[
   StyleBox["w",
    FontWeight->"Bold"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2e0cbb6f-7787-4b3a-9367-89d4bc1761dd"],
 " from data, the rows of the partials matrix ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "4ef83fad-5c97-4ae5-98df-5042206ebc41"],
 " are the co-vector gradients of ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "c7e242fb-2722-4ae6-9a2b-3e2d84e871a3"],
 " with respect to ",
 Cell[BoxData[
  FormBox[
   StyleBox["w",
    FontWeight->"Bold"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "baff650f-684a-47d3-95c6-278ac2b4a93c"],
 ". We\.7f also prefer to write "
}], "Text",
 CellChangeTimes->{{3.728222034989254*^9, 3.728222053237129*^9}, {
   3.728222178848859*^9, 3.7282222660799637`*^9}, {3.728222300000989*^9, 
   3.7282223904929523`*^9}, {3.7282228551572657`*^9, 3.728222859737496*^9}, {
   3.728223076788225*^9, 3.728223190463003*^9}, {3.728223230865528*^9, 
   3.728223361801167*^9}, 3.728223984636827*^9, {3.7282240554498873`*^9, 
   3.728224092328535*^9}, {3.728224400399331*^9, 3.728224741229491*^9}, {
   3.728224776796547*^9, 3.728224809363667*^9}, {3.7282517358200502`*^9, 
   3.7282517662896633`*^9}},ExpressionUUID->"694693d1-ec8b-4464-b249-\
75bfeccf18c1"],

Cell[CellGroupData[{

Cell[TextData[{
 "observations as an ",
 Cell[BoxData[
  FormBox["\[CapitalNu]", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "fcfdbf6a-2e88-4194-8eb9-62448305406d"],
 "-column-vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalZeta]", 
    RowBox[{"\[VeryThinSpace]", 
     RowBox[{"\[CapitalNu]", "+", "1"}]}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7f371c41-2439-49ff-a405-bbbac410c97c"],
 " with elements ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Zeta]", 
    RowBox[{"\[VeryThinSpace]", 
     RowBox[{"j", "\[ThinSpace]", "\[Element]", "\[ThinSpace]", 
      RowBox[{"[", "\[ThinSpace]", 
       RowBox[{
        RowBox[{"1", "\[ThinSpace]", ".."}], "\[CapitalNu]"}], "\[ThinSpace]",
        "]"}]}]}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "31127627-edad-47a8-807a-e6bbbe593f86"]
}], "Item",
 CellChangeTimes->{{3.728222034989254*^9, 3.728222053237129*^9}, {
   3.728222178848859*^9, 3.7282222660799637`*^9}, {3.728222300000989*^9, 
   3.7282223904929523`*^9}, {3.7282228551572657`*^9, 3.728222859737496*^9}, {
   3.728223076788225*^9, 3.728223190463003*^9}, {3.728223230865528*^9, 
   3.728223361801167*^9}, 3.728223984636827*^9, {3.7282240554498873`*^9, 
   3.728224092328535*^9}, {3.728224400399331*^9, 3.728224741229491*^9}, {
   3.728224776796547*^9, 3.728224809363667*^9}, {3.7282517358200502`*^9, 
   3.728251740048966*^9}, {3.728251771407675*^9, 
   3.728251772575143*^9}},ExpressionUUID->"e5d4da9f-0d46-4255-ad70-\
5681ae5b2813"],

Cell[TextData[{
 "the model ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"\[CapitalMu]", "+", "1"}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "34093d14-aa35-4214-a3e2-8b50e8957f15"],
 "-column-vector as ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalXi]", 
    RowBox[{"\[ThinSpace]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[CapitalMu]", "+", "1"}], ")"}], "\[Times]", "1"}]}]], 
   TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "27530d6a-94c4-4ec6-98d8-e68dfb593b21"],
 " with elements ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Xi]", 
    RowBox[{"\[ThinSpace]", 
     RowBox[{"i", "\[ThinSpace]", "\[Element]", "\[ThinSpace]", 
      RowBox[{"[", "\[ThinSpace]", 
       RowBox[{
        RowBox[{"1", "\[ThinSpace]", ".."}], "\[CapitalMu]"}], "\[ThinSpace]",
        "]"}]}]}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "18943418-6c16-48be-9e34-aa1a1b321058"]
}], "Item",
 CellChangeTimes->{{3.728222034989254*^9, 3.728222053237129*^9}, {
   3.728222178848859*^9, 3.7282222660799637`*^9}, {3.728222300000989*^9, 
   3.7282223904929523`*^9}, {3.7282228551572657`*^9, 3.728222859737496*^9}, {
   3.728223076788225*^9, 3.728223190463003*^9}, {3.728223230865528*^9, 
   3.728223361801167*^9}, 3.728223984636827*^9, {3.7282240554498873`*^9, 
   3.728224092328535*^9}, {3.728224400399331*^9, 3.728224741229491*^9}, {
   3.728224776796547*^9, 3.728224809363667*^9}, {3.7282517358200502`*^9, 
   3.728251740048966*^9}, {3.728251771407675*^9, 3.7282517814515944`*^9}, {
   3.7282518993121*^9, 
   3.7282519004727907`*^9}},ExpressionUUID->"1aa2fc9b-a4a2-48fe-8ec7-\
5d3eb5561a42"],

Cell[TextData[{
 "partials matrix as ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "d3592327-6324-4fd1-8aca-3364bb7df57a"]
}], "Item",
 CellChangeTimes->{{3.728222034989254*^9, 3.728222053237129*^9}, {
   3.728222178848859*^9, 3.7282222660799637`*^9}, {3.728222300000989*^9, 
   3.7282223904929523`*^9}, {3.7282228551572657`*^9, 3.728222859737496*^9}, {
   3.728223076788225*^9, 3.728223190463003*^9}, {3.728223230865528*^9, 
   3.728223361801167*^9}, 3.728223984636827*^9, {3.7282240554498873`*^9, 
   3.728224092328535*^9}, {3.728224400399331*^9, 3.728224741229491*^9}, {
   3.728224776796547*^9, 3.728224809363667*^9}, {3.7282517358200502`*^9, 
   3.728251740048966*^9}, {3.728251771407675*^9, 3.728251789543252*^9}, {
   3.72825189594316*^9, 
   3.7282518961283197`*^9}},ExpressionUUID->"72896bef-06cf-4bd5-b4da-\
981b955da6e0"]
}, Open  ]],

Cell[TextData[{
 "Bishop calls our partials matrix the ",
 StyleBox["design matrix",
  FontSlant->"Italic"],
 " in his equation 3.16, page 142, but then he must work in the dual of our \
formulation because he didn\[CloseCurlyQuote]t treat the basis functions as \
gradients of the parameters."
}], "Text",
 CellChangeTimes->{{3.728222034989254*^9, 3.728222053237129*^9}, {
   3.728222178848859*^9, 3.7282222660799637`*^9}, {3.728222300000989*^9, 
   3.7282223904929523`*^9}, {3.7282228551572657`*^9, 3.728222859737496*^9}, {
   3.728223076788225*^9, 3.728223190463003*^9}, {3.728223230865528*^9, 
   3.728223361801167*^9}, 3.728223984636827*^9, {3.7282240554498873`*^9, 
   3.728224092328535*^9}, {3.728224400399331*^9, 3.728224741229491*^9}, {
   3.728224776796547*^9, 3.728224809363667*^9}, {3.7282517358200502`*^9, 
   3.728251740048966*^9}, {3.728251771407675*^9, 
   3.728251888355431*^9}},ExpressionUUID->"592189fd-2218-4bac-bb2b-\
0e745343539c"],

Cell[BoxData[
 FormBox[
  RowBox[{"Z", "=", 
   RowBox[{
    RowBox[{"A", "\[CenterDot]", "\[CapitalXi]"}], "  ", "=", "  ", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubscriptBox["\[Zeta]", "0"]},
        {
         SubscriptBox["\[Zeta]", "1"]},
        {"\[VerticalEllipsis]"},
        {
         SubscriptBox["\[Zeta]", "\[CapitalNu]"]}
       }], ")"}], "  ", "=", "  ", 
     RowBox[{
      SubscriptBox[
       StyleBox[
        RowBox[{"(", GridBox[{
           {
            RowBox[{
             SubscriptBox[
              RowBox[{
               StyleBox["A",
                FontWeight->"Plain"], 
               StyleBox["\[ThinSpace]",
                FontWeight->"Bold"]}], 
              RowBox[{"1", "\[Times]", "\[CapitalMu]"}]], 
             RowBox[{"(", 
              SubscriptBox["x", "1"], ")"}]}]},
           {
            RowBox[{
             SubscriptBox[
              RowBox[{
               StyleBox["A",
                FontWeight->"Plain"], 
               StyleBox["\[ThinSpace]",
                FontWeight->"Bold"]}], 
              RowBox[{"1", "\[Times]", "\[CapitalMu]"}]], 
             RowBox[{"(", 
              SubscriptBox["x", "2"], ")"}]}]},
           {"\[VerticalEllipsis]"},
           {
            RowBox[{
             SubscriptBox[
              RowBox[{
               StyleBox["A",
                FontWeight->"Plain"], 
               StyleBox["\[ThinSpace]",
                FontWeight->"Bold"]}], 
              RowBox[{"1", "\[Times]", "\[CapitalMu]"}]], 
             RowBox[{"(", 
              SubscriptBox["x", "\[CapitalNu]"], ")"}]}]}
          }], ")"}],
        FontWeight->"Plain"], 
       RowBox[{"\[CapitalNu]", "\[Times]", "\[CapitalMu]"}]], "\[CenterDot]", 
      
      RowBox[{"(", GridBox[{
         {
          SubscriptBox["\[Xi]", "0"]},
         {
          SubscriptBox["\[Xi]", "1"]},
         {"\[VerticalEllipsis]"},
         {
          SubscriptBox["\[Xi]", "\[CapitalMu]"]}
        }], ")"}]}]}]}]}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7282223267202578`*^9, 3.728222330771399*^9}, {
  3.728223414452943*^9, 3.728223474859379*^9}, {3.728223514299732*^9, 
  3.728223975929124*^9}, {3.728224109293193*^9, 3.728224109294752*^9}, {
  3.728224191499645*^9, 
  3.728224196666141*^9}},ExpressionUUID->"27b0bdc8-ecb1-4c5a-8eb9-\
42856ccb929a"],

Cell[CellGroupData[{

Cell["MLE: The Normal Equations", "Subsection",
 CellChangeTimes->{{3.728251929759521*^9, 
  3.728251940262474*^9}},ExpressionUUID->"f2a5c90a-ce6c-4dbe-8117-\
0096ce983c3c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "symbolicPowers", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"symbolicPowers", "[", 
    RowBox[{"variable_", ",", "order_"}], "]"}], ":=", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"partialsFn", "[", 
     RowBox[{"order", ",", 
      RowBox[{"{", "variable", "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"symbolicPowers", "[", 
  RowBox[{
   SubscriptBox["x", "\[CapitalAlpha]"], ",", "6"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7279153202694693`*^9, 3.727915371067972*^9}, {
  3.7279237255692472`*^9, 
  3.727923807685313*^9}},ExpressionUUID->"2575f9a4-fce4-4e97-8c33-\
4430117f01b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   SubscriptBox["x", "\[CapitalAlpha]"], ",", 
   SubsuperscriptBox["x", "\[CapitalAlpha]", "2"], ",", 
   SubsuperscriptBox["x", "\[CapitalAlpha]", "3"], ",", 
   SubsuperscriptBox["x", "\[CapitalAlpha]", "4"], ",", 
   SubsuperscriptBox["x", "\[CapitalAlpha]", "5"], ",", 
   SubsuperscriptBox["x", "\[CapitalAlpha]", "6"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.72792373505497*^9, {3.727923792587029*^9, 3.72792380914485*^9}, 
   3.727924198842104*^9, 3.727925367850481*^9, {3.727927707749852*^9, 
   3.727927732836051*^9}, 3.727967810863278*^9, 3.727968733893249*^9, 
   3.727969808835909*^9, 3.727969955636821*^9, 3.728044352436102*^9, 
   3.7280464484904633`*^9, 3.728066471059003*^9, 3.728068121435431*^9, 
   3.72808378466366*^9, 3.728090742360767*^9, 3.728169445894191*^9, 
   3.728169541405608*^9, 3.7281698235783987`*^9, 3.728169883587824*^9, 
   3.728225860450347*^9, 
   3.7282529561855087`*^9},ExpressionUUID->"35ad3ed2-ccaa-49f7-97ee-\
a2c0bd3d6ebe"]
}, Open  ]],

Cell["The normal equations as a symbolic polynomial:", "Text",
 CellChangeTimes->{{3.728086616407036*^9, 3.728086644421227*^9}, {
  3.728167395574012*^9, 3.7281673997415857`*^9}, {3.728219572416009*^9, 
  3.728219595133831*^9}},ExpressionUUID->"f2d160bd-fb34-48aa-a038-\
119c0a158232"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"symbolicPowers", "[", 
     RowBox[{"x", ",", "order"}], "]"}], ".", 
    RowBox[{"mleFit", "[", 
     RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "3", ",", "\"\<polynomial order\>\""}], "}"}], 
     ",", "0", ",", "16", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Labeled\>\"", "}"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7280866505961733`*^9, 3.728086772996965*^9}, 
   3.728086803589117*^9, 3.728090725912261*^9, 
   3.7281696130841227`*^9},ExpressionUUID->"180d48a3-0498-4b3e-bd04-\
861394082489"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`order$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`order$$], 3, "polynomial order"}, 0, 16, 1}}, 
    Typeset`size$$ = {488., {1., 18.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`order$2722$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`order$$ = 3}, 
      "ControllerVariables" :> {
        Hold[$CellContext`order$$, $CellContext`order$2722$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Dot[
        $CellContext`symbolicPowers[$CellContext`x, $CellContext`order$$], 
        $CellContext`mleFit[$CellContext`order$$, \
$CellContext`bishopTrainingSet]], 
      "Specifications" :> {{{$CellContext`order$$, 3, "polynomial order"}, 0, 
         16, 1, Appearance -> {"Labeled"}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{554., {72., 80.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.728086773562842*^9, 3.728086804275236*^9, 
  3.728090742426281*^9, 3.7281694459480057`*^9, 3.728169541460916*^9, 
  3.728169823628757*^9, 3.728169883652279*^9, 3.728225863858274*^9, 
  3.728252956249748*^9},ExpressionUUID->"126a16e6-cee3-4bd3-8751-\
1ab1bfb7b663"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["RLS: Recurrent Least Squares", "Subsection",
 CellChangeTimes->{{3.72825197766994*^9, 
  3.72825198556595*^9}},ExpressionUUID->"f32a9bf6-db99-4caa-8fb8-\
82743b171c1e"],

Cell[TextData[{
 "RLS is regularized by its a-priori estimate and a-priori information \
matrix. Use the slider below to show that once the minimum info becomes \
smaller than about ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", 
    RowBox[{"-", "9.034", " "}]], TraditionalForm]],ExpressionUUID->
  "936e5f42-dbd4-4ae8-82b0-e003f33c49be"],
 ", the \[CapitalLambda] matrix becomes ill-conditioned, pink warning message \
highlights appear from the Wolfram kernel, and the solution is numerically \
suspect."
}], "Text",
 CellChangeTimes->{{3.72792327800198*^9, 3.7279233078789587`*^9}, {
  3.7279713983804617`*^9, 3.72797140314161*^9}, {3.7280360936971283`*^9, 
  3.728036119472001*^9}, {3.728036163659585*^9, 3.728036240971705*^9}, {
  3.728219601486958*^9, 3.728219652487793*^9}, {3.728252003629099*^9, 
  3.7282520048359327`*^9}},ExpressionUUID->"bfbf8b69-2d4e-4244-9955-\
828f845e3660"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "rlsFit", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rlsFit", "[", "minInfo_", "]"}], "[", 
    RowBox[{"order_", ",", "trainingSet_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xs", "=", 
        RowBox[{
        "trainingSet", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"ys", "=", 
        RowBox[{
        "trainingSet", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aPriori", "=", 
          RowBox[{"List", "/@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"order", "+", "1"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"aPrioriInfo", "=", 
          RowBox[{"minInfo", "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"order", "+", "1"}], "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"Fold", "[", 
         RowBox[{"update", ",", 
          RowBox[{"{", 
           RowBox[{"aPriori", ",", "aPrioriInfo"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"List", "/@", "ys"}], ",", 
             RowBox[{"List", "/@", 
              RowBox[{"partialsFn", "[", 
               RowBox[{"order", ",", "xs"}], "]"}]}]}], "}"}], 
           "\[Transpose]"}]}], "]"}],
        Background->RGBColor[1, 1, 0]]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rlsFit", "[", 
      SuperscriptBox["10", 
       RowBox[{"-", "logMinInfo"}]], "]"}], "[", 
     RowBox[{"3", ",", "bishopTrainingSet"}], "]"}], "\[LeftDoubleBracket]", 
    "1", "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"logMinInfo", ",", "9.034"}], "}"}], ",", "0", ",", "16", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.727883299044437*^9, 3.727883408526169*^9}, {
   3.727883570679338*^9, 3.727883753730864*^9}, {3.727883800858717*^9, 
   3.727883838115073*^9}, {3.727883894473887*^9, 3.727884018340303*^9}, {
   3.72788406916578*^9, 3.727884157272581*^9}, {3.727884225392531*^9, 
   3.7278842277505903`*^9}, {3.7278843168329363`*^9, 
   3.7278844893030443`*^9}, {3.72788451944672*^9, 3.727884559637722*^9}, {
   3.727884601998887*^9, 3.727884641880664*^9}, {3.727884702205894*^9, 
   3.727884709112802*^9}, {3.727884840379463*^9, 3.727884840498255*^9}, {
   3.7279032520135508`*^9, 3.727903302618636*^9}, 3.7279033915207367`*^9, {
   3.727913089794886*^9, 3.727913129180463*^9}, {3.727923317022047*^9, 
   3.727923549746903*^9}, {3.727923650995542*^9, 3.727923655663189*^9}, 
   3.727923702873125*^9, {3.727923927853791*^9, 3.727923934334038*^9}, {
   3.727925310895234*^9, 3.727925333557376*^9}, {3.728036060877223*^9, 
   3.728036070969619*^9}, {3.7280362269856453`*^9, 3.72803623654352*^9}, {
   3.7280907259214077`*^9, 3.7280907259309683`*^9}, {3.728225889419126*^9, 
   3.728225889490087*^9}},ExpressionUUID->"67d37a44-0ae8-4cde-bdf8-\
4f2847ee2026"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`logMinInfo$$ = 9.034, Typeset`show$$ = True,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`logMinInfo$$], 9.034}, 0, 16}}, Typeset`size$$ = {
    507., {5., 13.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`logMinInfo$2786$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`logMinInfo$$ = 9.034}, 
      "ControllerVariables" :> {
        Hold[$CellContext`logMinInfo$$, $CellContext`logMinInfo$2786$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Part[
        $CellContext`rlsFit[10^(-$CellContext`logMinInfo$$)][
        3, $CellContext`bishopTrainingSet], 1], 
      "Specifications" :> {{{$CellContext`logMinInfo$$, 9.034}, 0, 16, 
         Appearance -> "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{573., {72., 80.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.727913103888098*^9, 3.7279131297094307`*^9}, 
   3.72791538595157*^9, 3.727915690618195*^9, 3.727918037406971*^9, 
   3.7279180951339293`*^9, 3.727923485679799*^9, {3.7279235212598963`*^9, 
   3.727923539397266*^9}, 3.727923656903368*^9, 3.727923703600333*^9, 
   3.7279240791268167`*^9, 3.7279241986997967`*^9, 3.727925360788505*^9, {
   3.727927707618471*^9, 3.7279277327546997`*^9}, 3.727967810771263*^9, 
   3.727968733807341*^9, 3.727969808755946*^9, 3.727969955556759*^9, {
   3.728036061824555*^9, 3.728036072918947*^9}, {3.7280362295589123`*^9, 
   3.7280362371095047`*^9}, 3.72804435235367*^9, 3.728046448406433*^9, 
   3.728066470986565*^9, 3.728068121352648*^9, 3.728083784580184*^9, 
   3.728090742542427*^9, 3.728169446059235*^9, 3.728169541523823*^9, 
   3.728169823744402*^9, 3.728169883754513*^9, {3.728225871308848*^9, 
   3.728225890298745*^9}, 
   3.728252956368375*^9},ExpressionUUID->"e63a45b5-e854-4bc5-af2e-\
c0e5eeb90c2e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Foldable Kalman Filter", "Subsection",
 CellChangeTimes->{{3.728252019102867*^9, 
  3.728252024734199*^9}},ExpressionUUID->"e68f32b7-beff-4667-b749-\
9bdf69b4a503"],

Cell[TextData[{
 "The foldable Kalman filter follows below. It has only the ",
 StyleBox["update",
  FontSlant->"Italic"],
 " phase of a typical Kalman filter because the parameters are constant and \
there is no ",
 StyleBox["predict",
  FontSlant->"Italic"],
 " phase. Its numerical hazard is catastrophic cancelation in the covariance \
update. In comments, the code ",
 StyleBox["sows",
  FontSlant->"Italic"],
 " out several mathematically equivalent expressions for the covariance of \
the parameters. These expressions have different numerical properties. We \
could ",
 StyleBox["reap",
  FontSlant->"Italic"],
 " and track them externally to monitor catastrophic cancelation. \n\nSuch \
issues are routinely addressed by  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", "D"}], TraditionalForm]],ExpressionUUID->
  "5e691ff7-ba0d-40b4-bee5-a6ed12dabba4"],
 " filtering, square-root filtering, or square-root information filtering, \
out of scope for now.\n\nNote carefully, the ",
 Cell[BoxData[
  FormBox["\[CapitalZeta]", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "944fe3ef-92a4-4716-82e3-d3bdcef1b832"],
 " parameter, the first in the definition of ",
 Cell[BoxData[
  FormBox["kalmanUpdate", TraditionalForm]], "Code",
  FormatType->"TraditionalForm",ExpressionUUID->
  "217ff7f6-5c5e-4f2d-b3fe-0e8e9924016d"],
 ", is the covariance matrix of the observation noise; it is NOT a standard \
deviation and it is NOT the a-priori covariance of the parameter estimate."
}], "Text",
 CellChangeTimes->{{3.727925392992813*^9, 3.727925440455097*^9}, {
  3.727968003304467*^9, 3.727968095322001*^9}, {3.727971415917358*^9, 
  3.727971445401681*^9}, {3.728167467247233*^9, 3.7281676104536*^9}, {
  3.7282196608402767`*^9, 3.728219713545024*^9}, {3.7282197580747232`*^9, 
  3.728219820377639*^9}, {3.728225898772212*^9, 3.7282259019302683`*^9}, {
  3.7282520355408773`*^9, 3.7282520676585073`*^9}, {3.728252107648376*^9, 
  3.7282521980434017`*^9}},ExpressionUUID->"61f4626f-00ca-415e-ac2f-\
9ca330d144c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"kalmanUpdate", ",", "kalFit"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["kalmanUpdate",
      Background->RGBColor[1, 1, 0]], "[", "\[CapitalZeta]_", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "P_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z_", ",", "A_"}], "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"D", ",", "KT", ",", "K", ",", "L"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "=", 
       RowBox[{"\[CapitalZeta]", "+", 
        RowBox[{"A", ".", "P", ".", 
         RowBox[{"A", "\[Transpose]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"KT", "=", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"D", ",", 
         RowBox[{"A", ".", "P"}]}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"D", " ", "and", " ", "P", " ", "are", " ", "symmetric"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"K", "=", 
       RowBox[{"KT", "\[Transpose]"}]}], 
      RowBox[{"(*", 
       RowBox[{"P", ".", 
        RowBox[{"A", "\[Transpose]"}], ".", 
        RowBox[{"PseudoInverse", "[", "D", "]"}]}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"L", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Length", "[", "P", "]"}], "]"}], "-", 
        RowBox[{"K", ".", "A"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Sow", "[", 
         RowBox[{
          RowBox[{"L", ".", "P"}], ",", "\"\<P1\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Sow", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"L", ".", "P", ".", 
            RowBox[{"L", "\[Transpose]"}]}], "+", 
           RowBox[{"K", ".", "\[CapitalZeta]", ".", 
            RowBox[{"K", "\[Transpose]"}]}]}], ",", "\"\<P2\>\""}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Sow", "[", 
         RowBox[{
          RowBox[{"P", "-", 
           RowBox[{"K", ".", "D", ".", 
            RowBox[{"K", "\[Transpose]"}]}]}], ",", "\"\<P3\>\""}], "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "+", 
         RowBox[{"K", ".", 
          RowBox[{"(", 
           RowBox[{"z", "-", 
            RowBox[{"A", ".", "x"}]}], ")"}]}]}], ",", 
        RowBox[{"L", ".", "P"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["kalFit",
      Background->RGBColor[1, 1, 0]], "[", 
     RowBox[{"\[Sigma]zSquared_", ",", "\[Sigma]xSquared_"}], "]"}], "[", 
    RowBox[{"order_", ",", "trainingSet_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xs", "=", 
        RowBox[{
        "trainingSet", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"ys", "=", 
        RowBox[{
        "trainingSet", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aPrioriModel", "=", 
          RowBox[{"List", "/@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"order", "+", "1"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"aPrioriCovariance", "=", 
          RowBox[{"\[Sigma]xSquared", "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"order", "+", "1"}], "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        StyleBox["Fold",
         Background->RGBColor[1, 1, 0]], "[", 
        RowBox[{
         RowBox[{
          StyleBox["kalmanUpdate",
           Background->RGBColor[1, 1, 0]], "[", 
          RowBox[{"\[Sigma]zSquared", "*", 
           RowBox[{"IdentityMatrix", "[", "1", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"aPrioriModel", ",", "aPrioriCovariance"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"List", "/@", "ys"}], ",", 
            RowBox[{"List", "/@", 
             RowBox[{"partialsFn", "[", 
              RowBox[{"order", ",", "xs"}], "]"}]}]}], "}"}], 
          "\[Transpose]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.727913455235773*^9, 3.727913522283977*^9}, 
   3.727913696290469*^9, {3.727913736480159*^9, 3.727913844376683*^9}, {
   3.727917392534089*^9, 3.727917436971686*^9}, {3.727917505035927*^9, 
   3.727917528745805*^9}, {3.727917565263034*^9, 3.727917689094305*^9}, {
   3.727917745897264*^9, 3.7279177578567343`*^9}, {3.727917794603846*^9, 
   3.727917832787274*^9}, 3.727917880971725*^9, {3.727917936171432*^9, 
   3.727918023146969*^9}, {3.727918153331463*^9, 3.727918275269082*^9}, {
   3.727918376669937*^9, 3.727918414049831*^9}, {3.727918508981811*^9, 
   3.727918529673747*^9}, {3.727918590013206*^9, 3.727918649485745*^9}, {
   3.727918701604838*^9, 3.727918748563583*^9}, {3.727919051486678*^9, 
   3.727919074926166*^9}, {3.7279191082942677`*^9, 3.7279191590963287`*^9}, {
   3.7279192864475107`*^9, 3.727919323121303*^9}, {3.727919354826254*^9, 
   3.727919508497794*^9}, {3.727919541340006*^9, 3.727919683877797*^9}, {
   3.727920118873128*^9, 3.7279202093625507`*^9}, {3.727921237681443*^9, 
   3.727921317118623*^9}, {3.7279213549874077`*^9, 3.727921369577837*^9}, {
   3.727921727194334*^9, 3.727921729479971*^9}, {3.727921764122665*^9, 
   3.727921833477203*^9}, {3.72792411169958*^9, 3.727924167792699*^9}, {
   3.72792422895082*^9, 3.727924231141032*^9}, {3.72792438065587*^9, 
   3.7279243990664377`*^9}, {3.727925449102767*^9, 3.7279255631525297`*^9}, {
   3.72792560570716*^9, 3.7279256061694813`*^9}, {3.7279681913170443`*^9, 
   3.727968211031343*^9}, 3.728167450131751*^9, {3.72816963059844*^9, 
   3.728169630606372*^9}},ExpressionUUID->"c749088c-04f5-4907-b9ca-\
fb49efa60f35"],

Cell[TextData[{
 "The following interactive demonstration shows all three methods, ",
 Cell[BoxData[
  FormBox["mleFit", TraditionalForm]], "Code",ExpressionUUID->
  "4cb84eca-55a6-402e-87b6-60cd967b9f5b"],
 " (normal equations), ",
 Cell[BoxData[
  FormBox["rlsFit", TraditionalForm]], "Code",ExpressionUUID->
  "32d5863c-f1e1-40c4-9b5d-481484f253d0"],
 " (recurrent least squares), and ",
 Cell[BoxData[
  FormBox["kalFit", TraditionalForm]], "Code",ExpressionUUID->
  "1a3bf1c2-c6f4-4897-8186-d26fb9573d41"],
 " (Kalman folding) on Bishop\[CloseCurlyQuote]s training set.\n\nWhen the \
a-priori information matrix in RLS is ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", 
    RowBox[{"-", "6"}]], TraditionalForm]],ExpressionUUID->
  "f6fa54ad-2bf3-49fc-8f51-d6ac554275e8"],
 ", and when the a-priori covariance of the a-priori estimate in the Kalman \
filter is ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", "6"], TraditionalForm]],ExpressionUUID->
  "b5f6a42b-8214-43eb-b532-b23cb54f2a71"],
 ", both produce regularized estimates of the coefficients of high-order \
polynomial fits to the sine wave. In contrast, the MLE over-fits a ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["9", "th"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "df6e2ce4-ee21-4852-9304-c5350f92ab2f"],
 "-order polynomial by interpolating (going through) every data point because \
a ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["9", "th"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6ea035c7-661b-4906-ba49-314a63a809b6"],
 "-order polynomial fits the sample of ten data points exactly: the normal \
equations are neither overdetermined nor underdetermined at order nine, but \
accidentally constitute an exactly solvable linear system.\n\nIncreasing ",
 Cell[BoxData[
  FormBox["logMinInfo", TraditionalForm]], "Code",ExpressionUUID->
  "61902d13-4626-4d5f-8830-5b0bd423956c"],
 " ",
 StyleBox["decreases",
  FontSlant->"Italic"],
 " the magnitude of the a-priori information matrix in RLS. Increasing ",
 Cell[BoxData[
  FormBox["logSigmaXSquared", TraditionalForm]], "Code",ExpressionUUID->
  "c17d11ea-e11e-4a64-bf08-fb5cc88187e6"],
 " ",
 StyleBox["increases",
  FontSlant->"Italic"],
 " the magnitude of the covariance of the a-priori in the Kalman fold. \
Eventually, they both over-fit the data completely and align with MLE. See \
this by running the polynomial order up to nine, then ",
 Cell[BoxData[
  FormBox["logMinInfo", TraditionalForm]], "Code",
  FormatType->"TraditionalForm",ExpressionUUID->
  "a0f39e4c-2db3-415b-a534-44240dd6e6ec"],
 " and ",
 Cell[BoxData[
  FormBox["logSigmaXSquared", TraditionalForm]], "Code",
  FormatType->"TraditionalForm",ExpressionUUID->
  "2b542e52-8384-4059-9874-7f53c5d64849"],
 " all the way to the right, to their maximum values. \n\nThe call of ",
 Cell[BoxData[
  FormBox["rlsFit", TraditionalForm]], "Code",ExpressionUUID->
  "a8e5f9b1-11ce-494d-9d7f-8b45600c3817"],
 " is wrapped in ",
 Cell[BoxData[
  FormBox["Quiet", TraditionalForm]], "Code",ExpressionUUID->
  "ad5998a9-a4db-4090-82a8-edd9a2dedc9d"],
 ", which suppresses warnings about the initial ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalLambda]", "0"], TraditionalForm]],ExpressionUUID->
  "0c2d5a48-00be-4a64-a1b7-8446dceeea08"],
 "\[CloseCurlyQuote]s being ill-conditioned as its magnitude decreases. In \
real-world applications, such warnings would presage over-fitting and would \
be very useful. They\[CloseCurlyQuote]re suppressed here so as not to disrupt \
interactive exploration by the reader. "
}], "Text",
 CellChangeTimes->{{3.7279256244544373`*^9, 3.727925742876566*^9}, {
  3.7279258039092703`*^9, 3.7279259128523207`*^9}, {3.727925954204262*^9, 
  3.7279259564620657`*^9}, {3.7279654626277122`*^9, 3.7279654807910748`*^9}, {
  3.727968105688496*^9, 3.727968125215341*^9}, {3.727968236201902*^9, 
  3.7279684314126177`*^9}, {3.727968484938046*^9, 3.7279686043965883`*^9}, {
  3.727968757922451*^9, 3.727968936083672*^9}, {3.727969082971343*^9, 
  3.727969104861555*^9}, {3.727969240932012*^9, 3.727969326457324*^9}, {
  3.727970808785646*^9, 3.727970809672098*^9}, {3.727971463648671*^9, 
  3.727971590802065*^9}, {3.728084589559142*^9, 3.7280846923034363`*^9}, {
  3.7280907257948713`*^9, 3.728090725804418*^9}, {3.728169612532186*^9, 
  3.7281697768973846`*^9}, {3.728219862585387*^9, 3.728219953479074*^9}, {
  3.72825224029967*^9, 
  3.728252251361467*^9}},ExpressionUUID->"06b04a89-079d-4835-a22c-\
650fe407c905"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"gensym", ":", " ", 
       RowBox[{"fresh", " ", "variable", " ", "name"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"terms", "=", 
          RowBox[{"symbolicPowers", "[", 
           RowBox[{"x", ",", "order"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"cs", "=", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "order", "]"}], "/@", 
           RowBox[{"List", "/@", 
            RowBox[{
            "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"recurrent", "=", 
            RowBox[{"Quiet", "@", 
             RowBox[{
              RowBox[{"rlsFit", "[", 
               SuperscriptBox["10", 
                RowBox[{"-", "logMinInfo"}]], "]"}], "[", 
              RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"normal", "=", 
            RowBox[{"mleFit", "[", 
             RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"kalman", "=", 
            RowBox[{
             RowBox[{"kalFit", "[", 
              RowBox[{
               SuperscriptBox["bishopFakeSigma", "2"], ",", 
               SuperscriptBox["10", "logSigmaXSquared"]}], "]"}], "[", 
             RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rlsFn", "=", 
              RowBox[{
               RowBox[{"{", "terms", "}"}], ".", 
               RowBox[{
               "recurrent", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mleFn", "=", 
              RowBox[{"terms", ".", "normal"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"kalFn", "=", 
              RowBox[{
               RowBox[{"{", "terms", "}"}], ".", 
               RowBox[{
               "kalman", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"lp", "=", 
               RowBox[{"ListPlot", "[", 
                RowBox[{
                 RowBox[{"bishopTrainingSet", "\[Transpose]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PlotMarkers", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Graphics", "@", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
                    "}"}]}], ",", ".05"}], "}"}]}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"showlist", "=", 
                 RowBox[{"{", 
                  RowBox[{"lp", ",", 
                   RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox[
                    RowBox[{"Sin", "[", 
                    RowBox[{"2.", "\[Pi]", " ", "x"}], "]"}],
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0.", ",", "1."}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", 
                    StyleBox["Green",
                    Background->RGBColor[1, 1, 0]]}], "}"}]}]}], "]"}]}], 
                  "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"recurrentQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["rlsFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Purple",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"normalQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["mleFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Orange",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"kalmanQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["kalFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Cyan",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"Show", "[", 
                  RowBox[{"showlist", ",", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<x\>\"", ",", "\"\<t\>\""}], "}"}]}]}], 
                  "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"recurrentQ", ",", "True", ",", "\"\<RLS\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"kalmanQ", ",", "True", ",", "\"\<KAL\>\""}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"normalQ", ",", "True", ",", "\"\<MLE\>\""}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "}"}], "}"}], ",", 
          RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], ",", "\"\<\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"order", ",", "9", ",", "\"\<polynomial order\>\""}], 
            "}"}], ",", "0", ",", "16", ",", "1", ",", 
           RowBox[{"Appearance", "\[Rule]", 
            RowBox[{"{", "\"\<Labeled\>\"", "}"}]}]}], "}"}], "]"}], ",", 
        "\"\<\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "logMinInfo", ",", "3", ",", "\"\<-log a-priori info (RLS)\>\""}], 
           "}"}], ",", "0", ",", "16", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "logSigmaXSquared", ",", "3", ",", 
            "\"\<log a-priori cov (KAL)\>\""}], "}"}], ",", "0", ",", "16", 
          ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.727884681931381*^9, 3.7278848244947367`*^9}, 
   3.727884861217602*^9, {3.727884975910451*^9, 3.7278849940673532`*^9}, {
   3.727885103521431*^9, 3.727885154698123*^9}, {3.72788520225443*^9, 
   3.727885279820177*^9}, {3.727885496115718*^9, 3.727885517688189*^9}, {
   3.72788559395383*^9, 3.727885598972475*^9}, {3.7278856296542664`*^9, 
   3.727885630876935*^9}, {3.727885695972756*^9, 3.727885696864628*^9}, {
   3.727886633660364*^9, 3.72788671287046*^9}, {3.727886975364171*^9, 
   3.727886975439041*^9}, {3.727903476653379*^9, 3.7279034819231358`*^9}, {
   3.727903531862627*^9, 3.727903539245574*^9}, 3.727913149489944*^9, {
   3.727915429732944*^9, 3.7279154437948627`*^9}, {3.727915750998211*^9, 
   3.7279158447033873`*^9}, {3.7279213832695303`*^9, 3.72792149154887*^9}, {
   3.727921523149373*^9, 3.72792161270367*^9}, {3.72792165300301*^9, 
   3.727921654632832*^9}, {3.727921753282296*^9, 3.727921753360197*^9}, {
   3.727924008558401*^9, 3.727924045018003*^9}, {3.727924293814445*^9, 
   3.727924370827516*^9}, 3.727965590613636*^9, {3.7279686551525917`*^9, 
   3.727968670349081*^9}, {3.7279689406605043`*^9, 3.727969019631563*^9}, {
   3.727970883056108*^9, 3.727970945128386*^9}, {3.727971005813472*^9, 
   3.727971023734253*^9}, {3.727990640753121*^9, 3.727990674786282*^9}, {
   3.727990711779483*^9, 3.727990808626033*^9}, {3.727991307012423*^9, 
   3.727991307022031*^9}, {3.7279932412769613`*^9, 3.7279932949280367`*^9}, {
   3.7279933910397243`*^9, 3.727993398358789*^9}, {3.727993778490755*^9, 
   3.72799379332897*^9}, {3.727993826040863*^9, 3.7279938751552763`*^9}, {
   3.727993956673335*^9, 3.727993958184173*^9}, 3.727994128012043*^9, {
   3.7280354067714148`*^9, 3.7280354258611927`*^9}, {3.728035634299762*^9, 
   3.728035732029833*^9}, {3.72803585641748*^9, 3.728035906176405*^9}, {
   3.728038924314391*^9, 3.728039041653799*^9}, {3.728039077026232*^9, 
   3.72803913265169*^9}, {3.728039194847865*^9, 3.728039320044661*^9}, {
   3.728044256958378*^9, 3.728044343151896*^9}, {3.728044393583234*^9, 
   3.728044466540698*^9}, 3.7280447095836163`*^9, {3.728044856722988*^9, 
   3.728044959527645*^9}, {3.728044995179022*^9, 3.728044998104682*^9}, {
   3.728045028753289*^9, 3.728045063548128*^9}, {3.728045464570526*^9, 
   3.728045476328084*^9}, {3.728045812340419*^9, 3.728045836978776*^9}, {
   3.7280461335391397`*^9, 3.728046355530389*^9}, {3.728046392282709*^9, 
   3.728046397281275*^9}, {3.728046429888109*^9, 3.728046434285967*^9}, {
   3.728046509047914*^9, 3.728046577986915*^9}, {3.728048625582951*^9, 
   3.728048658147644*^9}, {3.728048704639155*^9, 3.7280487209829884`*^9}, {
   3.728048763333255*^9, 3.728048783520523*^9}, 3.728048849900649*^9, {
   3.728048881350296*^9, 3.7280488887365723`*^9}, {3.7280489358794527`*^9, 
   3.728048947834031*^9}, {3.7280492952517767`*^9, 3.728049427179392*^9}, {
   3.728049506853256*^9, 3.7280496162697783`*^9}, {3.728049702949929*^9, 
   3.728049708359687*^9}, {3.7280497561537037`*^9, 3.728049819625853*^9}, {
   3.728049930158724*^9, 3.728049930640306*^9}, {3.728089854705469*^9, 
   3.728089855621914*^9}, {3.728090725808407*^9, 3.7280907258189697`*^9}, {
   3.728169349695664*^9, 3.728169349720875*^9}, {3.7281694009815397`*^9, 
   3.7281694178910418`*^9}, {3.728169511786654*^9, 3.7281695237214537`*^9}, {
   3.728169612536371*^9, 3.728169630625689*^9}, 
   3.72825398263583*^9},ExpressionUUID->"c4e105a8-45dc-4fcb-92a7-\
048117eb1b0a"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`kalmanQ$$ = 
    True, $CellContext`logMinInfo$$ = 3, $CellContext`logSigmaXSquared$$ = 
    3, $CellContext`normalQ$$ = True, $CellContext`order$$ = 
    9, $CellContext`recurrentQ$$ = True, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`recurrentQ$$], True, "RLS"}, {True, False}}, {{
       Hold[$CellContext`kalmanQ$$], True, "KAL"}, {True, False}}, {{
       Hold[$CellContext`normalQ$$], True, "MLE"}, {True, False}}, {{
       Hold[$CellContext`order$$], 9, "polynomial order"}, 0, 16, 1}, {{
       Hold[$CellContext`logMinInfo$$], 3, "-log a-priori info (REC)"}, 0, 
      16}, {{
       Hold[$CellContext`logSigmaXSquared$$], 3, "log a-priori cov (KAL)"}, 0,
       16}, {
      Hold[
       Grid[{{
          Grid[{{
             Manipulate`Place[1], 
             Manipulate`Place[2], 
             Manipulate`Place[3]}}, Frame -> All], ""}, {
          Manipulate`Place[4], ""}, {
          Manipulate`Place[5]}, {
          Manipulate`Place[6]}}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {540., {168., 175.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`recurrentQ$2809$$ = 
    False, $CellContext`kalmanQ$2810$$ = False, $CellContext`normalQ$2811$$ = 
    False, $CellContext`order$2812$$ = 0, $CellContext`logMinInfo$2813$$ = 
    0, $CellContext`logSigmaXSquared$2814$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`kalmanQ$$ = 
        True, $CellContext`logMinInfo$$ = 3, $CellContext`logSigmaXSquared$$ = 
        3, $CellContext`normalQ$$ = True, $CellContext`order$$ = 
        9, $CellContext`recurrentQ$$ = True}, "ControllerVariables" :> {
        Hold[$CellContext`recurrentQ$$, $CellContext`recurrentQ$2809$$, 
         False], 
        Hold[$CellContext`kalmanQ$$, $CellContext`kalmanQ$2810$$, False], 
        Hold[$CellContext`normalQ$$, $CellContext`normalQ$2811$$, False], 
        Hold[$CellContext`order$$, $CellContext`order$2812$$, 0], 
        Hold[$CellContext`logMinInfo$$, $CellContext`logMinInfo$2813$$, 0], 
        Hold[$CellContext`logSigmaXSquared$$, \
$CellContext`logSigmaXSquared$2814$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Module[{$CellContext`x$}, 
        With[{$CellContext`terms$ = \
$CellContext`symbolicPowers[$CellContext`x$, $CellContext`order$$], \
$CellContext`cs$ = Map[
            $CellContext`\[Phi][$CellContext`order$$], 
            Map[List, 
             Part[$CellContext`bishopTrainingSet, 1]]]}, 
         With[{$CellContext`recurrent$ = Quiet[
             $CellContext`rlsFit[
             10^(-$CellContext`logMinInfo$$)][$CellContext`order$$, \
$CellContext`bishopTrainingSet]], $CellContext`normal$ = \
$CellContext`mleFit[$CellContext`order$$, $CellContext`bishopTrainingSet], \
$CellContext`kalman$ = $CellContext`kalFit[$CellContext`bishopFakeSigma^2, 
             10^$CellContext`logSigmaXSquared$$][$CellContext`order$$, \
$CellContext`bishopTrainingSet]}, 
          With[{$CellContext`rlsFn$ = Dot[{$CellContext`terms$}, 
              Part[$CellContext`recurrent$, 1]], $CellContext`mleFn$ = 
            Dot[$CellContext`terms$, $CellContext`normal$], \
$CellContext`kalFn$ = Dot[{$CellContext`terms$}, 
              Part[$CellContext`kalman$, 1]]}, 
           With[{$CellContext`lp$ = ListPlot[
               Transpose[$CellContext`bishopTrainingSet], PlotMarkers -> {
                 Graphics[{Blue, 
                   Circle[{0, 0}, 1]}], 0.05}]}, 
            Module[{$CellContext`showlist$ = {$CellContext`lp$, 
                Plot[
                 Sin[2. Pi $CellContext`x$], {$CellContext`x$, 0., 1.}, 
                 PlotStyle -> {Thick, Green}]}}, If[$CellContext`recurrentQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`rlsFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Purple}]]]; If[$CellContext`normalQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`mleFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Orange}]]]; If[$CellContext`kalmanQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`kalFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Cyan}]]]; Quiet[
               
               Show[$CellContext`showlist$, Frame -> True, 
                FrameLabel -> {"x", "t"}]]]]]]]], 
      "Specifications" :> {{{$CellContext`recurrentQ$$, True, "RLS"}, {
         True, False}, ControlPlacement -> 
         1}, {{$CellContext`kalmanQ$$, True, "KAL"}, {True, False}, 
         ControlPlacement -> 2}, {{$CellContext`normalQ$$, True, "MLE"}, {
         True, False}, ControlPlacement -> 
         3}, {{$CellContext`order$$, 9, "polynomial order"}, 0, 16, 1, 
         Appearance -> {"Labeled"}, ControlPlacement -> 
         4}, {{$CellContext`logMinInfo$$, 3, "-log a-priori info (REC)"}, 0, 
         16, Appearance -> "Labeled", ControlPlacement -> 
         5}, {{$CellContext`logSigmaXSquared$$, 3, "log a-priori cov (KAL)"}, 
         0, 16, Appearance -> "Labeled", ControlPlacement -> 6}, 
        Grid[{{
           Grid[{{
              Manipulate`Place[1], 
              Manipulate`Place[2], 
              Manipulate`Place[3]}}, Frame -> All], ""}, {
           Manipulate`Place[4], ""}, {
           Manipulate`Place[5]}, {
           Manipulate`Place[6]}}]}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{606., {281., 290.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.728049786688733*^9, 3.728049822531087*^9}, 
   3.728049932058367*^9, 3.728066471191676*^9, 3.728068121508601*^9, 
   3.728083784765584*^9, 3.72808470524475*^9, 3.728086257713619*^9, 
   3.728089858368235*^9, 3.728090742808566*^9, {3.728169431738031*^9, 
   3.7281694464424143`*^9}, 3.728169541659259*^9, {3.728169797226727*^9, 
   3.728169823961609*^9}, 3.728169884020693*^9, 3.728219984468186*^9, {
   3.728252274311805*^9, 3.728252290547639*^9}, 
   3.728252956478456*^9},ExpressionUUID->"d6a96b84-0803-42cc-9156-\
c6668da9e310"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regularization and MAP", "Chapter",
 CellChangeTimes->{{3.727878613935317*^9, 3.727878617609169*^9}},
 CellTags->"c:14",ExpressionUUID->"5e146fa3-c774-454c-9d58-41c7d064f607"],

Cell[TextData[{
 "Bishop reports ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "=", 
    RowBox[{"11.111", "\[Ellipsis]"}]}], TraditionalForm]],ExpressionUUID->
  "8e22fb9c-13dd-4596-83d2-17c772c852a1"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "=", "0.005"}], TraditionalForm]],ExpressionUUID->
  "9439b565-4e31-4d22-ae02-3f68785439e4"],
 " in his figure 1.17 (page 32). These hyperparameters appear in his \
equations 1.70 through 1.72 (page 31), which look suspiciously like the \
equations for Kalman filtering. ",
 Cell[BoxData[
  FormBox["\[Beta]", TraditionalForm]],ExpressionUUID->
  "ed175d14-7e7c-4496-8171-f7750f5d9614"],
 " purports to be ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", 
    SubsuperscriptBox["\[Sigma]", "w", "2"]}], TraditionalForm]],
  ExpressionUUID->"dc1cb077-8bd2-433e-9efc-630e62c37f53"],
 ", implying a-priori uncertainty in the estimated parameters ",
 Cell[BoxData[
  FormBox["w", TraditionalForm]],ExpressionUUID->
  "1fe716dd-0841-46f1-920e-16d806f2570e"],
 " is ",
 Cell[BoxData[
  FormBox["0.30", TraditionalForm]],ExpressionUUID->
  "697259c5-bf95-47ef-a757-0773ade7e9fb"],
 ", suspiciously like the observation noise we guessed to create the fake \
training set, but on the parameters rather than on the observations: in the \
wrong place. Paradoxically, \[Alpha] appears in equation 1.72 precisely where \
we would expect observation noise because Bishop\[CloseCurlyQuote]s matrix ",
 Cell[BoxData[
  FormBox[
   StyleBox["S",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "15229e6b-eefa-48a8-80b0-df50abb6726b"],
 StyleBox[" looks just like ",
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["D",
     FontWeight->"Bold"], 
    RowBox[{"\[ThinSpace]", 
     RowBox[{"-", "1"}]}]], TraditionalForm]],ExpressionUUID->
  "1c5226ee-b619-4054-a482-ddd3e76e3691"],
 " in ",
 Cell[BoxData[
  FormBox["kalmanUpdate", TraditionalForm]], "Code",ExpressionUUID->
  "de857dd2-14f7-46ca-88a7-ba75c4137d1c"],
 " above. This observation noise is much too small to reproduce his figure \
1.7 (page 10), so we have some work to do to confirm or refute our \
reconstructions."
}], "Item",
 CellChangeTimes->{{3.727971621209344*^9, 3.727971949635846*^9}, {
  3.72797205224653*^9, 3.7279722021279373`*^9}, {3.7279725817509613`*^9, 
  3.727972703314744*^9}, {3.7280847454753532`*^9, 3.728084792840749*^9}, {
  3.728220011630794*^9, 3.7282200748560743`*^9}, {3.728252317415781*^9, 
  3.728252334400373*^9}},ExpressionUUID->"fa95364b-3015-47fe-be85-\
da9e24be961b"],

Cell[CellGroupData[{

Cell["Bishop\[CloseCurlyQuote]s MAP", "Subchapter",
 CellChangeTimes->{{3.72797221730235*^9, 3.727972224770916*^9}, {
  3.728034928939948*^9, 3.7280349304923964`*^9}},
 CellTags->"c:15",ExpressionUUID->"d7a304fb-6f9f-4c41-9967-80276318fb81"],

Cell[TextData[{
 "Bishop\[CloseCurlyQuote]s equations 1.70 through 1.72 are reproduced here. \
Bishop calls the order of the polynomial ",
 Cell[BoxData[
  FormBox["\[CapitalMu]", TraditionalForm]],ExpressionUUID->
  "4a03bb81-7e57-437e-91ca-c7d42f9e9192"],
 ", and it\[CloseCurlyQuote]s mostly implicit in his treatment. We explicitly \
note that the dimensions of the identity matrix in the definition of ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "1eacf56a-a8d9-4664-995f-125386c0e309"],
 " is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalMu]", "+", "1"}], TraditionalForm]],ExpressionUUID->
  "3ce7d474-d9b6-4b6b-9a80-613654c0eeeb"],
 ", where ",
 Cell[BoxData[
  FormBox["\[CapitalMu]", TraditionalForm]],ExpressionUUID->
  "5120e51b-c864-42ac-a6ed-b95ded545421"],
 " is the order of the polynomial:"
}], "Text",
 CellChangeTimes->{{3.727972249677867*^9, 3.727972263698797*^9}, {
  3.727992395654808*^9, 3.7279924502184677`*^9}, {3.7281700269116917`*^9, 
  3.7281700419010553`*^9}, {3.728170120216963*^9, 
  3.728170134209874*^9}},ExpressionUUID->"a1373b67-87a8-4e47-914b-\
7d73c812048e"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"m", "(", "x", ")"}], "  ", "=", "  ", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "\[ThinSpace]", "(", "x", ")"}], "\[Transpose]"}], 
     "\[CenterDot]", "S", "\[CenterDot]", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"n", "=", "1"}], "N"], 
      RowBox[{
       RowBox[{"\[Phi]", "\[ThinSpace]", "(", 
        SubscriptBox["x", "n"], ")"}], 
       SubscriptBox["t", "n"]}]}]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.727972280222818*^9, 3.7279724431858997`*^9}, {
  3.727972476930735*^9, 3.727972478697866*^9}, {3.7279730887912483`*^9, 
  3.7279731267447147`*^9}},ExpressionUUID->"4bd20e37-6329-4716-aede-\
ab9a4bb004af"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["s", "2"], "(", "x", ")"}], "  ", "=", "  ", 
   RowBox[{
    SuperscriptBox["\[Beta]", 
     RowBox[{"\[ThinSpace]", 
      RowBox[{"-", "1"}]}]], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "\[ThinSpace]", "(", "x", ")"}], "\[Transpose]"}], 
     "\[CenterDot]", "S", "\[CenterDot]", 
     RowBox[{"\[Phi]", "\[ThinSpace]", "(", "x", ")"}]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7279724613260727`*^9, 3.727972528960863*^9}, {
  3.727972730192233*^9, 3.727972730194661*^9}, {3.727973130733033*^9, 
  3.727973133972931*^9}},ExpressionUUID->"6a26e095-6cef-4d4a-8e37-\
4258853e6c55"],

Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox["S", 
    RowBox[{"\[ThinSpace]", 
     RowBox[{"-", "1"}]}]], "  ", 
   OverscriptBox["=", "def"], "  ", 
   RowBox[{
    RowBox[{"\[Alpha]", " ", 
     SubscriptBox["I", 
      RowBox[{"\[CapitalMu]", "+", "1"}]]}], "+", 
    RowBox[{"\[Beta]", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"n", "=", "1"}], "N"], 
      RowBox[{
       RowBox[{"\[Phi]", "\[ThinSpace]", "(", 
        SubscriptBox["x", "n"], ")"}], "\[CenterDot]", 
       RowBox[{
        RowBox[{"\[Phi]", "\[ThinSpace]", "(", 
         SubscriptBox["x", "n"], ")"}], "\[Transpose]"}]}]}]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.72797275156035*^9, 3.727972881609983*^9}, {
  3.727973139344582*^9, 3.727973142448781*^9}, {3.727992385246423*^9, 
  3.727992388437778*^9}},ExpressionUUID->"b4829aab-42a8-4965-b9c1-\
9029eacf7ef2"],

Cell["\<\
Here are links between Bishop\[CloseCurlyQuote]s formulation and ours, \
without derivation. \
\>", "Text",
 CellChangeTimes->{{3.728247291344137*^9, 3.728247310423942*^9}, {
  3.728248735711397*^9, 
  3.7282487376877623`*^9}},ExpressionUUID->"72722f2c-a866-4d8a-a437-\
bfa3bd35b363"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"n", "=", "1"}], "N"], 
    RowBox[{
     RowBox[{"\[Phi]", "\[ThinSpace]", "(", 
      SubscriptBox["x", "n"], ")"}], 
     SubscriptBox["t", "n"]}]}], "=", 
   RowBox[{
    RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "\[CapitalZeta]"}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.728246767415718*^9, 3.728246838582246*^9}, {
  3.728246899084139*^9, 3.72824690103373*^9}, {3.728247197825539*^9, 
  3.728247228753024*^9}, {3.728247278577318*^9, 
  3.72824728616096*^9}},ExpressionUUID->"0d63a741-69a7-4583-819a-\
f44290a892ab"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    UnderscriptBox["lim", 
     RowBox[{"\[Alpha]", "\[Rule]", "0"}]], 
    RowBox[{"(", "\[ThinSpace]", 
     RowBox[{
      SuperscriptBox["\[Beta]", 
       RowBox[{"\[ThinSpace]", 
        RowBox[{"-", "1"}]}]], 
      SuperscriptBox["S", 
       RowBox[{"\[ThinSpace]", 
        RowBox[{"-", "1"}]}]]}], ")"}]}], "=", 
   RowBox[{
    RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "A"}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.728247724107789*^9, 
  3.728247835449356*^9}},ExpressionUUID->"04593f6e-4865-45dc-bc8d-\
43e21089c41e"],

Cell["\<\
We should be able to force MAP to over-fit by driving \[Alpha] to zero: let\
\[CloseCurlyQuote]s show that.\
\>", "Text",
 CellChangeTimes->{{3.72825107248142*^9, 3.72825110248771*^9}, {
  3.7282523898942842`*^9, 
  3.7282523933273907`*^9}},ExpressionUUID->"8e953d86-60d7-48d5-b106-\
44b48a5aa475"],

Cell[CellGroupData[{

Cell["\[CapitalPhi] Vectors", "Subsection",
 CellChangeTimes->{{3.728246200325514*^9, 
  3.72824620633247*^9}},ExpressionUUID->"dea6cd0e-61dc-4fcb-bb23-\
b7ec71000edf"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "\[ThinSpace]", "(", 
    SubscriptBox["x", "n"], ")"}], TraditionalForm]],ExpressionUUID->
  "d0357893-7a34-47d5-b9df-6d65e4cd6db3"],
 " is a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"\[CapitalMu]", "+", "1"}], ")"}], TraditionalForm]],
  ExpressionUUID->"be18f1f6-fa19-4618-85e4-a7b0798c19b0"],
 "-column vector of the powers of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "a695a214-da64-4bf6-9e54-8c1109d67926"],
 " input ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "n"], TraditionalForm]],ExpressionUUID->
  "a592915b-b190-4cca-a80f-fa0eb5f0f7b6"],
 ". ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "\[ThinSpace]", "(", 
    SubscriptBox["x", "n"], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "c73c1dda-88c8-44a2-92c1-fc534674e49f"],
 " is the dual of one row co-vector of our partials. The co-vector form is \
better, but we\[CloseCurlyQuote]ll stick with Bishop\[CloseCurlyQuote]s \
definitions for his expressions.\n\nAs written, these equations are \
non-recurrent, requiring all data ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["t", "n"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "8c93d51c-82cf-4849-9217-6ca946a75539"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "\[ThinSpace]", "(", 
    SubscriptBox["x", "n"], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "a73423ff-d81a-49db-8ce5-8bf4b609f34c"],
 ", and requiring inversion of matrix ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "883351be-2cb8-44c7-a551-6e0d6beceae2"],
 ". They thus suffer from all the operational ills of the normal equations. \n\
\nDo not use the promiscuous form of column vector as a one-level list; map \
",
 Cell[BoxData[
  FormBox["List", TraditionalForm]], "Code",ExpressionUUID->
  "cd3da0ea-40f3-4b11-802c-d41702362414"],
 " over the training data to convert them to column vectors, as above. \
Quietly map indeterminate ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["0", "0"], TraditionalForm]],ExpressionUUID->
  "191ea3b8-abf9-4d03-bbf0-ce911986ca19"],
 " to 1. The count of the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "\[ThinSpace]", "(", 
    SubscriptBox["x", "n"], ")"}], TraditionalForm]],ExpressionUUID->
  "28063bed-8959-46d5-b543-1d3e87fbfa5e"],
 " is the number of data, Bishop\[CloseCurlyQuote]s ",
 Cell[BoxData[
  FormBox["\[CapitalNu]", TraditionalForm]],ExpressionUUID->
  "98f8ebf4-0d70-4492-92d5-93c7d5807c1b"],
 "."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ3T9rq0f3sdeOMzjvRIFonQ3JySC6IfxuCojednxX
DoiWWGyVC6Kv+30pA9E7Nha2gmizDWHTQfQt3dnzQfT617cXg2iWusglIFpQ
eukFEJ3azXMFRPuddHkFonu7RD+A6EVbPP+A6A4Di/8gWiZzG2sPkH5Tm88J
ou3mvZGcAqQ/PD+gCKI1v5cuAtERXDVgesbROxdB9G6NSTdANDuXypSVQFrj
1NbpILqqI+vtQZA7SxQ/gGj/RQ+/guh/aUwih4D0O4WcrtdAOi7TcQKIdjrf
Ox1Ec+yeNg9EH5W5+4/5ONCd1fw8LEB6FoeJMDuQ1mgwFgfRv0Kb9gkD6Sln
v4NpAHM/vyI=
  "],ExpressionUUID->"d5d54705-3ca1-481a-8a3c-a7946ac99964"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\[Phi]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", "\[CapitalMu]_", "]"}], "[", "xn_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Quiet", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["xn", "i"], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "\[CapitalMu]"}], "}"}]}], "]"}]}], "/.", 
    
    RowBox[{"{", 
     RowBox[{"Indeterminate", "\[Rule]", "1"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{
   RowBox[{"\[Phi]", "[", "3", "]"}], "/@", 
   RowBox[{"List", "/@", 
    RowBox[{
    "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.727973167925046*^9, 3.7279732069191923`*^9}, {
   3.727973258420764*^9, 3.727973267473878*^9}, {3.727973429851573*^9, 
   3.727973456984548*^9}, {3.7279735073990107`*^9, 3.727973544918976*^9}, {
   3.727973599459084*^9, 3.727973603790498*^9}, {3.7279736372428493`*^9, 
   3.727973649545477*^9}, {3.72797372689071*^9, 3.7279737331067553`*^9}, {
   3.727973816644998*^9, 3.7279738168679523`*^9}, {3.72797400882194*^9, 
   3.7279740141305532`*^9}, {3.727974059584772*^9, 3.727974079989175*^9}, {
   3.727974139169652*^9, 3.727974144037814*^9}, {3.727974283500222*^9, 
   3.727974357586182*^9}, {3.7279743965807533`*^9, 3.727974431722498*^9}, {
   3.727974493179165*^9, 3.7279747668644867`*^9}, {3.727989252021517*^9, 
   3.727989259286603*^9}, {3.7279894297361*^9, 3.727989457309639*^9}, {
   3.72799130695959*^9, 3.727991323954713*^9}, {3.7279914092481813`*^9, 
   3.727991418823888*^9}, {3.727992110982379*^9, 3.727992136250567*^9}, 
   3.727992510695593*^9, 
   3.727993474811754*^9},ExpressionUUID->"99f156f3-5aac-4091-ae6a-\
b2a0740f6c9b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1"},
       {"0.`"},
       {"0.`"},
       {"0.`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`"},
       {"0.1111111111111111`"},
       {"0.012345679012345678`"},
       {"0.0013717421124828531`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`"},
       {"0.2222222222222222`"},
       {"0.04938271604938271`"},
       {"0.010973936899862825`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`"},
       {"0.3333333333333333`"},
       {"0.1111111111111111`"},
       {"0.037037037037037035`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`"},
       {"0.4444444444444444`"},
       {"0.19753086419753085`"},
       {"0.0877914951989026`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`"},
       {"0.5555555555555556`"},
       {"0.308641975308642`"},
       {"0.1714677640603567`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`"},
       {"0.6666666666666666`"},
       {"0.4444444444444444`"},
       {"0.2962962962962963`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`"},
       {"0.7777777777777777`"},
       {"0.6049382716049381`"},
       {"0.4705075445816184`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`"},
       {"0.8888888888888888`"},
       {"0.7901234567901234`"},
       {"0.7023319615912208`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`"},
       {"1.`"},
       {"1.`"},
       {"1.`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.72797476735454*^9, {3.727989442724881*^9, 3.7279894588380623`*^9}, {
   3.727991319054626*^9, 3.727991333268414*^9}, {3.727992119104147*^9, 
   3.727992136593679*^9}, 3.727992528933445*^9, 3.727993509509782*^9, 
   3.728044352739295*^9, 3.7280464487735233`*^9, 3.728066471393063*^9, 
   3.728068121686639*^9, 3.728083785006975*^9, 3.7280907429940033`*^9, 
   3.728169446568424*^9, 3.728169541724071*^9, 3.728169824254798*^9, 
   3.728169884294923*^9, 
   3.7282529567610817`*^9},ExpressionUUID->"055e1d65-9212-48bd-8b8e-\
2623c94228a8"]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "\[ThinSpace]", "(", "x", ")"}], TraditionalForm]],
  ExpressionUUID->"e9d763a7-1536-4450-980a-110e5b43ee8e"],
 ", as above, is the expansion into powers of a symbolic input, as a \
promiscuous vector:"
}], "Text",
 CellChangeTimes->{{3.7279737523122883`*^9, 3.727973784698271*^9}, {
  3.7279738191383057`*^9, 3.727973821477002*^9}, {3.727991134262012*^9, 
  3.727991135111849*^9}, {3.728252459702477*^9, 
  3.7282524743159924`*^9}},ExpressionUUID->"ff89db8f-c3ff-4e57-986c-\
d513b2d62400"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", "order", "]"}], "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "2"}], "}"}], ",", "0", ",", "16", ",", "1", ",", 
     
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.727973787694723*^9, 3.727973798238305*^9}, {
   3.727974070368301*^9, 3.727974074524324*^9}, {3.727989467011674*^9, 
   3.727989467199964*^9}, {3.7279921508961554`*^9, 3.727992188381691*^9}, 
   3.727993486680045*^9, 
   3.728035970063849*^9},ExpressionUUID->"60370d45-b4e1-4ea5-bbd8-\
a6a455088895"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`order$$ = 2, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`order$$], 2}, 0, 16, 1}}, Typeset`size$$ = {
    107., {8.1123046875, 18.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`order$3101$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`order$$ = 2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`order$$, $CellContext`order$3101$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`\[Phi][$CellContext`order$$][$CellContext`x], 
      "Specifications" :> {{{$CellContext`order$$, 2}, 0, 16, 1, Appearance -> 
         "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{455., {73., 82.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.727973799180683*^9, 3.727973822925476*^9}, 
   3.7279740831115923`*^9, 3.7279894681139383`*^9, 3.727991806956072*^9, {
   3.7279921480787973`*^9, 3.727992154579815*^9}, 3.727992188798922*^9, 
   3.727992532225689*^9, 3.728035970610588*^9, 3.7280443528033943`*^9, 
   3.7280464488245068`*^9, 3.728066471439478*^9, 3.7280681217326593`*^9, 
   3.7280837850638657`*^9, 3.728090743059054*^9, 3.7281694466260433`*^9, 
   3.728169541774767*^9, 3.728169824327393*^9, 3.728169884352015*^9, 
   3.728252956820094*^9},ExpressionUUID->"f3bba4d9-97ce-4320-bd7d-\
cafb8e0eab77"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["S Inverse", "Subsection",
 CellChangeTimes->{{3.7282461813905153`*^9, 
  3.728246183677311*^9}},ExpressionUUID->"a170c7f7-9c9e-48dd-8c1e-\
6477ea0eb26f"],

Cell[TextData[{
 "Produce the inverse of Bishop\[CloseCurlyQuote]s ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "0e796ce9-649b-4a54-9072-033728eae944"],
 " matrix, Bishop\[CloseCurlyQuote]s equation 1.72. Test symbolically:"
}], "Text",
 CellChangeTimes->{{3.727973854544991*^9, 3.727973958387879*^9}, {
  3.7279935391781883`*^9, 3.7279935616792603`*^9}, {3.7281702480246696`*^9, 
  3.7281702828359957`*^9}},ExpressionUUID->"91e51b52-f06d-4943-91cd-\
ba6e049f92a9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"sInv", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sInv", "[", 
    RowBox[{"\[Alpha]_", ",", "\[Beta]_", ",", "cs_", ",", "\[CapitalMu]_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalNu]", "=", 
       RowBox[{"Length", "[", "cs", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"\[CapitalMu]", "+", "1"}], "]"}]}], "+", 
      RowBox[{"\[Beta]", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "cs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ".", 
          RowBox[{
           RowBox[{
           "cs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[Transpose]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MatrixForm", "@", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cs", "=", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "order", "]"}], "/@", 
         RowBox[{"List", "/@", 
          RowBox[{
          "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"sInv", "[", 
       RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "cs", ",", "order"}], "]"}]}],
      "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "2"}], "}"}], ",", "0", ",", "16", ",", "1", ",", 
     
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.727973884729273*^9, 3.727973893707472*^9}, {
   3.727973967319463*^9, 3.727973981031104*^9}, {3.727974108227893*^9, 
   3.72797411197365*^9}, {3.7279741548510723`*^9, 3.72797416892636*^9}, {
   3.7279748009815598`*^9, 3.727974944132066*^9}, {3.727974978991621*^9, 
   3.727975013741935*^9}, {3.727975044573173*^9, 3.727975082061253*^9}, {
   3.727975179449038*^9, 3.727975183788499*^9}, {3.727989511270849*^9, 
   3.727989517784666*^9}, {3.7279913069753647`*^9, 3.727991306982168*^9}, {
   3.727991851964892*^9, 3.727992057554862*^9}, {3.727992211691082*^9, 
   3.7279923598616533`*^9}, 
   3.728035965335248*^9},ExpressionUUID->"62a89ce9-1583-43a8-9d1d-\
8cfb1f15e5d2"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`order$$ = 2, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`order$$], 2}, 0, 16, 1}}, Typeset`size$$ = {
    427., {30.7010498046875, 39.2989501953125}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`order$3124$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`order$$ = 2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`order$$, $CellContext`order$3124$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> MatrixForm[
        With[{$CellContext`cs$ = Map[
            $CellContext`\[Phi][$CellContext`order$$], 
            Map[List, 
             Part[$CellContext`bishopTrainingSet, 1]]]}, 
         $CellContext`sInv[$CellContext`\[Alpha], $CellContext`\[Beta], \
$CellContext`cs$, $CellContext`order$$]]], 
      "Specifications" :> {{{$CellContext`order$$, 2}, 0, 16, 1, Appearance -> 
         "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{493., {94., 103.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.727975082913224*^9, 3.727975184436255*^9, 3.7279895192911663`*^9, 
   3.727991373717016*^9, 3.727992047321735*^9, {3.727992252745247*^9, 
   3.727992285893422*^9}, {3.7279923158962507`*^9, 3.727992360788082*^9}, 
   3.727992537099002*^9, 3.727993119920138*^9, 3.7280359659180183`*^9, 
   3.728044352899605*^9, 3.728046448910995*^9, 3.728066471522068*^9, 
   3.7280681218122396`*^9, 3.728083785147791*^9, 3.7280907431418123`*^9, 
   3.728169446728086*^9, 3.728169541841404*^9, 3.7281698244487467`*^9, 
   3.728169884435246*^9, 
   3.728252956900285*^9},ExpressionUUID->"ae43f8dd-2f21-47c1-861d-\
ac1e43254e4c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MAP Mean", "Subsection",
 CellChangeTimes->{{3.7282462270238667`*^9, 
  3.7282462292069902`*^9}},ExpressionUUID->"07c893a6-acfe-4c67-be5a-\
3a54ec3e3d0e"],

Cell[TextData[{
 "Bishop\[CloseCurlyQuote]s equation 1.70. Slide ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["log", "10"], "\[Alpha]"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "d189cb7d-b1b9-4c8a-a37a-74a290136504"],
 " toward ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "\[Infinity]"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "9672b119-de9e-4250-b25c-3937f7ca8270"],
 " to see ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Beta]", 
     RowBox[{"\[ThinSpace]", 
      RowBox[{"-", "1"}]}]], 
    SuperscriptBox["S", 
     RowBox[{"\[ThinSpace]", 
      RowBox[{"-", "1"}]}]]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "54ce21f5-a095-44e2-979a-a7f18cac1a36"],
 " approach ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "\[Transpose]"}], "\[CenterDot]", "A"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "67afb717-704b-4ea8-9a8f-d6546fa90621"],
 " and MAP approach MLE."
}], "Text",
 CellChangeTimes->{{3.7279935722104673`*^9, 3.727993577636578*^9}, {
  3.728252554798936*^9, 
  3.728252645286251*^9}},ExpressionUUID->"24b0a5ae-c9e1-459d-84e9-\
7f863b2f9d7e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "mapMean", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mapMean", "[", 
    RowBox[{
    "\[Alpha]_", ",", "\[Beta]_", ",", "x_", ",", "cs_", ",", "ts_", ",", 
     "\[CapitalMu]_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalNu]", "=", 
        RowBox[{"Length", "@", "cs"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Beta]", "*", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "\[CapitalMu]", "]"}], "[", "x", "]"}]}], 
        "}"}], ".", 
       RowBox[{"(*", " ", 
        RowBox[{"row", " ", "of", " ", "partials"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"(*", " ", 
         RowBox[{"vector", " ", "of", " ", "coefficients"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sInv", "[", 
          RowBox[{
          "\[Alpha]", ",", "\[Beta]", ",", "cs", ",", "\[CapitalMu]"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"ts", ".", "cs"}]}], "]"}]}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], "\n", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ts", "=", 
        RowBox[{
        "bishopTrainingSet", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"cs", "=", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "order", "]"}], "/@", 
         RowBox[{"List", "/@", 
          RowBox[{
          "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"A", "=", 
        RowBox[{"partialsFn", "[", 
         RowBox[{"order", ",", 
          RowBox[{
          "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalZeta]", "=", 
         RowBox[{"List", "/@", "ts"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<MLE\>\"", ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"partialsFn", "[", 
                 RowBox[{"order", ",", 
                  RowBox[{"{", "x", "}"}]}], "]"}], ".", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"PseudoInverse", "[", "A", "]"}], ".", 
                  "\[CapitalZeta]"}], ")"}]}], ")"}], "\[LeftDoubleBracket]", 
              
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"the", " ", "product", " ", "is", " ", "associative"}], 
            ",", " ", 
            RowBox[{
            "but", " ", "might", " ", "need", " ", "a", " ", "Simplify"}]}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<MAP\>\"", ",", 
            RowBox[{"Quiet", "@", 
             RowBox[{"mapMean", "[", 
              RowBox[{
               SuperscriptBox["10", "log\[Alpha]"], ",", "\[Beta]", ",", "x", 
               ",", "cs", ",", "ts", ",", "order"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\!\(\*UnderoverscriptBox[\(\[Sum]\), \(n = 1\), \
\(N\)]\)\[Phi]\[ThinSpace](\!\(\*SubscriptBox[\(x\), \
\(n\)]\))\!\(\*SubscriptBox[\(t\), \(n\)]\) == A\[Transpose]\[CenterDot]\
\[CapitalZeta]\>\"", ",", 
            RowBox[{
             RowBox[{"ts", ".", "cs"}], "\[Equal]", 
             RowBox[{
              RowBox[{"A", "\[Transpose]"}], ".", "\[CapitalZeta]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<\!\(\*Cell[TextData[{
Cell[BoxData[FormBox[RowBox[{\"Det\", \"[\", RowBox[{
SuperscriptBox[\"\[Beta]\", RowBox[{\"\[ThinSpace]\", RowBox[{\"-\", \
\"1\"}]}]], 
SuperscriptBox[\"S\", RowBox[{\"\[ThinSpace]\", RowBox[{\"-\", \"1\"}]}]]}], \
\"]\"}], TraditionalForm]],FormatType->\"TraditionalForm\",ExpressionUUID->\"\
9d25a20b-8d87-4a62-9ee8-d2d5a29c324f\"],
\", Norm[\",
Cell[BoxData[FormBox[RowBox[{
SuperscriptBox[\"\[Beta]\", RowBox[{\"\[ThinSpace]\", RowBox[{\"-\", \
\"1\"}]}]], 
SuperscriptBox[\"S\", RowBox[{\"\[ThinSpace]\", RowBox[{\"-\", \"1\"}]}]]}], \
TraditionalForm]],ExpressionUUID->\"d42803f5-9d09-4e89-b794-e2c74f7d0d9f\"],
\"]\"
}],ExpressionUUID->\"4040736c-2a77-4122-b7a4-930c09251859\"]\)\>\"", ",", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"M", "=", 
                RowBox[{
                 SuperscriptBox["\[Beta]", 
                  RowBox[{"-", "1"}]], " ", 
                 RowBox[{"sInv", "[", 
                  RowBox[{
                   SuperscriptBox["10", "log\[Alpha]"], ",", "\[Beta]", ",", 
                   "cs", ",", "order"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Det", "@", "M"}], ",", 
                RowBox[{"Norm", "@", "M"}]}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<\!\(\*Cell[TextData[{
\"Det[\",
Cell[BoxData[FormBox[RowBox[{RowBox[{\"A\", \"\[Transpose]\"}], \
\"\[CenterDot]\", \"A\"}], \
TraditionalForm]],FormatType->\"TraditionalForm\",ExpressionUUID->\"362885f9-\
9d34-4361-8e40-cb6256d9f86f\"],
\"], Norm\"
}],ExpressionUUID->\"258bd99c-ad36-446f-bd08-282d05b5e53b\"]\)\>\"", ",", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"M", "=", 
                RowBox[{
                 RowBox[{"A", "\[Transpose]"}], ".", "A"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Det", "@", "M"}], ",", 
                RowBox[{"Norm", "@", "M"}]}], "}"}]}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}], "]"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "2"}], "}"}], ",", "0", ",", "16", ",", "1", ",", 
     
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"log\[Alpha]", ",", 
       RowBox[{"Log10", "[", "0.005", "]"}], ",", 
       "\"\<\!\(\*SubscriptBox[\(log\), \(10\)]\) \[Alpha] for max \
posterior\>\""}], "}"}], ",", 
     RowBox[{"-", "16"}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", 
       RowBox[{"1", "/", "0.09"}], ",", "\"\<\[Beta] for max posterior\>\""}],
       "}"}], ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]], ",", "100.", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.727989096190207*^9, 3.727989111607684*^9}, {
   3.727989185580763*^9, 3.7279892393755693`*^9}, {3.72798955173129*^9, 
   3.727989594075267*^9}, {3.727989624561162*^9, 3.7279897672865*^9}, 
   3.727990207781111*^9, {3.7279902406039467`*^9, 3.727990276509069*^9}, {
   3.727990432145055*^9, 3.727990545195623*^9}, {3.72799130699829*^9, 
   3.727991307005333*^9}, {3.727991591768076*^9, 3.727991609737764*^9}, {
   3.727991645183196*^9, 3.72799166420612*^9}, {3.727992608834428*^9, 
   3.727992654156641*^9}, {3.7279927039199*^9, 3.7279927175692453`*^9}, {
   3.7279930333670883`*^9, 3.727993080952739*^9}, {3.727993138537717*^9, 
   3.727993147323758*^9}, {3.727993213160774*^9, 3.727993217820777*^9}, 
   3.728035955225011*^9, {3.7282262295415688`*^9, 3.728226243962159*^9}, {
   3.728226290221162*^9, 3.728226420069693*^9}, {3.728226502066142*^9, 
   3.728226526171074*^9}, {3.7282265682957487`*^9, 3.728226638371058*^9}, {
   3.728227010234784*^9, 3.7282270232238007`*^9}, {3.728245933205378*^9, 
   3.728245936365489*^9}, {3.7282459778757668`*^9, 3.728246022965337*^9}, {
   3.7282460585043507`*^9, 3.728246102733577*^9}, {3.7282462526429663`*^9, 
   3.728246318744425*^9}, {3.7282463492129383`*^9, 3.7282463559800463`*^9}, {
   3.728246442446768*^9, 3.728246466102882*^9}, {3.728246507569501*^9, 
   3.728246536388625*^9}, {3.728246579393989*^9, 3.7282466681208487`*^9}, {
   3.728247344958013*^9, 3.728247355611513*^9}, {3.7282474213422194`*^9, 
   3.728247422795175*^9}, {3.728247471143052*^9, 3.7282474904691353`*^9}, {
   3.728247907660754*^9, 3.7282479741618853`*^9}, {3.728248056332654*^9, 
   3.728248134124445*^9}, {3.728248164455634*^9, 3.7282481746776342`*^9}, 
   3.728248206633081*^9, {3.7282482403818007`*^9, 3.728248407583012*^9}, {
   3.728248438362019*^9, 3.72824858749609*^9}, {3.728248829569028*^9, 
   3.728249068639111*^9}, {3.728249133978136*^9, 3.7282492510926323`*^9}, 
   3.7282530152093763`*^9, {3.7282530485877857`*^9, 3.7282530512187223`*^9}, {
   3.72825308467808*^9, 3.7282531487824993`*^9}, {3.728253205404887*^9, 
   3.728253436301762*^9}},ExpressionUUID->"310097dd-ef65-4e4f-8efe-\
967a4d53635c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`log\[Alpha]$$ = -4.869999999999999, \
$CellContext`order$$ = 9, $CellContext`\[Beta]$$ = 11.11111111111111, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`order$$], 2}, 0, 16, 1}, {{
       Hold[$CellContext`log\[Alpha]$$], -2.3010299956639813`, 
       "\!\(\*SubscriptBox[\(log\), \(10\)]\) \[Alpha] for max posterior"}, \
-16, -2}, {{
       Hold[$CellContext`\[Beta]$$], 11.11111111111111, 
       "\[Beta] for max posterior"}, 
      Rational[1, 1000000], 100.}}, Typeset`size$$ = {
    947., {125.2010498046875, 133.7989501953125}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`order$9449$$ = 0, $CellContext`log\[Alpha]$9450$$ = 
    0, $CellContext`\[Beta]$9451$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`log\[Alpha]$$ = -2.3010299956639813`, \
$CellContext`order$$ = 2, $CellContext`\[Beta]$$ = 11.11111111111111}, 
      "ControllerVariables" :> {
        Hold[$CellContext`order$$, $CellContext`order$9449$$, 0], 
        Hold[$CellContext`log\[Alpha]$$, $CellContext`log\[Alpha]$9450$$, 0], 
        
        Hold[$CellContext`\[Beta]$$, $CellContext`\[Beta]$9451$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      With[{$CellContext`ts$ = 
         Part[$CellContext`bishopTrainingSet, 2], $CellContext`cs$ = Map[
           $CellContext`\[Phi][$CellContext`order$$], 
           Map[List, 
            
            Part[$CellContext`bishopTrainingSet, 
             1]]], $CellContext`A$ = \
$CellContext`partialsFn[$CellContext`order$$, 
           Part[$CellContext`bishopTrainingSet, 1]]}, 
        With[{$CellContext`\[CapitalZeta]$ = Map[List, $CellContext`ts$]}, 
         Grid[{{"MLE", 
            MatrixForm[
             Part[
              Dot[
               $CellContext`partialsFn[$CellContext`order$$, \
{$CellContext`x}], 
               Dot[
                
                PseudoInverse[$CellContext`A$], \
$CellContext`\[CapitalZeta]$]], 1, 1]]}, {"MAP", 
            Quiet[
             $CellContext`mapMean[
             10^$CellContext`log\[Alpha]$$, $CellContext`\[Beta]$$, \
$CellContext`x, $CellContext`cs$, $CellContext`ts$, $CellContext`order$$]]}, {
           "\!\(\*UnderoverscriptBox[\(\[Sum]\), \(n = 1\), \(N\)]\)\[Phi]\
\[ThinSpace](\!\(\*SubscriptBox[\(x\), \(n\)]\))\!\(\*SubscriptBox[\(t\), \(n\
\)]\) == A\[Transpose]\[CenterDot]\[CapitalZeta]", 
            Dot[$CellContext`ts$, $CellContext`cs$] == Dot[
              Transpose[$CellContext`A$], $CellContext`\[CapitalZeta]$]}, {
           "\!\(\*Cell[TextData[{\nCell[BoxData[FormBox[\n  RowBox[{\"Det\", \
\"[\", \n    RowBox[{\nSuperscriptBox[\"\[Beta]\", \n      RowBox[{\"\
\[ThinSpace]\", RowBox[{\"-\", \"1\"}]}]], \n\n     SuperscriptBox[\"S\", \n  \
    RowBox[{\"\[ThinSpace]\", RowBox[{\"-\", \"1\"}]}]]}], \"]\"}], \
TraditionalForm]],FormatType->\"TraditionalForm\"],\n\", Norm[\",\n\
Cell[BoxData[FormBox[\n  RowBox[{\nSuperscriptBox[\"\[Beta]\", RowBox[{\"\
\[ThinSpace]\", RowBox[{\"-\", \"1\"}]}]], \n\n    SuperscriptBox[\"S\", \
RowBox[{\"\[ThinSpace]\", RowBox[{\"-\", \"1\"}]}]]}], \n   \
TraditionalForm]]],\n\"]\"\n}]]\)", 
            
            With[{$CellContext`M = $CellContext`\[Beta]$$^(-1) \
$CellContext`sInv[
                10^$CellContext`log\[Alpha]$$, $CellContext`\[Beta]$$, \
$CellContext`cs$, $CellContext`order$$]}, {
              Det[$CellContext`M], 
              Norm[$CellContext`M]}]}, {
           "\!\(\*Cell[TextData[{\n\"Det[\",\nCell[BoxData[FormBox[\n  \
RowBox[{RowBox[{\"A\", \"\[Transpose]\"}], \"\[CenterDot]\", \"A\"}], \
TraditionalForm]],FormatType->\"TraditionalForm\"],\n\"], Norm\"\n}]]\)", 
            With[{$CellContext`M = Dot[
                Transpose[$CellContext`A$], $CellContext`A$]}, {
              Det[$CellContext`M], 
              Norm[$CellContext`M]}]}}]]], 
      "Specifications" :> {{{$CellContext`order$$, 2}, 0, 16, 1, Appearance -> 
         "Labeled"}, {{$CellContext`log\[Alpha]$$, -2.3010299956639813`, 
          "\!\(\*SubscriptBox[\(log\), \(10\)]\) \[Alpha] for max \
posterior"}, -16, -2, Appearance -> 
         "Labeled"}, {{$CellContext`\[Beta]$$, 11.11111111111111, 
          "\[Beta] for max posterior"}, 
         Rational[1, 1000000], 100., Appearance -> "Labeled"}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1013., {219., 227.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.728248884252734*^9, {3.728248959423583*^9, 3.728248986387803*^9}, {
   3.728249031076146*^9, 3.7282490694940577`*^9}, {3.728249176612563*^9, 
   3.728249251865491*^9}, 3.728252957028556*^9, 3.728253017150947*^9, 
   3.7282530523915997`*^9, {3.728253126559903*^9, 3.7282531498289537`*^9}, 
   3.728253257822961*^9, 3.728253341731835*^9, {3.728253410470173*^9, 
   3.728253437887331*^9}},ExpressionUUID->"f7ad3463-44b2-4662-8985-\
6074690de196"]
}, Open  ]],

Cell[TextData[{
 "The following interactive demonstration lets us explore values of ",
 Cell[BoxData[
  FormBox["\[Alpha]", TraditionalForm]],ExpressionUUID->
  "9412efca-5ac8-4deb-9368-71dc5a2c4c7f"],
 ", ",
 Cell[BoxData[
  FormBox["\[Beta]", TraditionalForm]],ExpressionUUID->
  "0f68df93-7b10-4ab4-911d-c6286c6d4d74"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
   "\[LeftDoubleBracketingBar]", "\[CapitalLambda]", 
    "\[RightDoubleBracketingBar]"}], TraditionalForm]],ExpressionUUID->
  "b50c089d-5109-4cfe-ae9a-c0064d11e88a"],
 ",",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[LeftDoubleBracketingBar]", "P", "\[RightDoubleBracketingBar]"}],
    TraditionalForm]],ExpressionUUID->
  "4b53f6a8-29bf-4015-89b9-2b62325a9a2f"],
 ","
}], "Text",
 CellChangeTimes->{{3.727993993378096*^9, 3.7279940063400993`*^9}, {
  3.728035068359541*^9, 3.7280351005391073`*^9}, {3.728035169063525*^9, 
  3.728035230378045*^9}},ExpressionUUID->"064bc29c-4a2e-43a9-8c9a-\
429640e41afa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"gensym", ":", " ", 
       RowBox[{"fresh", " ", "variable", " ", "name"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"terms", "=", 
          RowBox[{"symbolicPowers", "[", 
           RowBox[{"x", ",", "order"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"cs", "=", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "order", "]"}], "/@", 
           RowBox[{"List", "/@", 
            RowBox[{
            "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}]}], ",", 
         RowBox[{"ts", "=", 
          RowBox[{
          "bishopTrainingSet", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"recurrent", "=", 
            RowBox[{"Quiet", "@", 
             RowBox[{
              RowBox[{"rlsFit", "[", 
               SuperscriptBox["10", 
                RowBox[{"-", "logMinInfo"}]], "]"}], "[", 
              RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"normal", "=", 
            RowBox[{"mleFit", "[", 
             RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"kalman", "=", 
            RowBox[{
             RowBox[{"kalFit", "[", 
              RowBox[{
               SuperscriptBox["bishopFakeSigma", "2"], ",", 
               SuperscriptBox["10", "logSigmaXSquared"]}], "]"}], "[", 
             RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rlsFn", "=", 
              RowBox[{
               RowBox[{"{", "terms", "}"}], ".", 
               RowBox[{
               "recurrent", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mleFn", "=", 
              RowBox[{"terms", ".", "normal"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"kalFn", "=", 
              RowBox[{
               RowBox[{"{", "terms", "}"}], ".", 
               RowBox[{
               "kalman", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"bishopMAP", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"mapMean", "[", 
                RowBox[{
                 SuperscriptBox["10", "log\[Alpha]"], ",", "\[Beta]", ",", 
                 "x", ",", "cs", ",", "ts", ",", "order"}], "]"}]}]}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"lp", "=", 
               RowBox[{"ListPlot", "[", 
                RowBox[{
                 RowBox[{"bishopTrainingSet", "\[Transpose]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PlotMarkers", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Graphics", "@", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
                    "}"}]}], ",", ".05"}], "}"}]}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"showlist", "=", 
                 RowBox[{"{", 
                  RowBox[{"lp", ",", 
                   RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox[
                    RowBox[{"Sin", "[", 
                    RowBox[{"2.", "\[Pi]", " ", "x"}], "]"}],
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0.", ",", "1."}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", 
                    StyleBox["Green",
                    Background->RGBColor[1, 1, 0]]}], "}"}]}]}], "]"}]}], 
                  "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"recurrentQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["rlsFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Purple",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"normalQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["mleFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Orange",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"kalmanQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["kalFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Cyan",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"bishopMapQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{"bishopMAP", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Magenta",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"Show", "[", 
                  RowBox[{"showlist", ",", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<x\>\"", ",", "\"\<t\>\""}], "}"}]}]}], 
                  "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"recurrentQ", ",", "False", ",", "\"\<RLS\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"kalmanQ", ",", "False", ",", "\"\<KAL\>\""}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"normalQ", ",", "True", ",", "\"\<MLE\>\""}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"bishopMapQ", ",", "True", ",", "\"\<MAP\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "}"}], "}"}], ",", 
          RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], ",", "\"\<\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"order", ",", "4", ",", "\"\<polynomial order\>\""}], 
            "}"}], ",", "0", ",", "16", ",", "1", ",", 
           RowBox[{"Appearance", "\[Rule]", 
            RowBox[{"{", "\"\<Labeled\>\"", "}"}]}]}], "}"}], "]"}], ",", 
        "\"\<\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "logMinInfo", ",", "3", ",", "\"\<-log a-priori info (RLS)\>\""}], 
           "}"}], ",", "0", ",", "16", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "logSigmaXSquared", ",", "3", ",", 
            "\"\<log a-priori cov (KAL)\>\""}], "}"}], ",", "0", ",", "16", 
          ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"log\[Alpha]", ",", 
            RowBox[{"Log10", "[", "0.005", "]"}], ",", 
            "\"\<\!\(\*SubscriptBox[\(log\), \(10\)]\) \[Alpha] for max \
posterior\>\""}], "}"}], ",", 
          RowBox[{"-", "16"}], ",", 
          RowBox[{"-", "2"}], ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", 
            RowBox[{"1", "/", "0.09"}], ",", 
            "\"\<\[Beta] for max posterior\>\""}], "}"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]], ",", "20.", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.727884681931381*^9, 3.7278848244947367`*^9}, 
   3.727884861217602*^9, {3.727884975910451*^9, 3.7278849940673532`*^9}, {
   3.727885103521431*^9, 3.727885154698123*^9}, {3.72788520225443*^9, 
   3.727885279820177*^9}, {3.727885496115718*^9, 3.727885517688189*^9}, {
   3.72788559395383*^9, 3.727885598972475*^9}, {3.7278856296542664`*^9, 
   3.727885630876935*^9}, {3.727885695972756*^9, 3.727885696864628*^9}, {
   3.727886633660364*^9, 3.72788671287046*^9}, {3.727886975364171*^9, 
   3.727886975439041*^9}, {3.727903476653379*^9, 3.7279034819231358`*^9}, {
   3.727903531862627*^9, 3.727903539245574*^9}, 3.727913149489944*^9, {
   3.727915429732944*^9, 3.7279154437948627`*^9}, {3.727915750998211*^9, 
   3.7279158447033873`*^9}, {3.7279213832695303`*^9, 3.72792149154887*^9}, {
   3.727921523149373*^9, 3.72792161270367*^9}, {3.72792165300301*^9, 
   3.727921654632832*^9}, {3.727921753282296*^9, 3.727921753360197*^9}, {
   3.727924008558401*^9, 3.727924045018003*^9}, {3.727924293814445*^9, 
   3.727924370827516*^9}, 3.727965590613636*^9, {3.7279686551525917`*^9, 
   3.727968670349081*^9}, {3.7279689406605043`*^9, 3.727969019631563*^9}, {
   3.727970883056108*^9, 3.727970945128386*^9}, {3.727971005813472*^9, 
   3.727971023734253*^9}, {3.727990640753121*^9, 3.727990674786282*^9}, {
   3.727990711779483*^9, 3.727990808626033*^9}, {3.727991307012423*^9, 
   3.727991307022031*^9}, {3.7279932412769613`*^9, 3.7279932949280367`*^9}, {
   3.7279933910397243`*^9, 3.727993398358789*^9}, {3.727993778490755*^9, 
   3.72799379332897*^9}, {3.727993826040863*^9, 3.7279938751552763`*^9}, {
   3.727993956673335*^9, 3.727993958184173*^9}, 3.727994128012043*^9, {
   3.7280354067714148`*^9, 3.7280354258611927`*^9}, {3.728035634299762*^9, 
   3.728035732029833*^9}, {3.72803585641748*^9, 3.728035906176405*^9}, {
   3.728038924314391*^9, 3.728039041653799*^9}, {3.728039077026232*^9, 
   3.72803913265169*^9}, {3.728039194847865*^9, 3.728039320044661*^9}, {
   3.728044256958378*^9, 3.728044343151896*^9}, {3.728044393583234*^9, 
   3.728044466540698*^9}, 3.7280447095836163`*^9, {3.728044856722988*^9, 
   3.728044959527645*^9}, {3.728044995179022*^9, 3.728044998104682*^9}, {
   3.728045028753289*^9, 3.728045063548128*^9}, {3.728045464570526*^9, 
   3.728045476328084*^9}, {3.728045812340419*^9, 3.728045836978776*^9}, {
   3.7280461335391397`*^9, 3.728046355530389*^9}, {3.728046392282709*^9, 
   3.728046397281275*^9}, {3.728046429888109*^9, 3.728046434285967*^9}, {
   3.728046509047914*^9, 3.728046577986915*^9}, {3.728048625582951*^9, 
   3.728048658147644*^9}, {3.728048704639155*^9, 3.7280487209829884`*^9}, {
   3.728048763333255*^9, 3.728048783520523*^9}, 3.728048849900649*^9, {
   3.728048881350296*^9, 3.7280488887365723`*^9}, {3.7280489358794527`*^9, 
   3.728048947834031*^9}, {3.7280492952517767`*^9, 3.728049427179392*^9}, {
   3.728049506853256*^9, 3.7280496162697783`*^9}, {3.728050015065921*^9, 
   3.7280500376507397`*^9}, {3.7280500733077374`*^9, 
   3.7280501005796213`*^9}, {3.728089881496944*^9, 3.728089882038129*^9}, {
   3.728090725835964*^9, 3.728090725845487*^9}, {3.728169349750301*^9, 
   3.728169349773612*^9}, {3.728169400997793*^9, 3.728169417906619*^9}, {
   3.728169511798567*^9, 3.728169523731205*^9}, {3.7281696125541363`*^9, 
   3.7281696306368437`*^9}, 3.728226727530678*^9, {3.728226810131266*^9, 
   3.728226816018466*^9}, {3.728226857072884*^9, 3.728226861119492*^9}, 
   3.728245946305786*^9, {3.7282487072286263`*^9, 3.728248709889584*^9}, {
   3.728251170478485*^9, 3.728251170709284*^9}, {3.7282526609079533`*^9, 
   3.728252718943617*^9}, 3.728252776351699*^9, {3.728252825506783*^9, 
   3.7282528275522842`*^9}, {3.7282528645183697`*^9, 3.728252865147182*^9}, 
   3.7282539826691*^9},ExpressionUUID->"9ffa1b6e-a210-4513-95e5-469181d4340b"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bishopMapQ$$ = 
    True, $CellContext`kalmanQ$$ = False, $CellContext`logMinInfo$$ = 
    3, $CellContext`logSigmaXSquared$$ = 
    3, $CellContext`log\[Alpha]$$ = -7.9, $CellContext`normalQ$$ = 
    True, $CellContext`order$$ = 9, $CellContext`recurrentQ$$ = 
    False, $CellContext`\[Beta]$$ = 11.11111111111111, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`recurrentQ$$], False, "RLS"}, {True, False}}, {{
       Hold[$CellContext`kalmanQ$$], False, "KAL"}, {True, False}}, {{
       Hold[$CellContext`normalQ$$], True, "MLE"}, {True, False}}, {{
       Hold[$CellContext`bishopMapQ$$], True, "MAP"}, {True, False}}, {{
       Hold[$CellContext`order$$], 4, "polynomial order"}, 0, 16, 1}, {{
       Hold[$CellContext`logMinInfo$$], 3, "-log a-priori info (REC)"}, 0, 
      16}, {{
       Hold[$CellContext`logSigmaXSquared$$], 3, "log a-priori cov (KAL)"}, 0,
       16}, {{
       Hold[$CellContext`log\[Alpha]$$], -2.3010299956639813`, 
       "\!\(\*SubscriptBox[\(log\), \(10\)]\) \[Alpha] for max posterior"}, \
-16, -2}, {{
       Hold[$CellContext`\[Beta]$$], 11.11111111111111, 
       "\[Beta] for max posterior"}, 
      Rational[1, 1000000], 20.}, {
      Hold[
       Grid[{{
          Grid[{{
             Manipulate`Place[1], 
             Manipulate`Place[2], 
             Manipulate`Place[3], 
             Manipulate`Place[4]}}, Frame -> All], ""}, {
          Manipulate`Place[5], ""}, {
          Manipulate`Place[6]}, {
          Manipulate`Place[7]}, {
          Manipulate`Place[8]}, {
          Manipulate`Place[9]}}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {540., {168., 175.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`recurrentQ$3190$$ = 
    False, $CellContext`kalmanQ$3191$$ = False, $CellContext`normalQ$3192$$ = 
    False, $CellContext`bishopMapQ$3193$$ = False, $CellContext`order$3194$$ =
     0, $CellContext`logMinInfo$3195$$ = 
    0, $CellContext`logSigmaXSquared$3196$$ = 
    0, $CellContext`log\[Alpha]$3197$$ = 0, $CellContext`\[Beta]$3198$$ = 0}, 
    
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`bishopMapQ$$ = 
        True, $CellContext`kalmanQ$$ = False, $CellContext`logMinInfo$$ = 
        3, $CellContext`logSigmaXSquared$$ = 
        3, $CellContext`log\[Alpha]$$ = -2.3010299956639813`, \
$CellContext`normalQ$$ = True, $CellContext`order$$ = 
        4, $CellContext`recurrentQ$$ = False, $CellContext`\[Beta]$$ = 
        11.11111111111111}, "ControllerVariables" :> {
        Hold[$CellContext`recurrentQ$$, $CellContext`recurrentQ$3190$$, 
         False], 
        Hold[$CellContext`kalmanQ$$, $CellContext`kalmanQ$3191$$, False], 
        Hold[$CellContext`normalQ$$, $CellContext`normalQ$3192$$, False], 
        Hold[$CellContext`bishopMapQ$$, $CellContext`bishopMapQ$3193$$, 
         False], 
        Hold[$CellContext`order$$, $CellContext`order$3194$$, 0], 
        Hold[$CellContext`logMinInfo$$, $CellContext`logMinInfo$3195$$, 0], 
        Hold[$CellContext`logSigmaXSquared$$, \
$CellContext`logSigmaXSquared$3196$$, 0], 
        Hold[$CellContext`log\[Alpha]$$, $CellContext`log\[Alpha]$3197$$, 0], 
        
        Hold[$CellContext`\[Beta]$$, $CellContext`\[Beta]$3198$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Module[{$CellContext`x$}, 
        With[{$CellContext`terms$ = \
$CellContext`symbolicPowers[$CellContext`x$, $CellContext`order$$], \
$CellContext`cs$ = Map[
            $CellContext`\[Phi][$CellContext`order$$], 
            Map[List, 
             Part[$CellContext`bishopTrainingSet, 1]]], $CellContext`ts$ = 
          Part[$CellContext`bishopTrainingSet, 2]}, 
         With[{$CellContext`recurrent$ = Quiet[
             $CellContext`rlsFit[
             10^(-$CellContext`logMinInfo$$)][$CellContext`order$$, \
$CellContext`bishopTrainingSet]], $CellContext`normal$ = \
$CellContext`mleFit[$CellContext`order$$, $CellContext`bishopTrainingSet], \
$CellContext`kalman$ = $CellContext`kalFit[$CellContext`bishopFakeSigma^2, 
             10^$CellContext`logSigmaXSquared$$][$CellContext`order$$, \
$CellContext`bishopTrainingSet]}, 
          With[{$CellContext`rlsFn$ = Dot[{$CellContext`terms$}, 
              Part[$CellContext`recurrent$, 1]], $CellContext`mleFn$ = 
            Dot[$CellContext`terms$, $CellContext`normal$], \
$CellContext`kalFn$ = Dot[{$CellContext`terms$}, 
              Part[$CellContext`kalman$, 1]], $CellContext`bishopMAP$ = 
            Quiet[
              $CellContext`mapMean[
              10^$CellContext`log\[Alpha]$$, $CellContext`\[Beta]$$, \
$CellContext`x$, $CellContext`cs$, $CellContext`ts$, $CellContext`order$$]]}, 
           
           With[{$CellContext`lp$ = ListPlot[
               Transpose[$CellContext`bishopTrainingSet], PlotMarkers -> {
                 Graphics[{Blue, 
                   Circle[{0, 0}, 1]}], 0.05}]}, 
            Module[{$CellContext`showlist$ = {$CellContext`lp$, 
                Plot[
                 Sin[2. Pi $CellContext`x$], {$CellContext`x$, 0., 1.}, 
                 PlotStyle -> {Thick, Green}]}}, If[$CellContext`recurrentQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`rlsFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Purple}]]]; If[$CellContext`normalQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`mleFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Orange}]]]; If[$CellContext`kalmanQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`kalFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Cyan}]]]; If[$CellContext`bishopMapQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`bishopMAP$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Magenta}]]]; Quiet[
               
               Show[$CellContext`showlist$, Frame -> True, 
                FrameLabel -> {"x", "t"}]]]]]]]], 
      "Specifications" :> {{{$CellContext`recurrentQ$$, False, "RLS"}, {
         True, False}, ControlPlacement -> 
         1}, {{$CellContext`kalmanQ$$, False, "KAL"}, {True, False}, 
         ControlPlacement -> 2}, {{$CellContext`normalQ$$, True, "MLE"}, {
         True, False}, ControlPlacement -> 
         3}, {{$CellContext`bishopMapQ$$, True, "MAP"}, {True, False}, 
         ControlPlacement -> 
         4}, {{$CellContext`order$$, 4, "polynomial order"}, 0, 16, 1, 
         Appearance -> {"Labeled"}, ControlPlacement -> 
         5}, {{$CellContext`logMinInfo$$, 3, "-log a-priori info (REC)"}, 0, 
         16, Appearance -> "Labeled", ControlPlacement -> 
         6}, {{$CellContext`logSigmaXSquared$$, 3, "log a-priori cov (KAL)"}, 
         0, 16, Appearance -> "Labeled", ControlPlacement -> 
         7}, {{$CellContext`log\[Alpha]$$, -2.3010299956639813`, 
          "\!\(\*SubscriptBox[\(log\), \(10\)]\) \[Alpha] for max \
posterior"}, -16, -2, Appearance -> "Labeled", ControlPlacement -> 
         8}, {{$CellContext`\[Beta]$$, 11.11111111111111, 
          "\[Beta] for max posterior"}, 
         Rational[1, 1000000], 20., Appearance -> "Labeled", ControlPlacement -> 
         9}, 
        Grid[{{
           Grid[{{
              Manipulate`Place[1], 
              Manipulate`Place[2], 
              Manipulate`Place[3], 
              Manipulate`Place[4]}}, Frame -> All], ""}, {
           Manipulate`Place[5], ""}, {
           Manipulate`Place[6]}, {
           Manipulate`Place[7]}, {
           Manipulate`Place[8]}, {
           Manipulate`Place[9]}}]}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{606., {312., 321.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.728050115300803*^9, 3.728066471770697*^9, 
  3.728068121965966*^9, 3.728083785378928*^9, 3.728089884578744*^9, 
  3.728090743408286*^9, 3.7281694470300694`*^9, 3.7281695420918407`*^9, 
  3.728169824746389*^9, 3.7281698847020082`*^9, 3.728226730100107*^9, 
  3.728226817846167*^9, 3.7282268622387657`*^9, 3.7282487114389772`*^9, 
  3.728252731001594*^9, 3.728252777577374*^9, 3.7282528289258337`*^9, 
  3.72825286627736*^9, 
  3.728252957086163*^9},ExpressionUUID->"65608188-9b5c-4b1a-af50-\
25e276836a05"]
}, Open  ]],

Cell[TextData[{
 "Bishop' s equation 1.71. Notice that ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["s", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f0a06a80-9529-4f89-8862-200b7deb4ac1"],
 " does not depend on \t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["t", "n"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2c5fff2e-1c1d-406e-901d-41521c38df61"],
 ", just as with the Kalman filter and RLS\.7f."
}], "Text",
 CellChangeTimes->{{3.727994165301249*^9, 3.7279941851829967`*^9}, {
  3.72808526244471*^9, 3.728085323623013*^9}, {3.728253500899654*^9, 
  3.728253506076968*^9}},ExpressionUUID->"995645c6-4791-43e9-ba09-\
72f6fe74537e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "mapsSquared", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mapsSquared", "[", 
    RowBox[{
    "\[Alpha]_", ",", "\[Beta]_", ",", "x_", ",", "cs_", ",", 
     "\[CapitalMu]_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    SuperscriptBox["\[Beta]", 
     RowBox[{"-", "1"}]], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "\[CapitalMu]", "]"}], "[", "x", "]"}], "}"}], 
     ".", 
     RowBox[{"LinearSolve", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sInv", "[", 
        RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "cs", ",", "\[CapitalMu]"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"List", "/@", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "\[CapitalMu]", "]"}], "[", "x", "]"}]}]}], 
      "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cs", "=", 
       RowBox[{
        RowBox[{"\[Phi]", "[", "order", "]"}], "/@", 
        RowBox[{"List", "/@", 
         RowBox[{
         "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"mapsSquared", "[", 
        RowBox[{"0.005", ",", 
         RowBox[{"1", "/", "0.09"}], ",", "x", ",", "cs", ",", "order"}], 
        "]"}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "2"}], "}"}], ",", "0", ",", "16", ",", "1", ",", 
     
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.727994197366062*^9, 3.7279942096588373`*^9}, {
  3.727994247046831*^9, 3.7279942495547533`*^9}, {3.7279943024871273`*^9, 
  3.7279946538407373`*^9}, {3.7280359193758917`*^9, 
  3.728035920837536*^9}},ExpressionUUID->"bf04b114-e46b-4f32-aa70-\
3883982da28c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`order$$ = 2, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`order$$], 2}, 0, 16, 1}}, Typeset`size$$ = {
    618., {1., 18.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`order$3427$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`order$$ = 2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`order$$, $CellContext`order$3427$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> With[{$CellContext`cs$ = Map[
           $CellContext`\[Phi][$CellContext`order$$], 
           Map[List, 
            Part[$CellContext`bishopTrainingSet, 1]]]}, 
        Part[
         Simplify[
          $CellContext`mapsSquared[
          0.005, 1/
           0.09, $CellContext`x, $CellContext`cs$, $CellContext`order$$]], 1, 
         1]], "Specifications" :> {{{$CellContext`order$$, 2}, 0, 16, 1, 
         Appearance -> "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{684., {72., 80.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7279945907497396`*^9, 3.727994633051759*^9}, {
   3.7280353786762123`*^9, 3.728035390390698*^9}, 3.7280359217379313`*^9, 
   3.7280443536746197`*^9, 3.728046449453389*^9, 3.728066471942664*^9, 
   3.728068122135195*^9, 3.7280837855621977`*^9, 3.728090743591949*^9, 
   3.728169447229127*^9, 3.728169542156461*^9, 3.728169824927549*^9, 
   3.728169884885825*^9, 
   3.728252957300716*^9},ExpressionUUID->"9d4ce68b-96e8-4c1b-b6b0-\
96cb0a6b3eea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rls", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{
          RowBox[{"rlsFit", "[", 
           SuperscriptBox["10", 
            RowBox[{"-", "logMinInfo"}]], "]"}], "[", 
          RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}]}], ",", 
       RowBox[{"model", "=", 
        RowBox[{"symbolicPowers", "[", 
         RowBox[{"x", ",", "order"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"xs", "=", 
        RowBox[{
        "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"ys", "=", 
        RowBox[{
        "bishopTrainingSet", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mle", "=", 
          RowBox[{"LinearModelFit", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"xs", ",", "ys"}], "}"}], "\[Transpose]"}], ",", 
            RowBox[{"Drop", "[", 
             RowBox[{"model", ",", "1"}], "]"}], ",", "x"}], "]"}]}], ",", 
         RowBox[{"\[CapitalNu]", "=", 
          RowBox[{"Length", "[", "xs", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lmModel", "=", 
           RowBox[{
            RowBox[{"mle", "[", "\"\<Function\>\"", "]"}], "[", "x", "]"}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"kal", "=", 
              RowBox[{
               RowBox[{"kalFit", "[", 
                RowBox[{
                 SuperscriptBox["kalmanObsSigma", "2"], ",", 
                 SuperscriptBox["10", "logSigmaXSquared"]}], "]"}], "[", 
               RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}], ",", 
             RowBox[{"A", "=", 
              RowBox[{"partialsFn", "[", 
               RowBox[{"order", ",", "xs"}], "]"}]}], ",", 
             RowBox[{"n", "=", 
              RowBox[{"Length", "@", "xs"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"residuals", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ys", "-", 
                   RowBox[{"A", ".", 
                    RowBox[{
                    "rls", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "\[Transpose]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"var", "=", 
                 RowBox[{"Variance", "[", "residuals", "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"rlscov", "=", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"n", "-", "1"}], 
                    RowBox[{"n", "-", 
                    RowBox[{"(", 
                    RowBox[{"order", "+", "1"}], ")"}]}]], "var", " ", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Inverse", "[", 
                    RowBox[{
                    "rls", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}]}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"cs", "=", 
                    RowBox[{
                    RowBox[{"\[Phi]", "[", "order", "]"}], "/@", 
                    RowBox[{"List", "/@", 
                    RowBox[{
                    "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sinv", "=", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"sInv", "[", 
                    RowBox[{
                    SuperscriptBox["10", "log\[Alpha]"], ",", "\[Beta]", ",", 
                    "cs", ",", "order"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<RLS model\>\"", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "model", "}"}], ".", 
                    RowBox[{
                    "rls", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Kalman model\>\"", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "model", "}"}], ".", 
                    RowBox[{
                    "kal", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<MLE model\>\"", ",", "lmModel"}], "}"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Det, Norm of RLS cov\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Det", "[", "rlscov", "]"}], ",", 
                    RowBox[{"Norm", "[", "rlscov", "]"}]}], "}"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Det, Norm of Kalman cov\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Det", "[", 
                    RowBox[{
                    "kal", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"Norm", "[", 
                    RowBox[{
                    "kal", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Det, Norm of MLE cov\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Det", "[", 
                    RowBox[{"mle", "[", "\"\<CovarianceMatrix\>\"", "]"}], 
                    "]"}], ",", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"mle", "[", "\"\<CovarianceMatrix\>\"", "]"}], 
                    "]"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Det, Norm of MAP cov\>\"", ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mapcov", "=", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Inverse", "[", 
                    RowBox[{
                    FractionBox["\[CapitalNu]", 
                    RowBox[{"\[CapitalNu]", "-", 
                    RowBox[{"(", 
                    RowBox[{"order", "+", "1"}], ")"}]}]], "sinv"}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Det", "[", "mapcov", "]"}], ",", 
                    RowBox[{"Norm", "[", "mapcov", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
              "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "8", ",", "\"\<polynomial order\>\""}], "}"}], 
     ",", "0", ",", "16", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Labeled\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "logMinInfo", ",", "6", ",", "\"\<-log a-priori info (RLS)\>\""}], 
      "}"}], ",", "0", ",", "16", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "kalmanObsSigma", ",", "bishopFakeSigma", ",", 
       "\"\<Kalman observation \[Sigma]\>\""}], "}"}], ",", "0", ",", "1", 
     ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "logSigmaXSquared", ",", "3", ",", "\"\<log a-priori cov (KAL)\>\""}], 
      "}"}], ",", "0", ",", "16", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"log\[Alpha]", ",", 
       RowBox[{"Log10", "[", "0.005", "]"}], ",", 
       "\"\<\!\(\*SubscriptBox[\(log\), \(10\)]\) \[Alpha] for max \
posterior\>\""}], "}"}], ",", 
     RowBox[{"-", "16"}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", 
       RowBox[{"1", "/", "0.09"}], ",", "\"\<\[Beta] for max posterior\>\""}],
       "}"}], ",", "$MachineEpsilon", ",", "40.", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.728086866854075*^9, 3.7280869379362803`*^9}, 
   3.728086968504457*^9, {3.7280870018866377`*^9, 3.728087035347722*^9}, {
   3.728087077311129*^9, 3.7280871740110903`*^9}, {3.7280873314335003`*^9, 
   3.7280873718201942`*^9}, {3.72808743748846*^9, 3.728087477181609*^9}, {
   3.7280875357662077`*^9, 3.728087584977745*^9}, {3.72808763436246*^9, 
   3.728087680155005*^9}, {3.728087753694256*^9, 3.728087785918949*^9}, {
   3.728087837399972*^9, 3.728087906119563*^9}, {3.728087942441844*^9, 
   3.728087949993483*^9}, {3.728088331435465*^9, 3.72808845421922*^9}, {
   3.728088499012917*^9, 3.7280885007452602`*^9}, {3.7280885382431498`*^9, 
   3.728088633198524*^9}, {3.7280886891267357`*^9, 3.728088706285945*^9}, 
   3.728088770496656*^9, {3.728088927611939*^9, 3.7280889532017937`*^9}, {
   3.728089010183187*^9, 3.7280890197266417`*^9}, {3.728089071295445*^9, 
   3.728089082189126*^9}, {3.728089166536764*^9, 3.72808929892478*^9}, {
   3.728089331204369*^9, 3.728089372444316*^9}, {3.7280894917958117`*^9, 
   3.728089554985269*^9}, {3.728089696271824*^9, 3.7280897102844887`*^9}, {
   3.7280897829469023`*^9, 3.728089828917*^9}, {3.7280899928304873`*^9, 
   3.7280900899676113`*^9}, {3.728090122041238*^9, 3.728090254954507*^9}, {
   3.728090318156164*^9, 3.728090361414133*^9}, {3.728090414324396*^9, 
   3.7280904772743692`*^9}, {3.7280905156376038`*^9, 3.7280906365060883`*^9}, 
   3.728090676375643*^9, 3.728090725777858*^9, {3.728167628257018*^9, 
   3.728167657158001*^9}, {3.7281676903572187`*^9, 3.728167766959997*^9}, {
   3.728167798563282*^9, 3.728167825475285*^9}, {3.728167865964938*^9, 
   3.728167961016965*^9}, {3.728169273423571*^9, 3.7281692783017406`*^9}, 
   3.72816963061193*^9, {3.728170617183737*^9, 3.728170627963471*^9}, {
   3.728170680931717*^9, 3.72817068509657*^9}, {3.7281707151377*^9, 
   3.7281709025031023`*^9}, {3.728170969271514*^9, 3.728170988459838*^9}, {
   3.728171025321766*^9, 3.7281711371778927`*^9}, {3.728171192411994*^9, 
   3.728171203378146*^9}, {3.7281737332263317`*^9, 3.728173738143146*^9}, {
   3.728173781536154*^9, 3.728173865916963*^9}, {3.7281739005605593`*^9, 
   3.7281739426864862`*^9}, {3.728253547393693*^9, 3.7282537638915653`*^9}, {
   3.728253816404439*^9, 3.7282538998012667`*^9}, {3.728253969795733*^9, 
   3.728253970178299*^9}, {3.728254038922204*^9, 3.728254063430524*^9}, {
   3.7282541585817003`*^9, 
   3.728254161243896*^9}},ExpressionUUID->"1ebdb9ce-0acf-4530-bd7d-\
cb9df05dbf32"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`kalmanObsSigma$$ = 
    0.3, $CellContext`logMinInfo$$ = 6, $CellContext`logSigmaXSquared$$ = 
    3, $CellContext`log\[Alpha]$$ = -3.33, $CellContext`order$$ = 
    8, $CellContext`\[Beta]$$ = 11.11111111111111, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`order$$], 8, "polynomial order"}, 0, 16, 1}, {{
       Hold[$CellContext`logMinInfo$$], 6, "-log a-priori info (RLS)"}, 0, 
      16}, {{
       Hold[$CellContext`kalmanObsSigma$$], 0.3, 
       "Kalman observation \[Sigma]"}, 0, 1}, {{
       Hold[$CellContext`logSigmaXSquared$$], 3, "log a-priori cov (KAL)"}, 0,
       16}, {{
       Hold[$CellContext`log\[Alpha]$$], -2.3010299956639813`, 
       "\!\(\*SubscriptBox[\(log\), \(10\)]\) \[Alpha] for max posterior"}, \
-16, -2}, {{
       Hold[$CellContext`\[Beta]$$], 11.11111111111111, 
       "\[Beta] for max posterior"}, 2.220446049250313*^-16, 40.}}, 
    Typeset`size$$ = {940., {153.7010498046875, 162.2989501953125}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`order$33769$$ = 0, $CellContext`logMinInfo$33770$$ = 
    0, $CellContext`kalmanObsSigma$33771$$ = 
    0, $CellContext`logSigmaXSquared$33772$$ = 
    0, $CellContext`log\[Alpha]$33773$$ = 0, $CellContext`\[Beta]$33774$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`kalmanObsSigma$$ = 
        0.3, $CellContext`logMinInfo$$ = 6, $CellContext`logSigmaXSquared$$ = 
        3, $CellContext`log\[Alpha]$$ = -2.3010299956639813`, \
$CellContext`order$$ = 8, $CellContext`\[Beta]$$ = 11.11111111111111}, 
      "ControllerVariables" :> {
        Hold[$CellContext`order$$, $CellContext`order$33769$$, 0], 
        Hold[$CellContext`logMinInfo$$, $CellContext`logMinInfo$33770$$, 0], 
        Hold[$CellContext`kalmanObsSigma$$, \
$CellContext`kalmanObsSigma$33771$$, 0], 
        Hold[$CellContext`logSigmaXSquared$$, \
$CellContext`logSigmaXSquared$33772$$, 0], 
        Hold[$CellContext`log\[Alpha]$$, $CellContext`log\[Alpha]$33773$$, 0], 
        Hold[$CellContext`\[Beta]$$, $CellContext`\[Beta]$33774$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> With[{$CellContext`rls$ = Quiet[
           $CellContext`rlsFit[
           10^(-$CellContext`logMinInfo$$)][$CellContext`order$$, \
$CellContext`bishopTrainingSet]], $CellContext`model$ = \
$CellContext`symbolicPowers[$CellContext`x, $CellContext`order$$], \
$CellContext`xs$ = Part[$CellContext`bishopTrainingSet, 1], $CellContext`ys$ = 
         Part[$CellContext`bishopTrainingSet, 2]}, 
        With[{$CellContext`mle$ = LinearModelFit[
            Transpose[{$CellContext`xs$, $CellContext`ys$}], 
            
            Drop[$CellContext`model$, 
             1], $CellContext`x], $CellContext`\[CapitalNu]$ = 
          Length[$CellContext`xs$]}, 
         With[{$CellContext`lmModel$ = $CellContext`mle$[
            "Function"][$CellContext`x]}, 
          
          With[{$CellContext`kal$ = \
$CellContext`kalFit[$CellContext`kalmanObsSigma$$^2, 
              10^$CellContext`logSigmaXSquared$$][$CellContext`order$$, \
$CellContext`bishopTrainingSet], $CellContext`A$ = \
$CellContext`partialsFn[$CellContext`order$$, $CellContext`xs$], \
$CellContext`n$ = Length[$CellContext`xs$]}, 
           With[{$CellContext`residuals$ = Part[
               Transpose[$CellContext`ys$ - Dot[$CellContext`A$, 
                 Part[$CellContext`rls$, 1]]], 1]}, 
            With[{$CellContext`var$ = Variance[$CellContext`residuals$]}, 
             
             With[{$CellContext`rlscov$ = (($CellContext`n$ - 
                  1)/($CellContext`n$ - ($CellContext`order$$ + 
                 1))) $CellContext`var$ Quiet[
                  Inverse[
                   Part[$CellContext`rls$, 2]]]}, 
              With[{$CellContext`cs$ = Map[
                  $CellContext`\[Phi][$CellContext`order$$], 
                  Map[List, 
                   Part[$CellContext`bishopTrainingSet, 1]]]}, 
               With[{$CellContext`sinv$ = Quiet[
                   $CellContext`sInv[
                   10^$CellContext`log\[Alpha]$$, $CellContext`\[Beta]$$, \
$CellContext`cs$, $CellContext`order$$]]}, 
                Grid[{{"RLS model", 
                   Part[
                    Dot[{$CellContext`model$}, 
                    Part[$CellContext`rls$, 1]], 1, 1]}, {"Kalman model", 
                   Part[
                    Dot[{$CellContext`model$}, 
                    Part[$CellContext`kal$, 1]], 1, 1]}, {
                  "MLE model", $CellContext`lmModel$}, {
                  "Det, Norm of RLS cov", {
                    Det[$CellContext`rlscov$], 
                    Norm[$CellContext`rlscov$]}}, {"Det, Norm of Kalman cov", {
                    Det[
                    Part[$CellContext`kal$, 2]], 
                    Norm[
                    Part[$CellContext`kal$, 2]]}}, {"Det, Norm of MLE cov", {
                    Det[
                    $CellContext`mle$["CovarianceMatrix"]], 
                    Norm[
                    $CellContext`mle$["CovarianceMatrix"]]}}, {
                  "Det, Norm of MAP cov", 
                   With[{$CellContext`mapcov = Quiet[
                    
                    Inverse[($CellContext`\[CapitalNu]$/($CellContext`\
\[CapitalNu]$ - ($CellContext`order$$ + 1))) $CellContext`sinv$]]}, {
                    Det[$CellContext`mapcov], 
                    Norm[$CellContext`mapcov]}]}}]]]]]]]]]], 
      "Specifications" :> {{{$CellContext`order$$, 8, "polynomial order"}, 0, 
         16, 1, Appearance -> {"Labeled"}}, {{$CellContext`logMinInfo$$, 6, 
          "-log a-priori info (RLS)"}, 0, 16, Appearance -> 
         "Labeled"}, {{$CellContext`kalmanObsSigma$$, 0.3, 
          "Kalman observation \[Sigma]"}, 0, 1, Appearance -> 
         "Labeled"}, {{$CellContext`logSigmaXSquared$$, 3, 
          "log a-priori cov (KAL)"}, 0, 16, Appearance -> 
         "Labeled"}, {{$CellContext`log\[Alpha]$$, -2.3010299956639813`, 
          "\!\(\*SubscriptBox[\(log\), \(10\)]\) \[Alpha] for max \
posterior"}, -16, -2, Appearance -> 
         "Labeled"}, {{$CellContext`\[Beta]$$, 11.11111111111111, 
          "\[Beta] for max posterior"}, 2.220446049250313*^-16, 40., 
         Appearance -> "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1006., {292., 301.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.728086939326767*^9, 3.728086969976722*^9, {3.728087010592977*^9, 
   3.7280870360848083`*^9}, 3.7280870899313507`*^9, 3.7280871360862827`*^9, 
   3.728087175110732*^9, {3.7280874387376003`*^9, 3.72808745631332*^9}, 
   3.728087588151546*^9, {3.7280877685521*^9, 3.728087786318966*^9}, {
   3.728087848269092*^9, 3.728087856305628*^9}, 3.7280879068622847`*^9, {
   3.7280884060895767`*^9, 3.728088455556003*^9}, 3.728088501743174*^9, {
   3.728088542619534*^9, 3.728088634529085*^9}, 3.728089245568872*^9, {
   3.728089355512425*^9, 3.728089373372801*^9}, 3.7280894456100893`*^9, 
   3.728089506358725*^9, 3.728089556152829*^9, 3.728089801959977*^9, {
   3.7280900339748487`*^9, 3.728090060539701*^9}, 3.728090176596827*^9, 
   3.728090210123789*^9, 3.728090256788909*^9, 3.7280903281556253`*^9, {
   3.728090455143282*^9, 3.728090478219261*^9}, 3.728090557096423*^9, 
   3.728090637478004*^9, 3.728090677303349*^9, 3.728090742695616*^9, 
   3.7281676601173697`*^9, 3.7281677124565773`*^9, 3.728167768009528*^9, 
   3.72816780495455*^9, 3.7281678769811077`*^9, 3.728167922685523*^9, {
   3.728169257308734*^9, 3.728169283137888*^9}, 3.728169446181937*^9, 
   3.728169541595984*^9, 3.728169823899042*^9, 3.728169883904351*^9, 
   3.7281708693533287`*^9, 3.728170910676194*^9, 3.728170998115674*^9, 
   3.728171139216485*^9, 3.728171205238422*^9, 3.728173869487527*^9, 
   3.728173911396873*^9, 3.728173944294754*^9, 3.728252957423011*^9, 
   3.7282536100889807`*^9, 3.728253765644074*^9, 3.728253901363344*^9, {
   3.728254045988035*^9, 3.728254064291301*^9}, 
   3.7282541626904716`*^9},ExpressionUUID->"78345589-a867-4311-af63-\
f73ef84ed850"]
}, Open  ]],

Cell[TextData[{
 "Bishop kindly supplies the sigma-bars for his mean. The demonstration below \
suggests that they\[CloseCurlyQuote]re only reasonable for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "<", "5"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1ef81774-acba-47d4-b81b-34e45a206689"],
 ". My judgment is that Bishop\[CloseCurlyQuote]s ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", "0.09"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f2f57bb2-e974-4a90-a71b-070c3a112b67"],
 " is too large.  "
}], "Text",
 CellChangeTimes->{{3.728047983582913*^9, 3.728048001419952*^9}, {
   3.728048031472519*^9, 3.728048102784032*^9}, 3.728048334620097*^9, {
   3.728048573076227*^9, 
   3.7280485742423983`*^9}},ExpressionUUID->"6009a225-9524-46c2-bd0e-\
5cb7aabcc67b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"gensym", ":", " ", 
       RowBox[{"fresh", " ", "variable", " ", "name"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"terms", "=", 
          RowBox[{"symbolicPowers", "[", 
           RowBox[{"x", ",", "order"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"cs", "=", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "order", "]"}], "/@", 
           RowBox[{"List", "/@", 
            RowBox[{
            "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}]}], ",", 
         RowBox[{"ts", "=", 
          RowBox[{
          "bishopTrainingSet", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bishopMAP", "=", 
            StyleBox[
             RowBox[{"mapMean", "[", 
              RowBox[{
              "\[Alpha]", ",", "\[Beta]", ",", "x", ",", "cs", ",", "ts", ",",
                "order"}], "]"}],
             Background->RGBColor[1, 1, 0]]}], 
           StyleBox[",",
            Background->RGBColor[1, 1, 0]], 
           StyleBox["\[IndentingNewLine]",
            Background->RGBColor[1, 1, 0]], 
           RowBox[{"bishopsSquared", "=", 
            StyleBox[
             RowBox[{"mapsSquared", "[", 
              RowBox[{
              "\[Alpha]", ",", "\[Beta]", ",", "x", ",", "cs", ",", "order"}],
               "]"}],
             Background->RGBColor[1, 1, 0]]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lp", "=", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"bishopTrainingSet", "\[Transpose]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotMarkers", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Graphics", "@", 
                   RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
                    "}"}]}], ",", ".05"}], "}"}]}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Quiet", "@", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"lp", ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"once", " ", "to", " ", "set", " ", "scale"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Plot", "[", 
                 RowBox[{
                  StyleBox[
                   RowBox[{"Sin", "[", 
                    RowBox[{"2.", "\[Pi]", " ", "x"}], "]"}],
                   Background->RGBColor[1, 1, 0]], ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "0.", ",", "1."}], "}"}], ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"Thick", ",", 
                    StyleBox["Green",
                    Background->RGBColor[1, 1, 0]]}], "}"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Plot", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"bishopMAP", ",", 
                    RowBox[{"bishopMAP", "+", "bishopsSquared"}], ",", 
                    RowBox[{"bishopMAP", "-", "bishopsSquared"}]}], "}"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"Magenta", ",", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0", "]"}], ",", "Magenta"}], 
                    "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0", "]"}], ",", "Magenta"}], 
                    "}"}]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Filling", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "2", "}"}]}], ",", 
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "3", "}"}]}]}], "}"}]}]}], "]"}]}], "}"}], 
              ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x\>\"", ",", "\"\<t\>\""}], "}"}]}]}], "]"}]}]}],
           "]"}]}], "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"order", ",", "4", ",", "\"\<polynomial order\>\""}], 
           "}"}], ",", "0", ",", "16", ",", "1", ",", 
          RowBox[{"Appearance", "\[Rule]", 
           RowBox[{"{", "\"\<Labeled\>\"", "}"}]}]}], "}"}], "]"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Alpha]", ",", "0.005", ",", 
            "\"\<\[Alpha] for max posterior\>\""}], "}"}], ",", "0", ",", 
          "0.1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", 
            RowBox[{"1", "/", "0.09"}], ",", 
            "\"\<\[Beta] for max posterior\>\""}], "}"}], ",", 
          "$MachineEpsilon", ",", "40.", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.727884681931381*^9, 3.7278848244947367`*^9}, 
   3.727884861217602*^9, {3.727884975910451*^9, 3.7278849940673532`*^9}, {
   3.727885103521431*^9, 3.727885154698123*^9}, {3.72788520225443*^9, 
   3.727885279820177*^9}, {3.727885496115718*^9, 3.727885517688189*^9}, {
   3.72788559395383*^9, 3.727885598972475*^9}, {3.7278856296542664`*^9, 
   3.727885630876935*^9}, {3.727885695972756*^9, 3.727885696864628*^9}, {
   3.727886633660364*^9, 3.72788671287046*^9}, {3.727886975364171*^9, 
   3.727886975439041*^9}, {3.727903476653379*^9, 3.7279034819231358`*^9}, {
   3.727903531862627*^9, 3.727903539245574*^9}, 3.727913149489944*^9, {
   3.727915429732944*^9, 3.7279154437948627`*^9}, {3.727915750998211*^9, 
   3.7279158447033873`*^9}, {3.7279213832695303`*^9, 3.72792149154887*^9}, {
   3.727921523149373*^9, 3.72792161270367*^9}, {3.72792165300301*^9, 
   3.727921654632832*^9}, {3.727921753282296*^9, 3.727921753360197*^9}, {
   3.727924008558401*^9, 3.727924045018003*^9}, {3.727924293814445*^9, 
   3.727924370827516*^9}, 3.727965590613636*^9, {3.7279686551525917`*^9, 
   3.727968670349081*^9}, {3.7279689406605043`*^9, 3.727969019631563*^9}, {
   3.727970883056108*^9, 3.727970945128386*^9}, {3.727971005813472*^9, 
   3.727971023734253*^9}, {3.727990640753121*^9, 3.727990674786282*^9}, {
   3.727990711779483*^9, 3.727990808626033*^9}, {3.727991307012423*^9, 
   3.727991307022031*^9}, {3.7279932412769613`*^9, 3.7279932949280367`*^9}, {
   3.7279933910397243`*^9, 3.727993398358789*^9}, {3.727993778490755*^9, 
   3.72799379332897*^9}, {3.727993826040863*^9, 3.7279938751552763`*^9}, {
   3.727993956673335*^9, 3.727993958184173*^9}, 3.727994128012043*^9, {
   3.7280354067714148`*^9, 3.7280354258611927`*^9}, {3.728035634299762*^9, 
   3.728035732029833*^9}, {3.72803585641748*^9, 3.728035906176405*^9}, {
   3.728038924314391*^9, 3.728039041653799*^9}, {3.728039077026232*^9, 
   3.72803913265169*^9}, {3.728039194847865*^9, 3.728039320044661*^9}, {
   3.728044256958378*^9, 3.728044343151896*^9}, {3.728044393583234*^9, 
   3.728044466540698*^9}, 3.7280447095836163`*^9, {3.728044856722988*^9, 
   3.728044959527645*^9}, {3.728044995179022*^9, 3.728044998104682*^9}, {
   3.728045028753289*^9, 3.728045063548128*^9}, {3.7280479450113077`*^9, 
   3.728047975077849*^9}, {3.7280486213433113`*^9, 3.728048665726804*^9}, {
   3.728050167431428*^9, 3.7280501824416733`*^9}, {3.728050460654902*^9, 
   3.728050462348349*^9}, {3.728084177336001*^9, 3.728084253566134*^9}, 
   3.728170375547901*^9},ExpressionUUID->"4d4e93ad-1f91-4f93-8ece-\
8d1e86584f92"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`order$$ = 4, $CellContext`\[Alpha]$$ = 
    0.005, $CellContext`\[Beta]$$ = 11.11111111111111, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`order$$], 4, "polynomial order"}, 0, 16, 1}, {{
       Hold[$CellContext`\[Alpha]$$], 0.005, "\[Alpha] for max posterior"}, 0,
       0.1}, {{
       Hold[$CellContext`\[Beta]$$], 11.11111111111111, 
       "\[Beta] for max posterior"}, 2.220446049250313*^-16, 40.}, {
      Hold[
       Grid[{{
          Manipulate`Place[1]}, {
          Manipulate`Place[2]}, {
          Manipulate`Place[3]}}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {540., {168., 175.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`order$3539$$ = 0, $CellContext`\[Alpha]$3540$$ = 
    0, $CellContext`\[Beta]$3541$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`order$$ = 4, $CellContext`\[Alpha]$$ = 
        0.005, $CellContext`\[Beta]$$ = 11.11111111111111}, 
      "ControllerVariables" :> {
        Hold[$CellContext`order$$, $CellContext`order$3539$$, 0], 
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$3540$$, 0], 
        Hold[$CellContext`\[Beta]$$, $CellContext`\[Beta]$3541$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Module[{$CellContext`x$}, 
        With[{$CellContext`terms$ = \
$CellContext`symbolicPowers[$CellContext`x$, $CellContext`order$$], \
$CellContext`cs$ = Map[
            $CellContext`\[Phi][$CellContext`order$$], 
            Map[List, 
             Part[$CellContext`bishopTrainingSet, 1]]], $CellContext`ts$ = 
          Part[$CellContext`bishopTrainingSet, 2]}, 
         With[{$CellContext`bishopMAP$ = $CellContext`mapMean[$CellContext`\
\[Alpha]$$, $CellContext`\[Beta]$$, $CellContext`x$, $CellContext`cs$, \
$CellContext`ts$, $CellContext`order$$], $CellContext`bishopsSquared$ = \
$CellContext`mapsSquared[$CellContext`\[Alpha]$$, $CellContext`\[Beta]$$, \
$CellContext`x$, $CellContext`cs$, $CellContext`order$$]}, 
          With[{$CellContext`lp$ = ListPlot[
              Transpose[$CellContext`bishopTrainingSet], PlotMarkers -> {
                Graphics[{Blue, 
                  Circle[{0, 0}, 1]}], 0.05}]}, 
           Quiet[
            Show[{$CellContext`lp$, 
              Plot[
               Sin[2. Pi $CellContext`x$], {$CellContext`x$, 0., 1.}, 
               PlotStyle -> {Thick, Green}], 
              
              Plot[{$CellContext`bishopMAP$, $CellContext`bishopMAP$ + \
$CellContext`bishopsSquared$, $CellContext`bishopMAP$ - \
$CellContext`bishopsSquared$}, {$CellContext`x$, 0, 1}, 
               PlotStyle -> {Magenta, {Thin, {
                   Opacity[0], Magenta}}, {Thin, {
                   Opacity[0], Magenta}}}, Filling -> {1 -> {2}, 1 -> {3}}]}, 
             Frame -> True, FrameLabel -> {"x", "t"}]]]]]], 
      "Specifications" :> {{{$CellContext`order$$, 4, "polynomial order"}, 0, 
         16, 1, Appearance -> {"Labeled"}, ControlPlacement -> 
         1}, {{$CellContext`\[Alpha]$$, 0.005, "\[Alpha] for max posterior"}, 
         0, 0.1, Appearance -> "Labeled", ControlPlacement -> 
         2}, {{$CellContext`\[Beta]$$, 11.11111111111111, 
          "\[Beta] for max posterior"}, 2.220446049250313*^-16, 40., 
         Appearance -> "Labeled", ControlPlacement -> 3}, 
        Grid[{{
           Manipulate`Place[1]}, {
           Manipulate`Place[2]}, {
           Manipulate`Place[3]}}]}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{606., {262., 271.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.728044305036565*^9, {3.728044344929098*^9, 3.728044354409493*^9}, 
   3.7280444080385323`*^9, 3.728044711982901*^9, {3.7280448605446997`*^9, 
   3.728044874441185*^9}, {3.728044940955202*^9, 3.728044961042498*^9}, 
   3.728045001751472*^9, {3.728045038800642*^9, 3.728045067062736*^9}, 
   3.728046449686543*^9, 3.728048005019208*^9, 3.72804866772539*^9, 
   3.728050233347249*^9, 3.728050463802246*^9, 3.728066472022971*^9, 
   3.728068122215706*^9, 3.728083785679063*^9, 3.728084178834064*^9, {
   3.728084209865189*^9, 3.7280842264353733`*^9}, 3.728084256521707*^9, 
   3.7280907437158613`*^9, 3.728169447328596*^9, 3.7281695422233667`*^9, 
   3.7281698250301447`*^9, 3.7281698849880123`*^9, 3.728170377197115*^9, 
   3.7282529575876427`*^9},ExpressionUUID->"edfd8614-111a-4d0f-9007-\
d704ac437e98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"gensym", ":", " ", 
       RowBox[{"fresh", " ", "variable", " ", "name"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"terms", "=", 
          RowBox[{"symbolicPowers", "[", 
           RowBox[{"x", ",", "order"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"cs", "=", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "order", "]"}], "/@", 
           RowBox[{"List", "/@", 
            RowBox[{
            "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}]}], ",", 
         RowBox[{"ts", "=", 
          RowBox[{"bishopTrainingSet", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"recurrent", "=", 
            RowBox[{"Quiet", "@", 
             RowBox[{
              RowBox[{"rlsFit", "[", 
               SuperscriptBox["10", 
                RowBox[{"-", "logMinInfo"}]], "]"}], "[", 
              RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"normal", "=", 
            RowBox[{"mleFit", "[", 
             RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"kalman", "=", 
            RowBox[{
             RowBox[{"kalFit", "[", 
              RowBox[{
               SuperscriptBox["bishopFakeSigma", "2"], ",", 
               SuperscriptBox["10", "logSigmaXSquared"]}], "]"}], "[", 
             RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rlsFn", "=", 
              RowBox[{
               RowBox[{"{", "terms", "}"}], ".", 
               RowBox[{
               "recurrent", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mleFn", "=", 
              RowBox[{"terms", ".", "normal"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"kalFn", "=", 
              RowBox[{
               RowBox[{"{", "terms", "}"}], ".", 
               RowBox[{
               "kalman", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"bishopMAP", "=", 
              RowBox[{"mapMean", "[", 
               RowBox[{
               "\[Alpha]", ",", "\[Beta]", ",", "x", ",", "cs", ",", "ts", 
                ",", "order"}], "]"}]}], ",", 
             StyleBox["\[IndentingNewLine]",
              Background->RGBColor[1, 1, 0]], 
             RowBox[{"bishopsSquared", "=", 
              RowBox[{"mapsSquared", "[", 
               RowBox[{
               "\[Alpha]", ",", "\[Beta]", ",", "x", ",", "cs", ",", 
                "order"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"lp", "=", 
               RowBox[{"ListPlot", "[", 
                RowBox[{
                 RowBox[{"bishopTrainingSet", "\[Transpose]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PlotMarkers", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Graphics", "@", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
                    "}"}]}], ",", ".05"}], "}"}]}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"showlist", "=", 
                 RowBox[{"{", 
                  RowBox[{"lp", ",", 
                   RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox[
                    RowBox[{"Sin", "[", 
                    RowBox[{"2.", "\[Pi]", " ", "x"}], "]"}],
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0.", ",", "1."}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", 
                    StyleBox["Green",
                    Background->RGBColor[1, 1, 0]]}], "}"}]}]}], "]"}]}], 
                  "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"recurrentQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["rlsFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Purple",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"normalQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["mleFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Orange",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"kalmanQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["kalFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Cyan",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"bishopMapQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    StyleBox["bishopMAP",
                    Background->RGBColor[1, 1, 0]], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"bishopMAP", "+", "bishopsSquared"}], ",", 
                    RowBox[{"bishopMAP", "-", "bishopsSquared"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0", "]"}], ",", "Magenta"}], 
                    "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0", "]"}], ",", "Magenta"}], 
                    "}"}]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Filling", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "2", "}"}]}], ",", 
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "3", "}"}]}]}], "}"}]}]}], "]"}]}], "]"}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"Show", "[", 
                  RowBox[{"showlist", ",", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<x\>\"", ",", "\"\<t\>\""}], "}"}]}]}], 
                  "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"recurrentQ", ",", "False", ",", "\"\<RLS\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"normalQ", ",", "False", ",", "\"\<MLE\>\""}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"kalmanQ", ",", "False", ",", "\"\<KAL\>\""}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"bishopMapQ", ",", "True", ",", "\"\<MAP\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "}"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], ",", "\"\<\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"order", ",", "4", ",", "\"\<polynomial order\>\""}], 
            "}"}], ",", "0", ",", "16", ",", "1", ",", 
           RowBox[{"Appearance", "\[Rule]", 
            RowBox[{"{", "\"\<Labeled\>\"", "}"}]}]}], "}"}], "]"}], ",", 
        "\"\<\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "logMinInfo", ",", "3", ",", "\"\<-log a-priori info (RLS)\>\""}], 
           "}"}], ",", "0", ",", "16", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "logSigmaXSquared", ",", "3", ",", 
            "\"\<log a-priori cov (KAL)\>\""}], "}"}], ",", "0", ",", "16", 
          ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Alpha]", ",", "0.005", ",", 
            "\"\<\[Alpha] for max posterior\>\""}], "}"}], ",", "0", ",", 
          "0.1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", 
            RowBox[{"1", "/", "0.09"}], ",", 
            "\"\<\[Beta] for max posterior\>\""}], "}"}], ",", 
          "$MachineEpsilon", ",", "100.", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.727884681931381*^9, 3.7278848244947367`*^9}, 
   3.727884861217602*^9, {3.727884975910451*^9, 3.7278849940673532`*^9}, {
   3.727885103521431*^9, 3.727885154698123*^9}, {3.72788520225443*^9, 
   3.727885279820177*^9}, {3.727885496115718*^9, 3.727885517688189*^9}, {
   3.72788559395383*^9, 3.727885598972475*^9}, {3.7278856296542664`*^9, 
   3.727885630876935*^9}, {3.727885695972756*^9, 3.727885696864628*^9}, {
   3.727886633660364*^9, 3.72788671287046*^9}, {3.727886975364171*^9, 
   3.727886975439041*^9}, {3.727903476653379*^9, 3.7279034819231358`*^9}, {
   3.727903531862627*^9, 3.727903539245574*^9}, 3.727913149489944*^9, {
   3.727915429732944*^9, 3.7279154437948627`*^9}, {3.727915750998211*^9, 
   3.7279158447033873`*^9}, {3.7279213832695303`*^9, 3.72792149154887*^9}, {
   3.727921523149373*^9, 3.72792161270367*^9}, {3.72792165300301*^9, 
   3.727921654632832*^9}, {3.727921753282296*^9, 3.727921753360197*^9}, {
   3.727924008558401*^9, 3.727924045018003*^9}, {3.727924293814445*^9, 
   3.727924370827516*^9}, 3.727965590613636*^9, {3.7279686551525917`*^9, 
   3.727968670349081*^9}, {3.7279689406605043`*^9, 3.727969019631563*^9}, {
   3.727970883056108*^9, 3.727970945128386*^9}, {3.727971005813472*^9, 
   3.727971023734253*^9}, {3.727990640753121*^9, 3.727990674786282*^9}, {
   3.727990711779483*^9, 3.727990808626033*^9}, {3.727991307012423*^9, 
   3.727991307022031*^9}, {3.7279932412769613`*^9, 3.7279932949280367`*^9}, {
   3.7279933910397243`*^9, 3.727993398358789*^9}, {3.727993778490755*^9, 
   3.72799379332897*^9}, {3.727993826040863*^9, 3.7279938751552763`*^9}, {
   3.727993956673335*^9, 3.727993958184173*^9}, 3.727994128012043*^9, {
   3.7280354067714148`*^9, 3.7280354258611927`*^9}, {3.728035634299762*^9, 
   3.728035732029833*^9}, {3.72803585641748*^9, 3.728035906176405*^9}, {
   3.728038924314391*^9, 3.728039041653799*^9}, {3.728039077026232*^9, 
   3.72803913265169*^9}, {3.728039194847865*^9, 3.728039320044661*^9}, {
   3.728044256958378*^9, 3.728044343151896*^9}, {3.728044393583234*^9, 
   3.728044466540698*^9}, 3.7280447095836163`*^9, {3.728044856722988*^9, 
   3.728044959527645*^9}, {3.728044995179022*^9, 3.728044998104682*^9}, {
   3.728045028753289*^9, 3.728045063548128*^9}, {3.728045464570526*^9, 
   3.728045476328084*^9}, {3.728045812340419*^9, 3.728045836978776*^9}, {
   3.7280461335391397`*^9, 3.728046355530389*^9}, {3.728046392282709*^9, 
   3.728046397281275*^9}, {3.728046429888109*^9, 3.728046434285967*^9}, {
   3.728046509047914*^9, 3.728046577986915*^9}, {3.728048625582951*^9, 
   3.728048658147644*^9}, {3.728048704639155*^9, 3.7280487209829884`*^9}, {
   3.728048763333255*^9, 3.728048783520523*^9}, 3.728048849900649*^9, {
   3.728048881350296*^9, 3.7280488887365723`*^9}, {3.7280489358794527`*^9, 
   3.728048947834031*^9}, {3.7280492952517767`*^9, 3.728049427179392*^9}, {
   3.728049506853256*^9, 3.7280496162697783`*^9}, {3.728050270046998*^9, 
   3.728050280821505*^9}, {3.728050374367243*^9, 3.7280504490849867`*^9}, {
   3.7280841313259077`*^9, 3.7280841364907084`*^9}, {3.728084263762005*^9, 
   3.728084272266337*^9}, {3.728084308215811*^9, 3.728084351165839*^9}, {
   3.728089900288107*^9, 3.728089901166031*^9}, {3.728090725859085*^9, 
   3.728090725869628*^9}, {3.728169349816976*^9, 3.72816934984126*^9}, {
   3.7281694010151167`*^9, 3.728169417843541*^9}, {3.728169511811088*^9, 
   3.728169523699912*^9}, {3.7281696127342587`*^9, 3.728169630658332*^9}, 
   3.728253982558025*^9},ExpressionUUID->"3bc18cb1-77ae-46f8-b25f-\
3f87d6e0edd8"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bishopMapQ$$ = 
    True, $CellContext`kalmanQ$$ = False, $CellContext`logMinInfo$$ = 
    3, $CellContext`logSigmaXSquared$$ = 3, $CellContext`normalQ$$ = 
    False, $CellContext`order$$ = 4, $CellContext`recurrentQ$$ = 
    False, $CellContext`\[Alpha]$$ = 0.005, $CellContext`\[Beta]$$ = 
    11.11111111111111, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`recurrentQ$$], False, "RLS"}, {True, False}}, {{
       Hold[$CellContext`normalQ$$], False, "MLE"}, {True, False}}, {{
       Hold[$CellContext`kalmanQ$$], False, "KAL"}, {True, False}}, {{
       Hold[$CellContext`bishopMapQ$$], True, "MAP"}, {True, False}}, {{
       Hold[$CellContext`order$$], 4, "polynomial order"}, 0, 16, 1}, {{
       Hold[$CellContext`logMinInfo$$], 3, "-log a-priori info (REC)"}, 0, 
      16}, {{
       Hold[$CellContext`logSigmaXSquared$$], 3, "log a-priori cov (KAL)"}, 0,
       16}, {{
       Hold[$CellContext`\[Alpha]$$], 0.005, "\[Alpha] for max posterior"}, 0,
       0.1}, {{
       Hold[$CellContext`\[Beta]$$], 11.11111111111111, 
       "\[Beta] for max posterior"}, 2.220446049250313*^-16, 100.}, {
      Hold[
       Grid[{{
          Grid[{{
             Manipulate`Place[1], 
             Manipulate`Place[2], 
             Manipulate`Place[3], 
             Manipulate`Place[4]}}, Frame -> All], ""}, {
          Manipulate`Place[5], ""}, {
          Manipulate`Place[6]}, {
          Manipulate`Place[7]}, {
          Manipulate`Place[8]}, {
          Manipulate`Place[9]}}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {540., {168., 175.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`recurrentQ$3710$$ = 
    False, $CellContext`normalQ$3711$$ = False, $CellContext`kalmanQ$3712$$ = 
    False, $CellContext`bishopMapQ$3713$$ = False, $CellContext`order$3714$$ =
     0, $CellContext`logMinInfo$3715$$ = 
    0, $CellContext`logSigmaXSquared$3716$$ = 
    0, $CellContext`\[Alpha]$3717$$ = 0, $CellContext`\[Beta]$3718$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`bishopMapQ$$ = 
        True, $CellContext`kalmanQ$$ = False, $CellContext`logMinInfo$$ = 
        3, $CellContext`logSigmaXSquared$$ = 3, $CellContext`normalQ$$ = 
        False, $CellContext`order$$ = 4, $CellContext`recurrentQ$$ = 
        False, $CellContext`\[Alpha]$$ = 0.005, $CellContext`\[Beta]$$ = 
        11.11111111111111}, "ControllerVariables" :> {
        Hold[$CellContext`recurrentQ$$, $CellContext`recurrentQ$3710$$, 
         False], 
        Hold[$CellContext`normalQ$$, $CellContext`normalQ$3711$$, False], 
        Hold[$CellContext`kalmanQ$$, $CellContext`kalmanQ$3712$$, False], 
        Hold[$CellContext`bishopMapQ$$, $CellContext`bishopMapQ$3713$$, 
         False], 
        Hold[$CellContext`order$$, $CellContext`order$3714$$, 0], 
        Hold[$CellContext`logMinInfo$$, $CellContext`logMinInfo$3715$$, 0], 
        Hold[$CellContext`logSigmaXSquared$$, \
$CellContext`logSigmaXSquared$3716$$, 0], 
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$3717$$, 0], 
        Hold[$CellContext`\[Beta]$$, $CellContext`\[Beta]$3718$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Module[{$CellContext`x$}, 
        With[{$CellContext`terms$ = \
$CellContext`symbolicPowers[$CellContext`x$, $CellContext`order$$], \
$CellContext`cs$ = Map[
            $CellContext`\[Phi][$CellContext`order$$], 
            Map[List, 
             Part[$CellContext`bishopTrainingSet, 1]]], $CellContext`ts$ = 
          Part[$CellContext`bishopTrainingSet, 2]}, 
         With[{$CellContext`recurrent$ = Quiet[
             $CellContext`rlsFit[
             10^(-$CellContext`logMinInfo$$)][$CellContext`order$$, \
$CellContext`bishopTrainingSet]], $CellContext`normal$ = \
$CellContext`mleFit[$CellContext`order$$, $CellContext`bishopTrainingSet], \
$CellContext`kalman$ = $CellContext`kalFit[$CellContext`bishopFakeSigma^2, 
             10^$CellContext`logSigmaXSquared$$][$CellContext`order$$, \
$CellContext`bishopTrainingSet]}, 
          With[{$CellContext`rlsFn$ = Dot[{$CellContext`terms$}, 
              Part[$CellContext`recurrent$, 1]], $CellContext`mleFn$ = 
            Dot[$CellContext`terms$, $CellContext`normal$], \
$CellContext`kalFn$ = Dot[{$CellContext`terms$}, 
              
              Part[$CellContext`kalman$, 
               1]], $CellContext`bishopMAP$ = \
$CellContext`mapMean[$CellContext`\[Alpha]$$, $CellContext`\[Beta]$$, \
$CellContext`x$, $CellContext`cs$, $CellContext`ts$, $CellContext`order$$], \
$CellContext`bishopsSquared$ = \
$CellContext`mapsSquared[$CellContext`\[Alpha]$$, $CellContext`\[Beta]$$, \
$CellContext`x$, $CellContext`cs$, $CellContext`order$$]}, 
           With[{$CellContext`lp$ = ListPlot[
               Transpose[$CellContext`bishopTrainingSet], PlotMarkers -> {
                 Graphics[{Blue, 
                   Circle[{0, 0}, 1]}], 0.05}]}, 
            Module[{$CellContext`showlist$ = {$CellContext`lp$, 
                Plot[
                 Sin[2. Pi $CellContext`x$], {$CellContext`x$, 0., 1.}, 
                 PlotStyle -> {Thick, Green}]}}, If[$CellContext`recurrentQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`rlsFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Purple}]]]; If[$CellContext`normalQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`mleFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Orange}]]]; If[$CellContext`kalmanQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`kalFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Cyan}]]]; If[$CellContext`bishopMapQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[{$CellContext`bishopMAP$, $CellContext`bishopMAP$ + \
$CellContext`bishopsSquared$, $CellContext`bishopMAP$ - \
$CellContext`bishopsSquared$}, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Magenta, {Thin, {
                    Opacity[0], Magenta}}, {Thin, {
                    Opacity[0], Magenta}}}, 
                 Filling -> {1 -> {2}, 1 -> {3}}]]]; Quiet[
               
               Show[$CellContext`showlist$, Frame -> True, 
                FrameLabel -> {"x", "t"}]]]]]]]], 
      "Specifications" :> {{{$CellContext`recurrentQ$$, False, "RLS"}, {
         True, False}, ControlPlacement -> 
         1}, {{$CellContext`normalQ$$, False, "MLE"}, {True, False}, 
         ControlPlacement -> 2}, {{$CellContext`kalmanQ$$, False, "KAL"}, {
         True, False}, ControlPlacement -> 
         3}, {{$CellContext`bishopMapQ$$, True, "MAP"}, {True, False}, 
         ControlPlacement -> 
         4}, {{$CellContext`order$$, 4, "polynomial order"}, 0, 16, 1, 
         Appearance -> {"Labeled"}, ControlPlacement -> 
         5}, {{$CellContext`logMinInfo$$, 3, "-log a-priori info (REC)"}, 0, 
         16, Appearance -> "Labeled", ControlPlacement -> 
         6}, {{$CellContext`logSigmaXSquared$$, 3, "log a-priori cov (KAL)"}, 
         0, 16, Appearance -> "Labeled", ControlPlacement -> 
         7}, {{$CellContext`\[Alpha]$$, 0.005, "\[Alpha] for max posterior"}, 
         0, 0.1, Appearance -> "Labeled", ControlPlacement -> 
         8}, {{$CellContext`\[Beta]$$, 11.11111111111111, 
          "\[Beta] for max posterior"}, 2.220446049250313*^-16, 100., 
         Appearance -> "Labeled", ControlPlacement -> 9}, 
        Grid[{{
           Grid[{{
              Manipulate`Place[1], 
              Manipulate`Place[2], 
              Manipulate`Place[3], 
              Manipulate`Place[4]}}, Frame -> All], ""}, {
           Manipulate`Place[5], ""}, {
           Manipulate`Place[6]}, {
           Manipulate`Place[7]}, {
           Manipulate`Place[8]}, {
           Manipulate`Place[9]}}]}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{606., {312., 321.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.728048857877192*^9, 3.7280488736729794`*^9}, 
   3.72804890582504*^9, 3.728049332020051*^9, 3.728049430279049*^9, 
   3.728049508948903*^9, 3.72804955515339*^9, {3.728049604418832*^9, 
   3.728049617723418*^9}, {3.728050354411237*^9, 3.7280504514054193`*^9}, 
   3.7280664722383747`*^9, 3.728068122425*^9, 3.728083785863311*^9, 
   3.7280840894217863`*^9, 3.728084144080505*^9, {3.728084273427134*^9, 
   3.7280842819964743`*^9}, 3.728084353690404*^9, 3.728089902341527*^9, 
   3.728090743895391*^9, 3.72816944755794*^9, 3.728169542288705*^9, 
   3.7281698252466803`*^9, 3.7281698851714067`*^9, 
   3.728252957819512*^9},ExpressionUUID->"d3cc2ef8-20f9-4441-b114-\
2b19bdc08410"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"gensym", ":", " ", 
       RowBox[{"fresh", " ", "variable", " ", "name"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"terms", "=", 
          RowBox[{"symbolicPowers", "[", 
           RowBox[{"x", ",", "order"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"cs", "=", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "order", "]"}], "/@", 
           RowBox[{"List", "/@", 
            RowBox[{
            "bishopTrainingSet", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}]}], ",", 
         RowBox[{"ts", "=", 
          RowBox[{"bishopTrainingSet", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"recurrent", "=", 
            RowBox[{"Quiet", "@", 
             RowBox[{
              RowBox[{"rlsFit", "[", 
               SuperscriptBox["10", 
                RowBox[{"-", "logMinInfo"}]], "]"}], "[", 
              RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"normal", "=", 
            RowBox[{"mleFit", "[", 
             RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"kalman", "=", 
            RowBox[{
             RowBox[{"kalFit", "[", 
              RowBox[{
               SuperscriptBox["bishopFakeSigma", "2"], ",", 
               SuperscriptBox["10", "logSigmaXSquared"]}], "]"}], "[", 
             RowBox[{"order", ",", "bishopTrainingSet"}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rlsFn", "=", 
              RowBox[{
               RowBox[{"{", "terms", "}"}], ".", 
               RowBox[{
               "recurrent", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mleFn", "=", 
              RowBox[{"terms", ".", "normal"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"kalFn", "=", 
              RowBox[{
               RowBox[{"{", "terms", "}"}], ".", 
               RowBox[{
               "kalman", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"kalmansSquared", "=", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\[Sigma]s", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Sqrt", "@", 
                    RowBox[{"kalman", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "i", ",", "i"}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"order", "+", "1"}]}], "}"}]}], "]"}]}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", "terms", "}"}], ".", "\[Sigma]s"}]}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"bishopMAP", "=", 
              RowBox[{"mapMean", "[", 
               RowBox[{
               "\[Alpha]", ",", "\[Beta]", ",", "x", ",", "cs", ",", "ts", 
                ",", "order"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"bishopsSquared", "=", 
              RowBox[{"mapsSquared", "[", 
               RowBox[{
               "\[Alpha]", ",", "\[Beta]", ",", "x", ",", "cs", ",", 
                "order"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"lp", "=", 
               RowBox[{"ListPlot", "[", 
                RowBox[{
                 RowBox[{"bishopTrainingSet", "\[Transpose]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PlotMarkers", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Graphics", "@", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
                    "}"}]}], ",", ".05"}], "}"}]}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"showlist", "=", 
                 RowBox[{"{", 
                  RowBox[{"lp", ",", 
                   RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox[
                    RowBox[{"Sin", "[", 
                    RowBox[{"2.", "\[Pi]", " ", "x"}], "]"}],
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0.", ",", "1."}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", 
                    StyleBox["Green",
                    Background->RGBColor[1, 1, 0]]}], "}"}]}]}], "]"}]}], 
                  "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"recurrentQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["rlsFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Purple",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"normalQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    StyleBox["mleFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    StyleBox["Orange",
                    Background->RGBColor[1, 1, 0]], "}"}]}]}], "]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"kalmanQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    StyleBox["kalFn",
                    Background->RGBColor[1, 1, 0]], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"kalFn", "+", "kalmansSquared"}], ",", 
                    RowBox[{"kalFn", "-", "kalmansSquared"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    StyleBox["Cyan",
                    Background->RGBColor[1, 1, 0]], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0", "]"}], ",", "Cyan"}], 
                    "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0", "]"}], ",", "Cyan"}], 
                    "}"}]}], "}"}]}], "}"}]}]}], "]"}]}], "]"}]}], "]"}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"bishopMapQ", ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"showlist", ",", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    StyleBox["bishopMAP",
                    Background->RGBColor[1, 1, 0]], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"bishopMAP", "+", "bishopsSquared"}], ",", 
                    RowBox[{"bishopMAP", "-", "bishopsSquared"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    StyleBox["Magenta",
                    Background->RGBColor[1, 1, 0]], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0", "]"}], ",", "Magenta"}], 
                    "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0", "]"}], ",", "Magenta"}], 
                    "}"}]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Filling", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "2", "}"}]}], ",", 
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "3", "}"}]}]}], "}"}]}]}], "]"}]}], "]"}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"Show", "[", 
                  RowBox[{"showlist", ",", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<x\>\"", ",", "\"\<t\>\""}], "}"}]}]}], 
                  "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"recurrentQ", ",", "False", ",", "\"\<RLS\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"normalQ", ",", "False", ",", "\"\<MLE\>\""}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"kalmanQ", ",", "False", ",", "\"\<KAL\>\""}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"bishopMapQ", ",", "True", ",", "\"\<MAP\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "}"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], ",", "\"\<\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"order", ",", "4", ",", "\"\<polynomial order\>\""}], 
            "}"}], ",", "0", ",", "16", ",", "1", ",", 
           RowBox[{"Appearance", "\[Rule]", 
            RowBox[{"{", "\"\<Labeled\>\"", "}"}]}]}], "}"}], "]"}], ",", 
        "\"\<\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "logMinInfo", ",", "3", ",", "\"\<-log a-priori info (RLS)\>\""}], 
           "}"}], ",", "0", ",", "16", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "logSigmaXSquared", ",", "3", ",", 
            "\"\<log a-priori cov (KAL)\>\""}], "}"}], ",", "0", ",", "16", 
          ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Alpha]", ",", "0.005", ",", 
            "\"\<\[Alpha] for max posterior\>\""}], "}"}], ",", "0", ",", 
          "0.1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", 
            RowBox[{"1", "/", "0.09"}], ",", 
            "\"\<\[Beta] for max posterior\>\""}], "}"}], ",", 
          "$MachineEpsilon", ",", "100.", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], "}"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.727884681931381*^9, 3.7278848244947367`*^9}, 
   3.727884861217602*^9, {3.727884975910451*^9, 3.7278849940673532`*^9}, {
   3.727885103521431*^9, 3.727885154698123*^9}, {3.72788520225443*^9, 
   3.727885279820177*^9}, {3.727885496115718*^9, 3.727885517688189*^9}, {
   3.72788559395383*^9, 3.727885598972475*^9}, {3.7278856296542664`*^9, 
   3.727885630876935*^9}, {3.727885695972756*^9, 3.727885696864628*^9}, {
   3.727886633660364*^9, 3.72788671287046*^9}, {3.727886975364171*^9, 
   3.727886975439041*^9}, {3.727903476653379*^9, 3.7279034819231358`*^9}, {
   3.727903531862627*^9, 3.727903539245574*^9}, 3.727913149489944*^9, {
   3.727915429732944*^9, 3.7279154437948627`*^9}, {3.727915750998211*^9, 
   3.7279158447033873`*^9}, {3.7279213832695303`*^9, 3.72792149154887*^9}, {
   3.727921523149373*^9, 3.72792161270367*^9}, {3.72792165300301*^9, 
   3.727921654632832*^9}, {3.727921753282296*^9, 3.727921753360197*^9}, {
   3.727924008558401*^9, 3.727924045018003*^9}, {3.727924293814445*^9, 
   3.727924370827516*^9}, 3.727965590613636*^9, {3.7279686551525917`*^9, 
   3.727968670349081*^9}, {3.7279689406605043`*^9, 3.727969019631563*^9}, {
   3.727970883056108*^9, 3.727970945128386*^9}, {3.727971005813472*^9, 
   3.727971023734253*^9}, {3.727990640753121*^9, 3.727990674786282*^9}, {
   3.727990711779483*^9, 3.727990808626033*^9}, {3.727991307012423*^9, 
   3.727991307022031*^9}, {3.7279932412769613`*^9, 3.7279932949280367`*^9}, {
   3.7279933910397243`*^9, 3.727993398358789*^9}, {3.727993778490755*^9, 
   3.72799379332897*^9}, {3.727993826040863*^9, 3.7279938751552763`*^9}, {
   3.727993956673335*^9, 3.727993958184173*^9}, 3.727994128012043*^9, {
   3.7280354067714148`*^9, 3.7280354258611927`*^9}, {3.728035634299762*^9, 
   3.728035732029833*^9}, {3.72803585641748*^9, 3.728035906176405*^9}, {
   3.728038924314391*^9, 3.728039041653799*^9}, {3.728039077026232*^9, 
   3.72803913265169*^9}, {3.728039194847865*^9, 3.728039320044661*^9}, {
   3.728044256958378*^9, 3.728044343151896*^9}, {3.728044393583234*^9, 
   3.728044466540698*^9}, 3.7280447095836163`*^9, {3.728044856722988*^9, 
   3.728044959527645*^9}, {3.728044995179022*^9, 3.728044998104682*^9}, {
   3.728045028753289*^9, 3.728045063548128*^9}, {3.728045464570526*^9, 
   3.728045476328084*^9}, {3.728045812340419*^9, 3.728045836978776*^9}, {
   3.7280461335391397`*^9, 3.728046355530389*^9}, {3.728046392282709*^9, 
   3.728046397281275*^9}, {3.728046429888109*^9, 3.728046434285967*^9}, {
   3.728046509047914*^9, 3.728046577986915*^9}, {3.728048625582951*^9, 
   3.728048658147644*^9}, {3.728048704639155*^9, 3.7280487209829884`*^9}, {
   3.728048763333255*^9, 3.728048783520523*^9}, 3.728048849900649*^9, {
   3.728048881350296*^9, 3.7280488887365723`*^9}, {3.7280489358794527`*^9, 
   3.728048947834031*^9}, {3.7280492952517767`*^9, 3.728049427179392*^9}, {
   3.728049506853256*^9, 3.7280496162697783`*^9}, {3.728050270046998*^9, 
   3.728050280821505*^9}, {3.728050374367243*^9, 3.7280504490849867`*^9}, {
   3.7280841313259077`*^9, 3.7280841364907084`*^9}, {3.728084263762005*^9, 
   3.728084272266337*^9}, {3.728084308215811*^9, 3.728084351165839*^9}, {
   3.7280844633182163`*^9, 3.728084477828768*^9}, {3.728085383842945*^9, 
   3.728085490763743*^9}, {3.728085536512591*^9, 3.728085596592622*^9}, {
   3.728085633622974*^9, 3.7280856589483767`*^9}, {3.7280857040292797`*^9, 
   3.728085737693431*^9}, {3.728085779779517*^9, 3.728085819776963*^9}, {
   3.728085854221978*^9, 3.728085977487178*^9}, {3.7280860544134827`*^9, 
   3.7280860549177732`*^9}, {3.728089929087613*^9, 3.728089929819048*^9}, {
   3.728090725880845*^9, 3.728090725892352*^9}, {3.728169349869088*^9, 
   3.728169349894442*^9}, {3.728169400966996*^9, 3.728169417877818*^9}, {
   3.728169511764361*^9, 3.728169523710473*^9}, {3.728169612906951*^9, 
   3.728169630679298*^9}, 
   3.7282539825927687`*^9},ExpressionUUID->"336cfd34-044f-4091-918e-\
1cb6cb1e990b"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bishopMapQ$$ = 
    True, $CellContext`kalmanQ$$ = False, $CellContext`logMinInfo$$ = 
    3, $CellContext`logSigmaXSquared$$ = 3, $CellContext`normalQ$$ = 
    False, $CellContext`order$$ = 4, $CellContext`recurrentQ$$ = 
    False, $CellContext`\[Alpha]$$ = 0.005, $CellContext`\[Beta]$$ = 
    11.11111111111111, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`recurrentQ$$], False, "RLS"}, {True, False}}, {{
       Hold[$CellContext`normalQ$$], False, "MLE"}, {True, False}}, {{
       Hold[$CellContext`kalmanQ$$], False, "KAL"}, {True, False}}, {{
       Hold[$CellContext`bishopMapQ$$], True, "MAP"}, {True, False}}, {{
       Hold[$CellContext`order$$], 4, "polynomial order"}, 0, 16, 1}, {{
       Hold[$CellContext`logMinInfo$$], 3, "-log a-priori info (REC)"}, 0, 
      16}, {{
       Hold[$CellContext`logSigmaXSquared$$], 3, "log a-priori cov (KAL)"}, 0,
       16}, {{
       Hold[$CellContext`\[Alpha]$$], 0.005, "\[Alpha] for max posterior"}, 0,
       0.1}, {{
       Hold[$CellContext`\[Beta]$$], 11.11111111111111, 
       "\[Beta] for max posterior"}, 2.220446049250313*^-16, 100.}, {
      Hold[
       Grid[{{
          Grid[{{
             Manipulate`Place[1], 
             Manipulate`Place[2], 
             Manipulate`Place[3], 
             Manipulate`Place[4]}}, Frame -> All], ""}, {
          Manipulate`Place[5], ""}, {
          Manipulate`Place[6]}, {
          Manipulate`Place[7]}, {
          Manipulate`Place[8]}, {
          Manipulate`Place[9]}}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {540., {168., 175.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`recurrentQ$3913$$ = 
    False, $CellContext`normalQ$3914$$ = False, $CellContext`kalmanQ$3915$$ = 
    False, $CellContext`bishopMapQ$3916$$ = False, $CellContext`order$3917$$ =
     0, $CellContext`logMinInfo$3918$$ = 
    0, $CellContext`logSigmaXSquared$3919$$ = 
    0, $CellContext`\[Alpha]$3920$$ = 0, $CellContext`\[Beta]$3921$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`bishopMapQ$$ = 
        True, $CellContext`kalmanQ$$ = False, $CellContext`logMinInfo$$ = 
        3, $CellContext`logSigmaXSquared$$ = 3, $CellContext`normalQ$$ = 
        False, $CellContext`order$$ = 4, $CellContext`recurrentQ$$ = 
        False, $CellContext`\[Alpha]$$ = 0.005, $CellContext`\[Beta]$$ = 
        11.11111111111111}, "ControllerVariables" :> {
        Hold[$CellContext`recurrentQ$$, $CellContext`recurrentQ$3913$$, 
         False], 
        Hold[$CellContext`normalQ$$, $CellContext`normalQ$3914$$, False], 
        Hold[$CellContext`kalmanQ$$, $CellContext`kalmanQ$3915$$, False], 
        Hold[$CellContext`bishopMapQ$$, $CellContext`bishopMapQ$3916$$, 
         False], 
        Hold[$CellContext`order$$, $CellContext`order$3917$$, 0], 
        Hold[$CellContext`logMinInfo$$, $CellContext`logMinInfo$3918$$, 0], 
        Hold[$CellContext`logSigmaXSquared$$, \
$CellContext`logSigmaXSquared$3919$$, 0], 
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$3920$$, 0], 
        Hold[$CellContext`\[Beta]$$, $CellContext`\[Beta]$3921$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Module[{$CellContext`x$}, 
        With[{$CellContext`terms$ = \
$CellContext`symbolicPowers[$CellContext`x$, $CellContext`order$$], \
$CellContext`cs$ = Map[
            $CellContext`\[Phi][$CellContext`order$$], 
            Map[List, 
             Part[$CellContext`bishopTrainingSet, 1]]], $CellContext`ts$ = 
          Part[$CellContext`bishopTrainingSet, 2]}, 
         With[{$CellContext`recurrent$ = Quiet[
             $CellContext`rlsFit[
             10^(-$CellContext`logMinInfo$$)][$CellContext`order$$, \
$CellContext`bishopTrainingSet]], $CellContext`normal$ = \
$CellContext`mleFit[$CellContext`order$$, $CellContext`bishopTrainingSet], \
$CellContext`kalman$ = $CellContext`kalFit[$CellContext`bishopFakeSigma^2, 
             10^$CellContext`logSigmaXSquared$$][$CellContext`order$$, \
$CellContext`bishopTrainingSet]}, 
          With[{$CellContext`rlsFn$ = Dot[{$CellContext`terms$}, 
              Part[$CellContext`recurrent$, 1]], $CellContext`mleFn$ = 
            Dot[$CellContext`terms$, $CellContext`normal$], \
$CellContext`kalFn$ = Dot[{$CellContext`terms$}, 
              Part[$CellContext`kalman$, 1]], $CellContext`kalmansSquared$ = 
            With[{$CellContext`\[Sigma]s$ = Table[
                 Sqrt[
                  
                  Part[$CellContext`kalman$, 
                   2, $CellContext`i, $CellContext`i]], {$CellContext`i, \
$CellContext`order$$ + 1}]}, 
              
              Dot[{$CellContext`terms$}, $CellContext`\[Sigma]s$]], \
$CellContext`bishopMAP$ = $CellContext`mapMean[$CellContext`\[Alpha]$$, \
$CellContext`\[Beta]$$, $CellContext`x$, $CellContext`cs$, $CellContext`ts$, \
$CellContext`order$$], $CellContext`bishopsSquared$ = \
$CellContext`mapsSquared[$CellContext`\[Alpha]$$, $CellContext`\[Beta]$$, \
$CellContext`x$, $CellContext`cs$, $CellContext`order$$]}, 
           With[{$CellContext`lp$ = ListPlot[
               Transpose[$CellContext`bishopTrainingSet], PlotMarkers -> {
                 Graphics[{Blue, 
                   Circle[{0, 0}, 1]}], 0.05}]}, 
            Module[{$CellContext`showlist$ = {$CellContext`lp$, 
                Plot[
                 Sin[2. Pi $CellContext`x$], {$CellContext`x$, 0., 1.}, 
                 PlotStyle -> {Thick, Green}]}}, If[$CellContext`recurrentQ$$, 
               AppendTo[$CellContext`showlist$, 
                Plot[$CellContext`rlsFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Purple}]]]; If[$CellContext`normalQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[$CellContext`mleFn$, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Orange}]]]; If[$CellContext`kalmanQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[{$CellContext`kalFn$, $CellContext`kalFn$ + \
$CellContext`kalmansSquared$, $CellContext`kalFn$ - \
$CellContext`kalmansSquared$}, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Cyan, {Thin, {
                    Opacity[0], Cyan}}, {Thin, {
                    Opacity[0], Cyan}}}]]]; If[$CellContext`bishopMapQ$$, 
               AppendTo[$CellContext`showlist$, 
                
                Plot[{$CellContext`bishopMAP$, $CellContext`bishopMAP$ + \
$CellContext`bishopsSquared$, $CellContext`bishopMAP$ - \
$CellContext`bishopsSquared$}, {$CellContext`x$, 0, 1}, 
                 PlotStyle -> {Magenta, {Thin, {
                    Opacity[0], Magenta}}, {Thin, {
                    Opacity[0], Magenta}}}, 
                 Filling -> {1 -> {2}, 1 -> {3}}]]]; Quiet[
               
               Show[$CellContext`showlist$, Frame -> True, 
                FrameLabel -> {"x", "t"}]]]]]]]], 
      "Specifications" :> {{{$CellContext`recurrentQ$$, False, "RLS"}, {
         True, False}, ControlPlacement -> 
         1}, {{$CellContext`normalQ$$, False, "MLE"}, {True, False}, 
         ControlPlacement -> 2}, {{$CellContext`kalmanQ$$, False, "KAL"}, {
         True, False}, ControlPlacement -> 
         3}, {{$CellContext`bishopMapQ$$, True, "MAP"}, {True, False}, 
         ControlPlacement -> 
         4}, {{$CellContext`order$$, 4, "polynomial order"}, 0, 16, 1, 
         Appearance -> {"Labeled"}, ControlPlacement -> 
         5}, {{$CellContext`logMinInfo$$, 3, "-log a-priori info (REC)"}, 0, 
         16, Appearance -> "Labeled", ControlPlacement -> 
         6}, {{$CellContext`logSigmaXSquared$$, 3, "log a-priori cov (KAL)"}, 
         0, 16, Appearance -> "Labeled", ControlPlacement -> 
         7}, {{$CellContext`\[Alpha]$$, 0.005, "\[Alpha] for max posterior"}, 
         0, 0.1, Appearance -> "Labeled", ControlPlacement -> 
         8}, {{$CellContext`\[Beta]$$, 11.11111111111111, 
          "\[Beta] for max posterior"}, 2.220446049250313*^-16, 100., 
         Appearance -> "Labeled", ControlPlacement -> 9}, 
        Grid[{{
           Grid[{{
              Manipulate`Place[1], 
              Manipulate`Place[2], 
              Manipulate`Place[3], 
              Manipulate`Place[4]}}, Frame -> All], ""}, {
           Manipulate`Place[5], ""}, {
           Manipulate`Place[6]}, {
           Manipulate`Place[7]}, {
           Manipulate`Place[8]}, {
           Manipulate`Place[9]}}]}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{606., {312., 321.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7280854476759377`*^9, 3.728085492295877*^9}, {
   3.728085551123599*^9, 3.728085572110034*^9}, 3.728085738715117*^9, 
   3.728085820673483*^9, 3.7280859247562237`*^9, 3.7280859789263783`*^9, 
   3.7280861296346073`*^9, {3.728089931083171*^9, 3.7280899417007093`*^9}, 
   3.728090744092922*^9, 3.728169447764062*^9, 3.728169542408732*^9, 
   3.728169825445517*^9, 3.728169885434284*^9, 
   3.7282529580354843`*^9},ExpressionUUID->"300ae224-ea51-4351-992b-\
c248b7970a61"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reconciling MAP", "Subchapter",
 CellChangeTimes->{{3.727972227304764*^9, 3.727972236949319*^9}, {
   3.728034300582787*^9, 3.7280343057276363`*^9}, 3.72804488545616*^9},
 CellTags->"c:16",ExpressionUUID->"41f79d5a-38f3-4f24-b1cf-e2d7ccc6e86e"],

Cell[TextData[{
 "We suspect that Bishop\[CloseCurlyQuote]s ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["S", 
    RowBox[{"\[ThinSpace]", 
     RowBox[{"-", "1"}]}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "43c0a823-7b0f-4a47-a2bb-a7bc818677e5"],
 " is related to our Kalman ",
 Cell[BoxData[
  FormBox["D", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "9d404c46-096f-4cec-8104-e95dd8836934"],
 ", at least row-by-row:"
}], "Text",
 CellChangeTimes->{{3.727975359226492*^9, 3.7279754246601973`*^9}, {
  3.72797546048038*^9, 3.727975469550086*^9}, {3.7279759148794813`*^9, 
  3.727975928265933*^9}},ExpressionUUID->"36e9e397-a0ec-4df4-9765-\
a35b4bb38ac9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
ShowPageBreaks->False,
WindowSize->{1222, 851},
WindowMargins->{{6, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingStartingPageNumber->1,
PrintingPageRange->{1, Automatic},
TaggingRules->{
 "PaginationCache" -> {{2018, 2, 20, 19, 46, 39.675061`8.351092581673305}, {1,
     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3,
     4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 6, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 
    9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 11, 12, 12, 12, 12, 13, 14, 14, 
    15, 15, 17, 17, 19, 19, 19, 20}, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Users", "bbeckman"}, 
  "DefaultStyles.nb", CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "c:1"->{
  Cell[580, 22, 239, 3, 139, "Title",ExpressionUUID->"df21f0de-8246-4913-960d-0c30b8ea4c38",
   CellTags->"c:1"]},
 "c:2"->{
  Cell[1073, 38, 172, 2, 101, "Chapter",ExpressionUUID->"400e3cfe-c8a7-42b0-a1e0-731e8d54277b",
   CellTags->"c:2"]},
 "c:3"->{
  Cell[3981, 88, 178, 2, 82, "Chapter",ExpressionUUID->"b4436fee-a910-4303-af20-c8497a4ae76a",
   CellTags->"c:3"]},
 "c:4"->{
  Cell[10304, 265, 297, 4, 95, "Subchapter",ExpressionUUID->"47dd026f-d220-40db-977a-5dd0c33852f3",
   CellTags->"c:4"]},
 "c:5"->{
  Cell[12338, 317, 197, 3, 95, "Subchapter",ExpressionUUID->"e91ccb44-d532-453b-9dd9-e439997d9905",
   CellTags->"c:5"]},
 "c:6"->{
  Cell[18159, 449, 268, 3, 95, "Subchapter",ExpressionUUID->"608eebd4-04fe-4c58-b0e3-7eb1ca6ced3d",
   CellTags->"c:6"]},
 "c:7"->{
  Cell[23415, 559, 166, 2, 95, "Subchapter",ExpressionUUID->"d7172986-5c33-442d-923c-ebedb29b0ccc",
   CellTags->"c:7"]},
 "c:8"->{
  Cell[38656, 884, 325, 4, 95, "Subchapter",ExpressionUUID->"43b81392-6992-487a-bf0e-469291f15ff6",
   CellTags->"c:8"]},
 "c:9"->{
  Cell[48041, 1105, 218, 3, 82, "Chapter",ExpressionUUID->"fd4fd582-c1a0-4c42-9348-d74fc4ea628a",
   CellTags->"c:9"]},
 "c:10"->{
  Cell[88802, 2058, 256, 3, 95, "Subchapter",ExpressionUUID->"3fc0471d-6547-492c-a7f0-88c7972d7ead",
   CellTags->"c:10"]},
 "c:11"->{
  Cell[97269, 2278, 177, 2, 82, "Chapter",ExpressionUUID->"7a3df452-4da6-4c03-a169-ea05a896b45d",
   CellTags->"c:11"]},
 "c:12"->{
  Cell[112361, 2628, 195, 2, 96, "Subchapter",ExpressionUUID->"244abd98-9ff2-4cbb-957c-454f2602af00",
   CellTags->"c:12"]},
 "c:13"->{
  Cell[119777, 2808, 342, 4, 82, "Chapter",ExpressionUUID->"e904f61a-2aac-4df2-b65e-b53e5d38a4bd",
   CellTags->"c:13"]},
 "c:14"->{
  Cell[217031, 5047, 181, 2, 101, "Chapter",ExpressionUUID->"5e146fa3-c774-454c-9d58-41c7d064f607",
   CellTags->"c:14"]},
 "c:15"->{
  Cell[219804, 5119, 241, 3, 95, "Subchapter",ExpressionUUID->"d7a304fb-6f9f-4c41-9967-80276318fb81",
   CellTags->"c:15"]},
 "c:16"->{
  Cell[387742, 8856, 250, 3, 96, "Subchapter",ExpressionUUID->"41f79d5a-38f3-4f24-b1cf-e2d7ccc6e86e",
   CellTags->"c:16"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"c:1", 389901, 8911},
 {"c:2", 390026, 8914},
 {"c:3", 390154, 8917},
 {"c:4", 390281, 8920},
 {"c:5", 390413, 8923},
 {"c:6", 390545, 8926},
 {"c:7", 390677, 8929},
 {"c:8", 390809, 8932},
 {"c:9", 390941, 8935},
 {"c:10", 391072, 8938},
 {"c:11", 391207, 8941},
 {"c:12", 391339, 8944},
 {"c:13", 391475, 8947},
 {"c:14", 391608, 8950},
 {"c:15", 391742, 8953},
 {"c:16", 391878, 8956}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 239, 3, 139, "Title",ExpressionUUID->"df21f0de-8246-4913-960d-0c30b8ea4c38",
 CellTags->"c:1"],
Cell[822, 27, 226, 7, 103, "Text",ExpressionUUID->"854332ec-3651-4c31-9d01-187ffbc82c8e"],
Cell[CellGroupData[{
Cell[1073, 38, 172, 2, 101, "Chapter",ExpressionUUID->"400e3cfe-c8a7-42b0-a1e0-731e8d54277b",
 CellTags->"c:2"],
Cell[1248, 42, 2696, 41, 412, "Text",ExpressionUUID->"a883f589-7218-464d-b6b2-a6e932ea8e15"]
}, Closed]],
Cell[CellGroupData[{
Cell[3981, 88, 178, 2, 82, "Chapter",ExpressionUUID->"b4436fee-a910-4303-af20-c8497a4ae76a",
 CellTags->"c:3"],
Cell[4162, 92, 584, 10, 164, "Text",ExpressionUUID->"85c0c564-3527-4b6f-af00-e54d3b0b5b46"],
Cell[4749, 104, 2819, 83, 133, "Text",ExpressionUUID->"ac88bcea-43b3-447b-ade9-9f47e70fa366"],
Cell[7571, 189, 1710, 49, 118, "DisplayFormulaNumbered",ExpressionUUID->"edfc4e60-1a5d-4bbc-8586-719db51c84cd"],
Cell[9284, 240, 995, 21, 133, "Text",ExpressionUUID->"94ca0260-132d-409c-8b19-0b4d6bd9f578"],
Cell[CellGroupData[{
Cell[10304, 265, 297, 4, 95, "Subchapter",ExpressionUUID->"47dd026f-d220-40db-977a-5dd0c33852f3",
 CellTags->"c:4"],
Cell[10604, 271, 1134, 22, 164, "Text",ExpressionUUID->"b251a480-7d0a-4708-a0bb-1953fdf4736b"],
Cell[11741, 295, 560, 17, 95, "Input",ExpressionUUID->"bd95db53-9501-422b-9130-f0ddc2962414"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12338, 317, 197, 3, 95, "Subchapter",ExpressionUUID->"e91ccb44-d532-453b-9dd9-e439997d9905",
 CellTags->"c:5"],
Cell[12538, 322, 1187, 29, 133, "Text",ExpressionUUID->"db69371d-1adf-4245-bec6-355031d69082"],
Cell[CellGroupData[{
Cell[13750, 355, 1891, 42, 188, "Input",ExpressionUUID->"66e73013-3112-4348-a1d9-ec6740e171cf"],
Cell[15644, 399, 2466, 44, 80, "Output",ExpressionUUID->"ab757c3b-f9a5-4236-825f-0f570a9c0a72"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18159, 449, 268, 3, 95, "Subchapter",ExpressionUUID->"608eebd4-04fe-4c58-b0e3-7eb1ca6ced3d",
 CellTags->"c:6"],
Cell[18430, 454, 1120, 28, 188, "Input",ExpressionUUID->"dcf80067-1b4d-4ca1-a465-b6d067fe1e04"],
Cell[CellGroupData[{
Cell[19575, 486, 1371, 26, 157, "Input",ExpressionUUID->"464fd4ff-3f54-4f41-bff3-b434b588715a"],
Cell[20949, 514, 2417, 39, 80, "Output",ExpressionUUID->"40ebeefe-e3a0-4462-bd25-9152d295c2e5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23415, 559, 166, 2, 95, "Subchapter",ExpressionUUID->"d7172986-5c33-442d-923c-ebedb29b0ccc",
 CellTags->"c:7"],
Cell[23584, 563, 842, 24, 127, "Text",ExpressionUUID->"f817be6c-9a8e-4e9f-a43d-9f34d5b9987f"],
Cell[CellGroupData[{
Cell[24451, 591, 874, 21, 126, "Input",ExpressionUUID->"5aeea79a-7696-40cc-9adc-259870686894"],
Cell[25328, 614, 1982, 31, 63, "Output",ExpressionUUID->"2fb976ee-9625-4385-866c-0b29f446da3f"]
}, Open  ]],
Cell[27325, 648, 397, 8, 72, "Text",ExpressionUUID->"e4b9147c-e0bc-4980-a5ff-4fd167ac66cb"],
Cell[27725, 658, 649, 15, 63, "Input",ExpressionUUID->"6d9378c4-eccb-470c-a7bb-c2341636454d"],
Cell[28377, 675, 487, 13, 72, "Text",ExpressionUUID->"1d8c675c-4946-4c90-a854-966331b0f2d3"],
Cell[CellGroupData[{
Cell[28889, 692, 927, 24, 95, "Input",ExpressionUUID->"cab178ce-edf9-4d91-88ee-2d777da823c7"],
Cell[29819, 718, 8788, 160, 372, "Output",ExpressionUUID->"278bc652-65da-4301-8529-abfe95398215"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38656, 884, 325, 4, 95, "Subchapter",ExpressionUUID->"43b81392-6992-487a-bf0e-469291f15ff6",
 CellTags->"c:8"],
Cell[38984, 890, 2277, 56, 140, "Text",ExpressionUUID->"e57c8e28-d199-4aab-b7d6-d16b6b2262f8"],
Cell[41264, 948, 755, 17, 38, "DisplayFormulaNumbered",ExpressionUUID->"7ec11082-1448-47e4-99ef-4714737b0f5a"],
Cell[42022, 967, 268, 5, 72, "Text",ExpressionUUID->"71697bff-f2d9-42a5-8098-7fe76cdba4d9"],
Cell[CellGroupData[{
Cell[42315, 976, 378, 9, 63, "Input",ExpressionUUID->"517fb11c-782d-49b8-917a-d34f728e4a59"],
Cell[42696, 987, 1773, 28, 63, "Output",ExpressionUUID->"128d120e-0cac-4dd6-b2fc-d1d8e53de738"]
}, Open  ]],
Cell[44484, 1018, 699, 20, 103, "Text",ExpressionUUID->"22066f22-5f02-4533-b3d3-2bdd51ce3ac6"],
Cell[CellGroupData[{
Cell[45208, 1042, 285, 8, 63, "Input",ExpressionUUID->"9edc8455-1cfe-45cf-b25c-52a429d0fde9"],
Cell[45496, 1052, 1581, 25, 63, "Output",ExpressionUUID->"acb74e95-8e68-4b6e-a195-8c5dd45bf9b1"]
}, Open  ]],
Cell[47092, 1080, 900, 19, 103, "Text",ExpressionUUID->"85229b37-7e0e-4646-b20e-f235abeab01d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48041, 1105, 218, 3, 82, "Chapter",ExpressionUUID->"fd4fd582-c1a0-4c42-9348-d74fc4ea628a",
 CellTags->"c:9"],
Cell[48262, 1110, 773, 19, 73, "Text",ExpressionUUID->"bb72127d-3f0d-4da3-b426-15c588d476b8"],
Cell[49038, 1131, 1047, 27, 73, "DisplayFormulaNumbered",ExpressionUUID->"016e5a68-3e36-4cea-9454-b798ab33d773"],
Cell[50088, 1160, 2119, 48, 73, "Text",ExpressionUUID->"0e10d69e-7208-46f3-893f-ad44ce117fee"],
Cell[52210, 1210, 1497, 22, 72, "Text",ExpressionUUID->"77e515e0-b4b9-495c-85af-429d50b65af5"],
Cell[53710, 1234, 1888, 35, 44, "DisplayFormulaNumbered",ExpressionUUID->"501bd69d-ec91-4a6f-a746-86cc49e98913"],
Cell[55601, 1271, 2083, 41, 104, "Text",ExpressionUUID->"458ce310-6734-4e36-a65c-7771535a1724"],
Cell[57687, 1314, 2596, 56, 39, "DisplayFormulaNumbered",ExpressionUUID->"069cf11b-95eb-4b0f-af06-a2d3b934a885"],
Cell[60286, 1372, 3403, 78, 138, "Text",ExpressionUUID->"67ca1e83-e46d-4973-b522-be62ac11bdaf"],
Cell[63692, 1452, 1801, 33, 104, "Text",ExpressionUUID->"7d01d2b4-4b18-4655-8a4c-1f7d486f72c5"],
Cell[65496, 1487, 2031, 48, 74, "Text",ExpressionUUID->"07922d7a-506f-4713-b30e-6f3628d06609"],
Cell[CellGroupData[{
Cell[67552, 1539, 3695, 85, 350, "Input",ExpressionUUID->"a3797c17-be41-4136-8ecd-5a7b55603224"],
Cell[71250, 1626, 2174, 50, 70, "Output",ExpressionUUID->"b02e9284-fb20-48cf-839b-5ad3e91b103c"]
}, Open  ]],
Cell[73439, 1679, 1201, 30, 73, "Text",ExpressionUUID->"537d49e2-8fcc-4dda-a513-5e51dde5f1ef"],
Cell[74643, 1711, 1198, 20, 196, "Text",ExpressionUUID->"d8883e07-acc1-4242-a8cb-c40067337121"],
Cell[75844, 1733, 966, 27, 105, "Text",ExpressionUUID->"498562a8-7fb9-41c8-89eb-57fe2a769482"],
Cell[76813, 1762, 1659, 43, 72, "Text",ExpressionUUID->"436872f7-3223-44e3-a641-7304e3a78257"],
Cell[CellGroupData[{
Cell[78497, 1809, 304, 7, 63, "Input",ExpressionUUID->"0371799a-125d-4d58-835d-8ff44b347f11"],
Cell[78804, 1818, 1285, 23, 70, "Output",ExpressionUUID->"bf0e6abc-124c-4ae5-813a-6187771d6b02"]
}, Open  ]],
Cell[80104, 1844, 2969, 74, 204, "Text",ExpressionUUID->"684d9ed8-36d2-459e-b878-5b3dcfc106d1"],
Cell[CellGroupData[{
Cell[83098, 1922, 915, 22, 86, "Input",ExpressionUUID->"1794261e-bc00-4147-8301-8d76460f977f"],
Cell[84016, 1946, 1894, 37, 70, "Output",ExpressionUUID->"b9e49f38-fed2-4edf-990c-56ff24d038a0"]
}, Open  ]],
Cell[85925, 1986, 629, 14, 72, "Text",ExpressionUUID->"131da65d-6802-432c-8b70-cde6d0bff1dd"],
Cell[CellGroupData[{
Cell[86579, 2004, 441, 12, 63, "Input",ExpressionUUID->"83646139-4eb0-4c6e-a6e8-07eb66ecae26"],
Cell[87023, 2018, 1742, 35, 70, "Output",ExpressionUUID->"405957cf-3126-49c1-919a-e0ee650a6dc8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88802, 2058, 256, 3, 95, "Subchapter",ExpressionUUID->"3fc0471d-6547-492c-a7f0-88c7972d7ead",
 CellTags->"c:10"],
Cell[89061, 2063, 1602, 45, 164, "Text",ExpressionUUID->"22774012-9eff-4ac3-a496-e6a67fad0936"],
Cell[CellGroupData[{
Cell[90688, 2112, 3428, 84, 316, "Input",ExpressionUUID->"8455ac8b-46ce-48d7-bcde-ffa8bac951e1"],
Cell[94119, 2198, 2142, 49, 70, "Output",ExpressionUUID->"6f10acfb-11ef-4556-8c8e-d87a80e39a6e"]
}, Open  ]],
Cell[96276, 2250, 512, 11, 72, "Text",ExpressionUUID->"0c24c54b-b13d-4dfb-a8cb-ab88032612f8"],
Cell[96791, 2263, 429, 9, 103, "Text",ExpressionUUID->"ef86be51-850b-4e60-8316-442ba4e18123"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[97269, 2278, 177, 2, 82, "Chapter",ExpressionUUID->"7a3df452-4da6-4c03-a169-ea05a896b45d",
 CellTags->"c:11"],
Cell[97449, 2282, 5125, 104, 169, "Text",ExpressionUUID->"cab07210-8bc7-463f-9916-06164277be49"],
Cell[102577, 2388, 1256, 29, 73, "DisplayFormulaNumbered",ExpressionUUID->"33120922-77c1-4a41-844d-dedb9b99a61c"],
Cell[103836, 2419, 654, 13, 104, "Text",ExpressionUUID->"326bc6e7-2170-49eb-ae12-cfc1dd19591b"],
Cell[CellGroupData[{
Cell[104515, 2436, 326, 8, 61, "Input",ExpressionUUID->"b416eae6-0974-4a7b-9d82-71e83d50f700"],
Cell[104844, 2446, 1514, 36, 70, "Output",ExpressionUUID->"eb9f10cd-478b-430f-9aed-71e476e716c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106395, 2487, 2840, 72, 295, "Input",ExpressionUUID->"7ddbbe8b-21a9-42dc-9716-202e9b6e3456"],
Cell[109238, 2561, 3086, 62, 70, "Output",ExpressionUUID->"2be7795d-b08b-4ceb-a30f-e5ad1f848418"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112361, 2628, 195, 2, 96, "Subchapter",ExpressionUUID->"244abd98-9ff2-4cbb-957c-454f2602af00",
 CellTags->"c:12"],
Cell[112559, 2632, 7169, 170, 363, "Text",ExpressionUUID->"0a7a1364-3eef-423e-9bb5-533da0f1e902"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[119777, 2808, 342, 4, 82, "Chapter",ExpressionUUID->"e904f61a-2aac-4df2-b65e-b53e5d38a4bd",
 CellTags->"c:13"],
Cell[120122, 2814, 2010, 35, 316, "Text",ExpressionUUID->"543cb2a0-0e2a-471b-99c3-db8f3d5a2502"],
Cell[122135, 2851, 745, 21, 72, "Text",ExpressionUUID->"67f8d26c-0487-4c33-aa2f-6276299b9da3"],
Cell[CellGroupData[{
Cell[122905, 2876, 815, 18, 126, "Input",ExpressionUUID->"fb3ccbeb-20e3-4e2c-9e79-93ea92eb3b36"],
Cell[123723, 2896, 2024, 48, 377, "Output",ExpressionUUID->"789ceae9-ab02-4543-9990-fb4365078279"]
}, Open  ]],
Cell[125762, 2947, 1871, 40, 286, "Text",ExpressionUUID->"49fbe227-c052-4592-a399-d4ad384aaf80"],
Cell[127636, 2989, 1198, 33, 219, "Input",ExpressionUUID->"cff4dd11-5349-4864-acae-eb90ff29fe6d"],
Cell[128837, 3024, 1097, 19, 105, "Text",ExpressionUUID->"e447814c-2e6b-4e89-81da-15737a60a88f"],
Cell[129937, 3045, 1449, 37, 250, "Input",ExpressionUUID->"2f201b63-7491-442b-bf7d-737d03ac1688"],
Cell[131389, 3084, 307, 5, 72, "Text",ExpressionUUID->"357da196-1d26-48ce-866a-a9e0972ea669"],
Cell[CellGroupData[{
Cell[131721, 3093, 2459, 56, 250, "Input",ExpressionUUID->"25ef9dce-c320-447e-a283-f6b2b7d4691e"],
Cell[134183, 3151, 15782, 283, 380, "Output",ExpressionUUID->"7f2732fb-6996-4d3e-836b-7fc7d5c5a97c"]
}, Open  ]],
Cell[149980, 3437, 555, 12, 72, "Text",ExpressionUUID->"2df64f76-f5e6-41f4-954e-eaed7db1833c"],
Cell[CellGroupData[{
Cell[150560, 3453, 1403, 37, 160, "Input",ExpressionUUID->"bc5a2a90-6d11-4306-91f1-da70821677f7"],
Cell[151966, 3492, 1920, 45, 141, "Output",ExpressionUUID->"c1b26ac9-3e84-4416-a803-6ff2e62dc970"]
}, Open  ]],
Cell[153901, 3540, 381, 8, 72, "Text",ExpressionUUID->"db54f786-8f99-4ab2-9bc6-f4d6a700b629"],
Cell[CellGroupData[{
Cell[154307, 3552, 1520, 36, 188, "Input",ExpressionUUID->"5968dc96-c225-4989-9d86-0022ee0eec9d"],
Cell[155830, 3590, 1020, 18, 63, "Output",ExpressionUUID->"40aa425e-d84f-417b-96ec-40baf2e2c061"]
}, Open  ]],
Cell[156865, 3611, 770, 17, 103, "Text",ExpressionUUID->"65ec69af-ce5e-4394-a4c7-9b7025018373"],
Cell[157638, 3630, 1012, 33, 77, "DisplayFormula",ExpressionUUID->"c23f6a20-2521-4b32-bdf7-92fc5ac48ac3"],
Cell[158653, 3665, 1987, 52, 164, "Text",ExpressionUUID->"412f8bcc-f4b4-4465-92b5-d143af7effdc"],
Cell[160643, 3719, 880, 34, 38, "DisplayFormula",ExpressionUUID->"d56aaaf7-ca14-41d7-a295-97ae45d3304a"],
Cell[161526, 3755, 2464, 65, 164, "Text",ExpressionUUID->"694693d1-ec8b-4464-b249-75bfeccf18c1"],
Cell[CellGroupData[{
Cell[164015, 3824, 1552, 36, 66, "Item",ExpressionUUID->"e5d4da9f-0d46-4255-ad70-5681ae5b2813"],
Cell[165570, 3862, 1701, 42, 64, "Item",ExpressionUUID->"1aa2fc9b-a4a2-48fe-8ec7-5d3eb5561a42"],
Cell[167274, 3906, 889, 17, 63, "Item",ExpressionUUID->"72896bef-06cf-4bd5-b4da-981b955da6e0"]
}, Open  ]],
Cell[168178, 3926, 953, 17, 103, "Text",ExpressionUUID->"592189fd-2218-4bac-bb2b-0e745343539c"],
Cell[169134, 3945, 2375, 71, 119, "DisplayFormulaNumbered",ExpressionUUID->"27b0bdc8-ecb1-4c5a-8eb9-42856ccb929a"],
Cell[CellGroupData[{
Cell[171534, 4020, 173, 3, 50, "Subsection",ExpressionUUID->"f2a5c90a-ce6c-4dbe-8117-0096ce983c3c"],
Cell[CellGroupData[{
Cell[171732, 4027, 756, 20, 157, "Input",ExpressionUUID->"2575f9a4-fce4-4e97-8c33-4430117f01b9"],
Cell[172491, 4049, 1020, 19, 66, "Output",ExpressionUUID->"35ad3ed2-ccaa-49f7-97ee-a2c0bd3d6ebe"]
}, Open  ]],
Cell[173526, 4071, 285, 4, 72, "Text",ExpressionUUID->"f2d160bd-fb34-48aa-a038-119c0a158232"],
Cell[CellGroupData[{
Cell[173836, 4079, 855, 21, 157, "Input",ExpressionUUID->"180d48a3-0498-4b3e-bd04-861394082489"],
Cell[174694, 4102, 2058, 41, 191, "Output",ExpressionUUID->"126a16e6-cee3-4bd3-8751-1ab1bfb7b663"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[176801, 4149, 174, 3, 50, "Subsection",ExpressionUUID->"f32a9bf6-db99-4caa-8fb8-82743b171c1e"],
Cell[176978, 4154, 897, 18, 133, "Text",ExpressionUUID->"bfbf8b69-2d4e-4244-9955-828f845e3660"],
Cell[CellGroupData[{
Cell[177900, 4176, 3491, 83, 353, "Input",ExpressionUUID->"67d37a44-0ae8-4cde-bdf8-4f2847ee2026"],
Cell[181394, 4261, 2681, 48, 191, "Output",ExpressionUUID->"e63a45b5-e854-4bc5-af2e-c0e5eeb90c2e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[184124, 4315, 170, 3, 50, "Subsection",ExpressionUUID->"e68f32b7-beff-4667-b749-9bdf69b4a503"],
Cell[184297, 4320, 2037, 44, 377, "Text",ExpressionUUID->"61f4626f-00ca-415e-ac2f-9ca330d144c0"],
Cell[186337, 4366, 6211, 153, 591, "Input",ExpressionUUID->"c749088c-04f5-4907-b9ca-fb49efa60f35"],
Cell[192551, 4521, 4513, 99, 568, "Text",ExpressionUUID->"06b04a89-079d-4835-a22c-650fe407c905"],
Cell[CellGroupData[{
Cell[197089, 4624, 12924, 282, 861, "Input",ExpressionUUID->"c4e105a8-45dc-4fcb-92a7-048117eb1b0a"],
Cell[210016, 4908, 6954, 132, 610, "Output",ExpressionUUID->"d6a96b84-0803-42cc-9156-c6668da9e310"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[217031, 5047, 181, 2, 101, "Chapter",ExpressionUUID->"5e146fa3-c774-454c-9d58-41c7d064f607",
 CellTags->"c:14"],
Cell[217215, 5051, 2564, 64, 229, "Item",ExpressionUUID->"fa95364b-3015-47fe-be85-da9e24be961b"],
Cell[CellGroupData[{
Cell[219804, 5119, 241, 3, 95, "Subchapter",ExpressionUUID->"d7a304fb-6f9f-4c41-9967-80276318fb81",
 CellTags->"c:15"],
Cell[220048, 5124, 1125, 26, 133, "Text",ExpressionUUID->"a1373b67-87a8-4e47-914b-7d73c812048e"],
Cell[221176, 5152, 766, 20, 72, "DisplayFormulaNumbered",ExpressionUUID->"4bd20e37-6329-4716-aede-ab9a4bb004af"],
Cell[221945, 5174, 698, 18, 38, "DisplayFormulaNumbered",ExpressionUUID->"6a26e095-6cef-4d4a-8e37-4258853e6c55"],
Cell[222646, 5194, 907, 25, 72, "DisplayFormulaNumbered",ExpressionUUID->"b4829aab-42a8-4965-b9c1-9029eacf7ef2"],
Cell[223556, 5221, 294, 7, 72, "Text",ExpressionUUID->"72722f2c-a866-4d8a-a437-bfa3bd35b363"],
Cell[223853, 5230, 653, 17, 72, "DisplayFormulaNumbered",ExpressionUUID->"0d63a741-69a7-4583-819a-f44290a892ab"],
Cell[224509, 5249, 616, 19, 49, "DisplayFormulaNumbered",ExpressionUUID->"04593f6e-4865-45dc-bc8d-43e21089c41e"],
Cell[225128, 5270, 308, 7, 70, "Text",ExpressionUUID->"8e953d86-60d7-48d5-b106-44b48a5aa475"],
Cell[CellGroupData[{
Cell[225461, 5281, 168, 3, 52, "Subsection",ExpressionUUID->"dea6cd0e-61dc-4fcb-bb23-b7ec71000edf"],
Cell[225632, 5286, 3139, 82, 194, "Text",ExpressionUUID->"d5d54705-3ca1-481a-8a3c-a7946ac99964"],
Cell[CellGroupData[{
Cell[228796, 5372, 1840, 40, 132, "Input",ExpressionUUID->"99f156f3-5aac-4091-ae6a-b2a0740f6c9b"],
Cell[230639, 5414, 7276, 202, 146, "Output",ExpressionUUID->"055e1d65-9212-48bd-8b8e-2623c94228a8"]
}, Open  ]],
Cell[237930, 5619, 553, 12, 70, "Text",ExpressionUUID->"ff89db8f-c3ff-4e57-986c-d513b2d62400"],
Cell[CellGroupData[{
Cell[238508, 5635, 760, 19, 95, "Input",ExpressionUUID->"60370d45-b4e1-4ea5-bbd8-a6a455088895"],
Cell[239271, 5656, 2214, 41, 194, "Output",ExpressionUUID->"f3bba4d9-97ce-4320-bd7d-cafb8e0eab77"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[241534, 5703, 159, 3, 50, "Subsection",ExpressionUUID->"a170c7f7-9c9e-48dd-8c1e-6477ea0eb26f"],
Cell[241696, 5708, 490, 10, 72, "Text",ExpressionUUID->"91e51b52-f06d-4943-91cd-ba6e049f92a9"],
Cell[CellGroupData[{
Cell[242211, 5722, 2626, 66, 281, "Input",ExpressionUUID->"62a89ce9-1583-43a8-9d1d-8cfb1f15e5d2"],
Cell[244840, 5790, 2522, 49, 236, "Output",ExpressionUUID->"ae43f8dd-2f21-47c1-861d-ac1e43254e4c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[247411, 5845, 160, 3, 50, "Subsection",ExpressionUUID->"07c893a6-acfe-4c67-be5a-3a54ec3e3d0e"],
Cell[247574, 5850, 1220, 38, 76, "Text",ExpressionUUID->"24b0a5ae-c9e1-459d-84e9-7f863b2f9d7e"],
Cell[CellGroupData[{
Cell[248819, 5892, 9643, 220, 938, "Input",ExpressionUUID->"310097dd-ef65-4e4f-8efe-967a4d53635c"],
Cell[258465, 6114, 5742, 111, 519, "Output",ExpressionUUID->"f7ad3463-44b2-4662-8985-6074690de196"]
}, Open  ]],
Cell[264222, 6228, 971, 27, 72, "Text",ExpressionUUID->"064bc29c-4a2e-43a9-8c9a-429640e41afa"],
Cell[CellGroupData[{
Cell[265218, 6259, 15701, 341, 1097, "Input",ExpressionUUID->"9ffa1b6e-a210-4513-95e5-469181d4340b"],
Cell[280922, 6602, 9173, 177, 672, "Output",ExpressionUUID->"65608188-9b5c-4b1a-af50-25e276836a05"]
}, Open  ]],
Cell[290110, 6782, 697, 18, 72, "Text",ExpressionUUID->"995645c6-4791-43e9-ba09-72f6fe74537e"],
Cell[CellGroupData[{
Cell[290832, 6804, 2153, 58, 312, "Input",ExpressionUUID->"bf04b114-e46b-4f32-aa70-3883982da28c"],
Cell[292988, 6864, 2357, 47, 191, "Output",ExpressionUUID->"9d4ce68b-96e8-4c1b-b6b0-96cb0a6b3eea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295382, 6916, 13012, 289, 1160, "Input",ExpressionUUID->"1ebdb9ce-0acf-4530-bd7d-cb9df05dbf32"],
Cell[308397, 7207, 8889, 162, 666, "Output",ExpressionUUID->"78345589-a867-4311-af63-f73ef84ed850"]
}, Open  ]],
Cell[317301, 7372, 832, 20, 103, "Text",ExpressionUUID->"6009a225-9524-46c2-bd0e-5cb7aabcc67b"],
Cell[CellGroupData[{
Cell[318158, 7396, 9190, 200, 591, "Input",ExpressionUUID->"4d4e93ad-1f91-4f93-8ece-8d1e86584f92"],
Cell[327351, 7598, 5242, 98, 572, "Output",ExpressionUUID->"edfd8614-111a-4d0f-9007-d704ac437e98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332630, 7701, 16745, 367, 1233, "Input",ExpressionUUID->"3bc18cb1-77ae-46f8-b25f-3f87d6e0edd8"],
Cell[349378, 8070, 9577, 178, 672, "Output",ExpressionUUID->"d3cc2ef8-20f9-4441-b114-2b19bdc08410"]
}, Open  ]],
Cell[CellGroupData[{
Cell[358992, 8253, 18798, 410, 1388, "Input",ExpressionUUID->"336cfd34-044f-4091-918e-1cb6cb1e990b"],
Cell[377793, 8665, 9888, 184, 672, "Output",ExpressionUUID->"300ae224-ea51-4351-992b-c248b7970a61"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[387742, 8856, 250, 3, 96, "Subchapter",ExpressionUUID->"41f79d5a-38f3-4f24-b1cf-e2d7ccc6e86e",
 CellTags->"c:16"],
Cell[387995, 8861, 714, 19, 73, "Text",ExpressionUUID->"36e9e397-a0ec-4df4-9765-a35b4bb38ac9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

